var ruleJS=function(r){"use strict";var n=this,t=document.getElementById(r)||null,e="0.0.3",a={},u=function(r){var n=function(){};n.prototype=Parser.lexer;var t=function(){this.lexer=new n,this.yy={}};t.prototype=Parser;var e=new t;return e.setObj=function(r){e.yy.obj=r},e.yy.parseError=function(r,n){throw{name:"Parser error",message:r,prop:n}},e.yy.handler=r,e},o={errors:[{type:"NULL",output:"#NULL"},{type:"DIV_ZERO",output:"#DIV/0!"},{type:"VALUE",output:"#VALUE!"},{type:"REF",output:"#REF!"},{type:"NAME",output:"#NAME?"},{type:"NUM",output:"#NUM!"},{type:"NOT_AVAILABLE",output:"#N/A!"},{type:"ERROR",output:"#ERROR"},{type:"NEED_UPDATE",output:"#NEED_UPDATE"}],get:function(r){var n=o.errors.filter(function(n){return n.type===r||n.output===r})[0];return n?n.output:null}},i=function(){this.data=[];var r=["input[type=text]","[data-formula]"],e=function(){document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()};this.getItem=function(r){return n.matrix.data.filter(function(n){return n.id===r})[0]},this.removeItem=function(r){n.matrix.data=n.matrix.data.filter(function(n){return n.id!==r})},this.removeItemsInCol=function(r){n.matrix.data=n.matrix.data.filter(function(n){return n.col!==r})},this.removeItemsInRow=function(r){n.matrix.data=n.matrix.data.filter(function(n){return n.row!==r})},this.removeItemsBelowCol=function(r){n.matrix.data=n.matrix.data.filter(function(n){return n.col<r})},this.removeItemsBelowRow=function(r){n.matrix.data=n.matrix.data.filter(function(n){return n.row<r})},this.updateItem=function(r,t){if(n.utils.isString(r)&&(r=n.matrix.getItem(r)),r&&t)for(var e in t)r[e]&&n.utils.isArray(r[e])?n.utils.isArray(t[e])?t[e].forEach(function(n){-1===r[e].indexOf(n)&&r[e].push(n)}):-1===r[e].indexOf(t[e])&&r[e].push(t[e]):r[e]=t[e]},this.addItem=function(r){var t=r.id,e=n.utils.cellCoords(t);r.row=e.row,r.col=e.col;var a=n.matrix.data.filter(function(r){return r.id===t})[0];return a?n.matrix.updateItem(a,r):n.matrix.data.push(r),n.matrix.getItem(t)},this.getRefItemsToColumn=function(r){var t=[];return n.matrix.data.length?(n.matrix.data.forEach(function(e){if(e.deps){var a=e.deps.filter(function(t){var e=n.utils.getCellAlphaNum(t).alpha,a=n.utils.toNum(e);return a>=r});a.length>0&&-1===t.indexOf(e.id)&&t.push(e.id)}}),t):t},this.getRefItemsToRow=function(r){var t=[];return n.matrix.data.length?(n.matrix.data.forEach(function(e){if(e.deps){var a=e.deps.filter(function(t){var e=n.utils.getCellAlphaNum(t).num;return e>r});a.length>0&&-1===t.indexOf(e.id)&&t.push(e.id)}}),t):t},this.updateElementItem=function(r,t){var e=r.getAttribute("data-cell-id"),a=n.matrix.getItem(e);n.matrix.updateItem(a,t)},this.getDependencies=function(r){var t=function(r){var t=n.matrix.data.filter(function(n){return n.deps?n.deps.indexOf(r)>-1:void 0}),e=[];return t.forEach(function(r){-1===e.indexOf(r.id)&&e.push(r.id)}),e},e=[],a=function(r){var u=t(r);u.length&&u.forEach(function(r){if(-1===e.indexOf(r)){e.push(r);var t=n.matrix.getItem(r);t.deps.length&&a(r)}})};return a(r),e},this.getElementDependencies=function(r){return n.matrix.getDependencies(r.getAttribute("id"))};var a=function(r){{var t=n.matrix.getElementDependencies(r);r.getAttribute("id")}t.forEach(function(r){var t=n.matrix.getItem(r);if(t&&t.formula){var e=document.getElementById(r);u(t.formula,e)}})},u=function(r,t){var e=c(r,t),a=e.result,u=e.error,o=t.nodeName.toUpperCase();if(e.error&&r.indexOf("IFERROR")>-1){var i=r.match(/\((\(*.*\)*),(\(*.*\)*)\)$/);if(i){var l=c(i[2],t);l.error||(u=null,a=l.result)}}n.matrix.updateElementItem(t,{value:a,error:u}),"#VALUE!"===u&&(u=0);var f=a;if(-1===["INPUT"].indexOf(o)){if("0"!==a&&0!==a&&a%1!==0){var s=parseFloat(a);if(-1!==s.toString().indexOf(".")){var m=s.toString().split(".")[1].length;m>4&&(f=s.toFixed(4))}}t.innerText?t.innerText=f||u:t.textContent=f||u}return t.value=a||u,e},o=function(r){var t=r.getAttribute("data-cell-id"),e=r.getAttribute("data-formula");e&&(n.matrix.addItem({id:t,formula:e}),u(e,r))},i=function(r){var t=r.getAttribute("id");r.addEventListener("dblclick",function(){var e=n.matrix.getItem(t);e&&e.formula&&(e.formulaEdit=!0,r.value="="+e.formula)}),r.addEventListener("blur",function(){var e=n.matrix.getItem(t);e&&(e.formulaEdit&&(r.value=e.value||e.error),e.formulaEdit=!1)}),r.addEventListener("keyup",function(r){switch(r.keyCode){case 13:case 27:e()}}),r.addEventListener("change",function(){n.matrix.removeItem(t);var e=r.value;"="===e[0]&&(r.setAttribute("data-formula",e.substr(1)),o(r)),a(r)})};this.depsInFormula=function(r){var n=r.formula,t=r.deps;return t?(t=t.filter(function(r){return-1!==n.indexOf(r)}),t.length>0):!1},this.scan=function(){var n=t.querySelectorAll(r);[].slice.call(n).forEach(function(r){o(r),i(r)})}},l={isArray:function(r){return"[object Array]"===Object.prototype.toString.call(r)},isNumber:function(r){return"[object Number]"===Object.prototype.toString.call(r)},isString:function(r){return"[object String]"===Object.prototype.toString.call(r)},isFunction:function(r){return"[object Function]"===Object.prototype.toString.call(r)},isUndefined:function(r){return"[object Undefined]"===Object.prototype.toString.call(r)},isNull:function(r){return"[object Null]"===Object.prototype.toString.call(r)},isSet:function(r){return!n.utils.isUndefined(r)&&!n.utils.isNull(r)},isCell:function(r){return r.match(/^[A-Za-z]+[0-9]+/)?!0:!1},getCellAlphaNum:function(r){var n=r.match(/\d+$/),t=r.replace(n,"");return{alpha:t,num:parseInt(n[0],10)}},changeRowIndex:function(r,t){var e=n.utils.getCellAlphaNum(r),a=e.alpha,u=a,o=parseInt(e.num+t,10);return 1>o&&(o=1),u+""+o},changeColIndex:function(r,t){var e=n.utils.getCellAlphaNum(r),a=e.alpha,u=n.utils.toChar(parseInt(n.utils.toNum(a)+t,10)),o=e.num;u&&0!==u.length||(u="A");var i="$"===a[0]||!1,l="$"===a[a.length-1]||!1;return u=(i?"$":"")+u,o=(l?"$":"")+o,u+""+o},changeFormula:function(r,t,e){return t||(t=1),r.replace(/(\$?[A-Za-z]+\$?[0-9]+)/g,function(r){var a=n.utils.getCellAlphaNum(r),u=a.alpha,o=a.num;return n.utils.isNumber(e.col)&&(o=n.utils.toNum(u),e.col<=o)?n.utils.changeColIndex(r,t):n.utils.isNumber(e.row)&&e.row<o?n.utils.changeRowIndex(r,t):r})},updateFormula:function(r,t,e){var a,u;return-1!==["left","right"].indexOf(t)?a="col":-1!==["up","down"].indexOf(t)&&(a="row"),-1!==["down","right"].indexOf(t)?u=1*e:-1!==["up","left"].indexOf(t)&&(u=-1*e),a&&u?r.replace(/(\$?[A-Za-z]+\$?[0-9]+)/g,function(r){var t=n.utils.getCellAlphaNum(r).alpha,e="$"===t[0]||!1,o="$"===t[t.length-1]||!1;return"row"===a&&o?r:"col"===a&&e?r:"row"===a?n.utils.changeRowIndex(r,u):n.utils.changeColIndex(r,u)}):r},toNum:function(r){r=n.utils.clearFormula(r);var t,e,a="ABCDEFGHIJKLMNOPQRSTUVWXYZ",u=0;for(t=0,e=r.length-1;t<r.length;t+=1,e-=1)u+=Math.pow(a.length,e)*(a.indexOf(r[t])+1);return u&&--u,u},toChar:function(r){for(var n="";r>=0;)n=String.fromCharCode(r%26+97)+n,r=Math.floor(r/26)-1;return n.toUpperCase()},cellCoords:function(r){var t=r.match(/\d+$/),e=r.replace(t,"");return{row:parseInt(t[0],10)-1,col:n.utils.toNum(e)}},clearFormula:function(r){return r.replace(/\$/g,"")},translateCellCoords:function(r){return n.utils.toChar(r.col)+""+parseInt(r.row+1,10)},iterateCells:function(r,t,e){var a={index:[],value:[]},u={start:0,end:0};u=t.col>=r.col?{start:r.col,end:t.col}:{start:t.col,end:r.col};var o={start:0,end:0};o=t.row>=r.row?{start:r.row,end:t.row}:{start:t.row,end:r.row};for(var i=u.start;i<=u.end;i++)for(var l=o.start;l<=o.end;l++){var f=n.utils.toChar(i)+(l+1),c=n.helper.cellValue.call(this,f);a.index.push(f),a.value.push(c)}return n.utils.isFunction(e)?e.apply(e,[a]):a},sort:function(r){return function(n,t){return(t>n?-1:n>t?1:0)*(r?-1:1)}}},f={SUPPORTED_FORMULAS:["ABS","ACCRINT","ACOS","ACOSH","ACOTH","AND","ARABIC","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOMDIST","BINOMDISTRANGE","BINOMINV","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQDIST","CHISQINV","CODE","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCENORM","CONFIDENCET","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCEP","COVARIANCES","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DOLLAR","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","ERF","ERFC","EVEN","EXACT","EXPONDIST","FALSE","FDIST","FINV","FISHER","FISHERINV","IF","IFERROR","INT","ISEVEN","ISODD","LN","LARGE","LOG","LOG10","MAX","MAXA","MEDIAN","MIN","MINA","MOD","MONTH","NOT","ODD","OR","PMT","PI","POWER","ROUND","ROUNDDOWN","ROUNDUP","SIN","SINH","SPLIT","SQRT","SQRTPI","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","TAN","TANH","TRUE","TRUNC","XOR","YEAR"],number:function(r){switch(typeof r){case"number":return r;case"string":if(!isNaN(r))return r.indexOf(".")>-1?parseFloat(r):parseInt(r,10)}return r},string:function(r){return r.substring(1,r.length-1)},numberInverted:function(r){return-1*this.number(r)},specialMatch:function(r,n,t){var e;switch(r){case"&":e=n.toString()+t.toString()}return e},logicMatch:function(r,n,t){var e;switch(r){case"=":e=n===t;break;case">":e=n>t;break;case"<":e=t>n;break;case">=":e=n>=t;break;case"<=":e=n===t;break;case"<>":e=n!=t;break;case"NOT":e=n!=t}return e},mathMatch:function(r,n,t){var e;if(n=f.number(n),t=f.number(t),isNaN(n)||isNaN(t)){if("="===n[0]||"="===t[0])throw Error("NEED_UPDATE");isNaN(n)&&(n=0),isNaN(t)&&(t=0)}switch(r){case"+":e=n+t;break;case"-":e=n-t;break;case"/":if(e=n/t,1/0==e)throw Error("DIV_ZERO");if(isNaN(e))throw Error("VALUE");break;case"*":e=n*t;break;case"^":e=Math.pow(n,t)}return e},callFunction:function(r,t){if(r=r.toUpperCase(),t=t||[],n.helper.SUPPORTED_FORMULAS.indexOf(r)>-1&&n.formulas[r])return n.formulas[r].apply(this,t);throw Error("NAME")},callVariable:function(r){r=r||[];var t=r[0];if(t&&(t=t.toUpperCase(),n.formulas[t]))return"function"==typeof n.formulas[t]?n.formulas[t].apply(this,r):n.formulas[t];throw Error("NAME")},cellValue:function(r){var e,a=n.custom.cellValue,u=this,o=n.matrix.getItem(r);if(n.utils.isFunction(a)){var i=n.utils.cellCoords(r),l=n.utils.translateCellCoords({row:u.row,col:u.col});e=o?o.value:a(i.row,i.col),n.utils.isNull(e)&&(e=0),l&&n.matrix.updateItem(l,{deps:[r]})}else{if(o?e=o.value:(u=document.getElementById(r),u&&(e=u.value)),!e){u=t.querySelector("[data-cell-id="+r+"]");var f=u.getAttribute("data-original-value");e=void 0!==f?f:u.innerText||u.textContent}n.matrix.updateElementItem(u,{deps:[r]})}if(o&&o.deps&&-1!==o.deps.indexOf(l))throw Error("REF");if(o&&o.error)throw Error(o.error);if(n.utils.isSet(e)){var c=n.helper.number(e);return isNaN(c)?e:c}throw Error("NOT_AVAILABLE")},cellRangeValue:function(r,t){var e=n.custom.cellValue,a=n.utils.cellCoords(r),u=n.utils.cellCoords(t),o=this,i=n.utils.iterateCells.call(this,a,u),l=[];if(n.utils.isFunction(e)){var f=n.utils.translateCellCoords({row:o.row,col:o.col});n.matrix.updateItem(f,{deps:i.index})}else n.matrix.updateElementItem(o,{deps:i.index});return l.push(i.value),l},fixedCellValue:function(r){return r=r.replace(/\$/g,""),n.helper.cellValue.call(this,r)},fixedCellRangeValue:function(r,t){return r=r.replace(/\$/g,""),t=t.replace(/\$/g,""),n.helper.cellRangeValue.call(this,r,t)}},c=function(r,t){var e=null,u=null;try{a.setObj(t),e=a.parse(r);var i;t instanceof HTMLElement?i=t.getAttribute("data-cell-id"):t&&t.id&&(i=t.id);var l=n.matrix.getDependencies(i);if(-1!==l.indexOf(i))throw e=null,l.forEach(function(r){n.matrix.updateItem(r,{value:null,error:o.get("REF")})}),Error("REF")}catch(f){var c=o.get(f.message);u=c?c:o.get("ERROR")}return{error:u,result:e}},s=function(){n=this,a=new u(n),n.formulas=Formula,n.matrix=new i,n.custom={},t&&n.matrix.scan()};return{init:s,version:e,utils:l,helper:f,parse:c}};_u="function"==typeof _&&_.noConflict(),function(){function r(r,n,t){for(var e=(t||0)-1,a=r?r.length:0;++e<a;)if(r[e]===n)return e;return-1}function n(n,t){var e=typeof t;if(n=n.cache,"boolean"==e||null==t)return n[t]?0:-1;"number"!=e&&"string"!=e&&(e="object");var a="number"==e?t:v+t;return n=(n=n[e])&&n[a],"object"==e?n&&r(n,t)>-1?0:-1:n?0:-1}function t(r){var n=this.cache,t=typeof r;if("boolean"==t||null==r)n[r]=!0;else{"number"!=t&&"string"!=t&&(t="object");var e="number"==t?r:v+r,a=n[t]||(n[t]={});"object"==t?(a[e]||(a[e]=[])).push(r):a[e]=!0}}function e(r){return r.charCodeAt(0)}function a(r,n){for(var t=r.criteria,e=n.criteria,a=-1,u=t.length;++a<u;){var o=t[a],i=e[a];if(o!==i){if(o>i||"undefined"==typeof o)return 1;if(i>o||"undefined"==typeof i)return-1}}return r.index-n.index}function u(r){var n=-1,e=r.length,a=r[0],u=r[e/2|0],o=r[e-1];if(a&&"object"==typeof a&&u&&"object"==typeof u&&o&&"object"==typeof o)return!1;var i=l();i["false"]=i["null"]=i["true"]=i.undefined=!1;var f=l();for(f.array=r,f.cache=i,f.push=t;++n<e;)f.push(r[n]);return f}function o(r){return"\\"+$[r]}function i(){return h.pop()||[]}function l(){return g.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function f(r){r.length=0,h.length<F&&h.push(r)}function c(r){var n=r.cache;n&&c(n),r.array=r.cache=r.criteria=r.object=r.number=r.string=r.value=null,g.length<F&&g.push(r)}function s(r,n,t){n||(n=0),"undefined"==typeof t&&(t=r?r.length:0);for(var e=-1,a=t-n||0,u=Array(0>a?0:a);++e<a;)u[e]=r[n+e];return u}function m(t){function h(r){return r&&"object"==typeof r&&!Ze(r)&&Le.call(r,"__wrapped__")?r:new g(r)}function g(r,n){this.__chain__=!!n,this.__wrapped__=r}function F(r){function n(){if(e){var r=s(e);De.apply(r,arguments)}if(this instanceof n){var u=W(t.prototype),o=t.apply(u,r||arguments);return Cn(o)?o:u}return t.apply(a,r||arguments)}var t=r[0],e=r[2],a=r[4];return Qe(n,r),n}function $(r,n,t,e,a){if(t){var u=t(r);if("undefined"!=typeof u)return u}var o=Cn(r);if(!o)return r;var l=Se.call(r);if(!q[l])return r;var c=We[l];switch(l){case _:case V:return new c(+r);case P:case G:return new c(r);case B:return u=c(r.source,b.exec(r)),u.lastIndex=r.lastIndex,u}var m=Ze(r);if(n){var p=!e;e||(e=i()),a||(a=i());for(var h=e.length;h--;)if(e[h]==r)return a[h];u=m?c(r.length):{}}else u=m?s(r):ua({},r);return m&&(Le.call(r,"index")&&(u.index=r.index),Le.call(r,"input")&&(u.input=r.input)),n?(e.push(r),a.push(u),(m?Qn:la)(r,function(r,o){u[o]=$(r,n,t,e,a)}),p&&(f(e),f(a)),u):u}function W(r){return Cn(r)?ke(r):{}}function K(r,n,t){if("function"!=typeof r)return Zt;if("undefined"==typeof n||!("prototype"in r))return r;var e=r.__bindData__;if("undefined"==typeof e&&(Ke.funcNames&&(e=!r.name),e=e||!Ke.funcDecomp,!e)){var a=Oe.call(r);Ke.funcNames||(e=!T.test(a)),e||(e=R.test(a),Qe(r,e))}if(e===!1||e!==!0&&1&e[1])return r;switch(t){case 1:return function(t){return r.call(n,t)};case 2:return function(t,e){return r.call(n,t,e)};case 3:return function(t,e,a){return r.call(n,t,e,a)};case 4:return function(t,e,a,u){return r.call(n,t,e,a,u)}}return Dt(r,n)}function Q(r){function n(){var r=l?o:this;if(a){var h=s(a);De.apply(h,arguments)}if((u||c)&&(h||(h=s(arguments)),u&&De.apply(h,u),c&&h.length<i))return e|=16,Q([t,m?e:-4&e,h,null,o,i]);if(h||(h=arguments),f&&(t=r[p]),this instanceof n){r=W(t.prototype);var g=t.apply(r,h);return Cn(g)?g:r}return t.apply(r,h)}var t=r[0],e=r[1],a=r[2],u=r[3],o=r[4],i=r[5],l=1&e,f=2&e,c=4&e,m=8&e,p=t;return Qe(n,r),n}function Z(t,e){var a=-1,o=fn(),i=t?t.length:0,l=i>=M&&o===r,f=[];if(l){var s=u(e);s?(o=n,e=s):l=!1}for(;++a<i;){var m=t[a];o(e,m)<0&&f.push(m)}return l&&c(e),f}function rn(r,n,t,e){for(var a=(e||0)-1,u=r?r.length:0,o=[];++a<u;){var i=r[a];if(i&&"object"==typeof i&&"number"==typeof i.length&&(Ze(i)||pn(i))){n||(i=rn(i,n,t));var l=-1,f=i.length,c=o.length;for(o.length+=f;++l<f;)o[c++]=i[l]}else t||o.push(i)}return o}function nn(r,n,t,e,a,u){if(t){var o=t(r,n);if("undefined"!=typeof o)return!!o}if(r===n)return 0!==r||1/r==1/n;var l=typeof r,c=typeof n;if(!(r!==r||r&&H[l]||n&&H[c]))return!1;if(null==r||null==n)return r===n;var s=Se.call(r),m=Se.call(n);if(s==L&&(s=k),m==L&&(m=k),s!=m)return!1;switch(s){case _:case V:return+r==+n;case P:return r!=+r?n!=+n:0==r?1/r==1/n:r==+n;case B:case G:return r==ye(n)}var p=s==D;if(!p){var h=Le.call(r,"__wrapped__"),g=Le.call(n,"__wrapped__");if(h||g)return nn(h?r.__wrapped__:r,g?n.__wrapped__:n,t,e,a,u);if(s!=k)return!1;var d=r.constructor,v=n.constructor;if(d!=v&&!(Rn(d)&&d instanceof d&&Rn(v)&&v instanceof v)&&"constructor"in r&&"constructor"in n)return!1}var M=!a;a||(a=i()),u||(u=i());for(var F=a.length;F--;)if(a[F]==r)return u[F]==n;var N=0;if(o=!0,a.push(r),u.push(n),p){if(F=r.length,N=n.length,o=N==F,o||e)for(;N--;){var E=F,y=n[N];if(e)for(;E--&&!(o=nn(r[E],y,t,e,a,u)););else if(!(o=nn(r[N],y,t,e,a,u)))break}}else ia(n,function(n,i,l){return Le.call(l,i)?(N++,o=Le.call(r,i)&&nn(r[i],n,t,e,a,u)):void 0}),o&&!e&&ia(r,function(r,n,t){return Le.call(t,n)?o=--N>-1:void 0});return a.pop(),u.pop(),M&&(f(a),f(u)),o}function tn(r,n,t,e,a){(Ze(n)?Qn:la)(n,function(n,u){var o,i,l=n,f=r[u];if(n&&((i=Ze(n))||fa(n))){for(var c=e.length;c--;)if(o=e[c]==n){f=a[c];break}if(!o){var s;t&&(l=t(f,n),(s="undefined"!=typeof l)&&(f=l)),s||(f=i?Ze(f)?f:[]:fa(f)?f:{}),e.push(n),a.push(f),s||tn(f,n,t,e,a)}}else t&&(l=t(f,n),"undefined"==typeof l&&(l=n)),"undefined"!=typeof l&&(f=l);r[u]=f})}function en(r,n){return r+Ce(ze()*(n-r+1))}function an(t,e,a){var o=-1,l=fn(),s=t?t.length:0,m=[],p=!e&&s>=M&&l===r,h=a||p?i():m;if(p){var g=u(h);l=n,h=g}for(;++o<s;){var d=t[o],v=a?a(d,o,t):d;(e?!o||h[h.length-1]!==v:l(h,v)<0)&&((a||p)&&h.push(v),m.push(d))}return p?(f(h.array),c(h)):a&&f(h),m}function un(r){return function(n,t,e){var a={};t=h.createCallback(t,e,3);var u=-1,o=n?n.length:0;if("number"==typeof o)for(;++u<o;){var i=n[u];r(a,i,t(i,u,n),n)}else la(n,function(n,e,u){r(a,n,t(n,e,u),u)});return a}}function on(r,n,t,e,a,u){var o=1&n,i=2&n,l=4&n,f=16&n,c=32&n;if(!i&&!Rn(r))throw new Ie;f&&!t.length&&(n&=-17,f=t=!1),c&&!e.length&&(n&=-33,c=e=!1);var m=r&&r.__bindData__;if(m&&m!==!0)return m=s(m),m[2]&&(m[2]=s(m[2])),m[3]&&(m[3]=s(m[3])),!o||1&m[1]||(m[4]=a),!o&&1&m[1]&&(n|=8),!l||4&m[1]||(m[5]=u),f&&De.apply(m[2]||(m[2]=[]),t),c&&je.apply(m[3]||(m[3]=[]),e),m[1]|=n,on.apply(null,m);var p=1==n||17===n?F:Q;return p([r,n,t,e,a,u])}function ln(r){return na[r]}function fn(){var n=(n=h.indexOf)===Mt?r:n;return n}function cn(r){return"function"==typeof r&&we.test(r)}function sn(r){var n,t;return r&&Se.call(r)==k&&(n=r.constructor,!Rn(n)||n instanceof n)?(ia(r,function(r,n){t=n}),"undefined"==typeof t||Le.call(r,t)):!1}function mn(r){return ta[r]}function pn(r){return r&&"object"==typeof r&&"number"==typeof r.length&&Se.call(r)==L||!1}function hn(r,n,t,e){return"boolean"!=typeof n&&null!=n&&(e=t,t=n,n=!1),$(r,n,"function"==typeof t&&K(t,e,1))}function gn(r,n,t){return $(r,!0,"function"==typeof n&&K(n,t,1))}function dn(r,n){var t=W(r);return n?ua(t,n):t}function vn(r,n,t){var e;return n=h.createCallback(n,t,3),la(r,function(r,t,a){return n(r,t,a)?(e=t,!1):void 0}),e}function Mn(r,n,t){var e;return n=h.createCallback(n,t,3),Nn(r,function(r,t,a){return n(r,t,a)?(e=t,!1):void 0}),e}function Fn(r,n,t){var e=[];ia(r,function(r,n){e.push(n,r)});var a=e.length;for(n=K(n,t,3);a--&&n(e[a--],e[a],r)!==!1;);return r}function Nn(r,n,t){var e=ra(r),a=e.length;for(n=K(n,t,3);a--;){var u=e[a];if(n(r[u],u,r)===!1)break}return r}function En(r){var n=[];return ia(r,function(r,t){Rn(r)&&n.push(t)}),n.sort()}function yn(r,n){return r?Le.call(r,n):!1}function In(r){for(var n=-1,t=ra(r),e=t.length,a={};++n<e;){var u=t[n];a[r[u]]=u}return a}function An(r){return r===!0||r===!1||r&&"object"==typeof r&&Se.call(r)==_||!1}function bn(r){return r&&"object"==typeof r&&Se.call(r)==V||!1}function Tn(r){return r&&1===r.nodeType||!1}function Sn(r){var n=!0;if(!r)return n;var t=Se.call(r),e=r.length;return t==D||t==G||t==L||t==k&&"number"==typeof e&&Rn(r.splice)?!e:(la(r,function(){return n=!1}),n)}function wn(r,n,t,e){return nn(r,n,"function"==typeof t&&K(t,e,2))}function Un(r){return Ge(r)&&!qe(parseFloat(r))}function Rn(r){return"function"==typeof r}function Cn(r){return!(!r||!H[typeof r])}function On(r){return Ln(r)&&r!=+r}function xn(r){return null===r}function Ln(r){return"number"==typeof r||r&&"object"==typeof r&&Se.call(r)==P||!1}function Dn(r){return r&&"object"==typeof r&&Se.call(r)==B||!1}function _n(r){return"string"==typeof r||r&&"object"==typeof r&&Se.call(r)==G||!1}function Vn(r){return"undefined"==typeof r}function jn(r,n,t){var e={};return n=h.createCallback(n,t,3),la(r,function(r,t,a){e[t]=n(r,t,a)}),e}function Pn(r){var n=arguments,t=2;if(!Cn(r))return r;if("number"!=typeof n[2]&&(t=n.length),t>3&&"function"==typeof n[t-2])var e=K(n[--t-1],n[t--],2);else t>2&&"function"==typeof n[t-1]&&(e=n[--t]);for(var a=s(arguments,1,t),u=-1,o=i(),l=i();++u<t;)tn(r,a[u],e,o,l);return f(o),f(l),r}function kn(r,n,t){var e={};if("function"!=typeof n){var a=[];ia(r,function(r,n){a.push(n)}),a=Z(a,rn(arguments,!0,!1,1));for(var u=-1,o=a.length;++u<o;){var i=a[u];e[i]=r[i]}}else n=h.createCallback(n,t,3),ia(r,function(r,t,a){n(r,t,a)||(e[t]=r)});return e}function Bn(r){for(var n=-1,t=ra(r),e=t.length,a=he(e);++n<e;){var u=t[n];a[n]=[u,r[u]]}return a}function Gn(r,n,t){var e={};if("function"!=typeof n)for(var a=-1,u=rn(arguments,!0,!1,1),o=Cn(r)?u.length:0;++a<o;){var i=u[a];i in r&&(e[i]=r[i])}else n=h.createCallback(n,t,3),ia(r,function(r,t,a){n(r,t,a)&&(e[t]=r)});return e}function qn(r,n,t,e){var a=Ze(r);if(null==t)if(a)t=[];else{var u=r&&r.constructor,o=u&&u.prototype;t=W(o)}return n&&(n=h.createCallback(n,e,4),(a?Qn:la)(r,function(r,e,a){return n(t,r,e,a)})),t}function Yn(r){for(var n=-1,t=ra(r),e=t.length,a=he(e);++n<e;)a[n]=r[t[n]];return a}function Xn(r){for(var n=arguments,t=-1,e=rn(n,!0,!1,1),a=n[2]&&n[2][n[1]]===r?1:e.length,u=he(a);++t<a;)u[t]=r[e[t]];return u}function Hn(r,n,t){var e=-1,a=fn(),u=r?r.length:0,o=!1;return t=(0>t?Xe(0,u+t):t)||0,Ze(r)?o=a(r,n,t)>-1:"number"==typeof u?o=(_n(r)?r.indexOf(n,t):a(r,n,t))>-1:la(r,function(r){return++e>=t?!(o=r===n):void 0}),o}function $n(r,n,t){var e=!0;n=h.createCallback(n,t,3);var a=-1,u=r?r.length:0;if("number"==typeof u)for(;++a<u&&(e=!!n(r[a],a,r)););else la(r,function(r,t,a){return e=!!n(r,t,a)});return e}function zn(r,n,t){var e=[];n=h.createCallback(n,t,3);var a=-1,u=r?r.length:0;if("number"==typeof u)for(;++a<u;){var o=r[a];n(o,a,r)&&e.push(o)}else la(r,function(r,t,a){n(r,t,a)&&e.push(r)});return e}function Wn(r,n,t){n=h.createCallback(n,t,3);var e=-1,a=r?r.length:0;if("number"!=typeof a){var u;return la(r,function(r,t,e){return n(r,t,e)?(u=r,!1):void 0}),u}for(;++e<a;){var o=r[e];if(n(o,e,r))return o}}function Kn(r,n,t){var e;return n=h.createCallback(n,t,3),Zn(r,function(r,t,a){return n(r,t,a)?(e=r,!1):void 0}),e}function Qn(r,n,t){var e=-1,a=r?r.length:0;if(n=n&&"undefined"==typeof t?n:K(n,t,3),"number"==typeof a)for(;++e<a&&n(r[e],e,r)!==!1;);else la(r,n);return r}function Zn(r,n,t){var e=r?r.length:0;if(n=n&&"undefined"==typeof t?n:K(n,t,3),"number"==typeof e)for(;e--&&n(r[e],e,r)!==!1;);else{var a=ra(r);e=a.length,la(r,function(r,t,u){return t=a?a[--e]:--e,n(u[t],t,u)})}return r}function Jn(r,n){var t=s(arguments,2),e=-1,a="function"==typeof n,u=r?r.length:0,o=he("number"==typeof u?u:0);return Qn(r,function(r){o[++e]=(a?n:r[n]).apply(r,t)}),o}function rt(r,n,t){var e=-1,a=r?r.length:0;if(n=h.createCallback(n,t,3),"number"==typeof a)for(var u=he(a);++e<a;)u[e]=n(r[e],e,r);else u=[],la(r,function(r,t,a){u[++e]=n(r,t,a)});return u}function nt(r,n,t){var a=-1/0,u=a;if("function"!=typeof n&&t&&t[n]===r&&(n=null),null==n&&Ze(r))for(var o=-1,i=r.length;++o<i;){var l=r[o];l>u&&(u=l)}else n=null==n&&_n(r)?e:h.createCallback(n,t,3),Qn(r,function(r,t,e){var o=n(r,t,e);o>a&&(a=o,u=r)});return u}function tt(r,n,t){var a=1/0,u=a;if("function"!=typeof n&&t&&t[n]===r&&(n=null),null==n&&Ze(r))for(var o=-1,i=r.length;++o<i;){var l=r[o];u>l&&(u=l)}else n=null==n&&_n(r)?e:h.createCallback(n,t,3),Qn(r,function(r,t,e){var o=n(r,t,e);a>o&&(a=o,u=r)});return u}function et(r,n,t,e){if(!r)return t;var a=arguments.length<3;n=h.createCallback(n,e,4);var u=-1,o=r.length;if("number"==typeof o)for(a&&(t=r[++u]);++u<o;)t=n(t,r[u],u,r);else la(r,function(r,e,u){t=a?(a=!1,r):n(t,r,e,u)});return t}function at(r,n,t,e){var a=arguments.length<3;return n=h.createCallback(n,e,4),Zn(r,function(r,e,u){t=a?(a=!1,r):n(t,r,e,u)}),t}function ut(r,n,t){return n=h.createCallback(n,t,3),zn(r,function(r,t,e){return!n(r,t,e)})}function ot(r,n,t){if(r&&"number"!=typeof r.length&&(r=Yn(r)),null==n||t)return r?r[en(0,r.length-1)]:p;var e=it(r);return e.length=He(Xe(0,n),e.length),e}function it(r){var n=-1,t=r?r.length:0,e=he("number"==typeof t?t:0);return Qn(r,function(r){var t=en(0,++n);e[n]=e[t],e[t]=r}),e}function lt(r){var n=r?r.length:0;return"number"==typeof n?n:ra(r).length}function ft(r,n,t){var e;n=h.createCallback(n,t,3);var a=-1,u=r?r.length:0;if("number"==typeof u)for(;++a<u&&!(e=n(r[a],a,r)););else la(r,function(r,t,a){return!(e=n(r,t,a))});return!!e}function ct(r,n,t){var e=-1,u=Ze(n),o=r?r.length:0,s=he("number"==typeof o?o:0);for(u||(n=h.createCallback(n,t,3)),Qn(r,function(r,t,a){var o=s[++e]=l();u?o.criteria=rt(n,function(n){return r[n]}):(o.criteria=i())[0]=n(r,t,a),o.index=e,o.value=r}),o=s.length,s.sort(a);o--;){var m=s[o];s[o]=m.value,u||f(m.criteria),c(m)}return s}function st(r){return r&&"number"==typeof r.length?s(r):Yn(r)}function mt(r){for(var n=-1,t=r?r.length:0,e=[];++n<t;){var a=r[n];a&&e.push(a)}return e}function pt(r){return Z(r,rn(arguments,!0,!0,1))}function ht(r,n,t){var e=-1,a=r?r.length:0;for(n=h.createCallback(n,t,3);++e<a;)if(n(r[e],e,r))return e;return-1}function gt(r,n,t){var e=r?r.length:0;for(n=h.createCallback(n,t,3);e--;)if(n(r[e],e,r))return e;return-1}function dt(r,n,t){var e=0,a=r?r.length:0;if("number"!=typeof n&&null!=n){var u=-1;for(n=h.createCallback(n,t,3);++u<a&&n(r[u],u,r);)e++}else if(e=n,null==e||t)return r?r[0]:p;return s(r,0,He(Xe(0,e),a))}function vt(r,n,t,e){return"boolean"!=typeof n&&null!=n&&(e=t,t="function"!=typeof n&&e&&e[n]===r?null:n,n=!1),null!=t&&(r=rt(r,t,e)),rn(r,n)}function Mt(n,t,e){if("number"==typeof e){var a=n?n.length:0;e=0>e?Xe(0,a+e):e||0}else if(e){var u=St(n,t);return n[u]===t?u:-1}return r(n,t,e)}function Ft(r,n,t){var e=0,a=r?r.length:0;if("number"!=typeof n&&null!=n){var u=a;for(n=h.createCallback(n,t,3);u--&&n(r[u],u,r);)e++}else e=null==n||t?1:n||e;return s(r,0,He(Xe(0,a-e),a))}function Nt(){for(var t=[],e=-1,a=arguments.length,o=i(),l=fn(),s=l===r,m=i();++e<a;){var p=arguments[e];(Ze(p)||pn(p))&&(t.push(p),o.push(s&&p.length>=M&&u(e?t[e]:m)))}var h=t[0],g=-1,d=h?h.length:0,v=[];r:for(;++g<d;){var F=o[0];if(p=h[g],(F?n(F,p):l(m,p))<0){for(e=a,(F||m).push(p);--e;)if(F=o[e],(F?n(F,p):l(t[e],p))<0)continue r;v.push(p)}}for(;a--;)F=o[a],F&&c(F);return f(o),f(m),v}function Et(r,n,t){var e=0,a=r?r.length:0;if("number"!=typeof n&&null!=n){var u=a;for(n=h.createCallback(n,t,3);u--&&n(r[u],u,r);)e++}else if(e=n,null==e||t)return r?r[a-1]:p;return s(r,Xe(0,a-e))}function yt(r,n,t){var e=r?r.length:0;for("number"==typeof t&&(e=(0>t?Xe(0,e+t):He(t,e-1))+1);e--;)if(r[e]===n)return e;return-1}function It(r){for(var n=arguments,t=0,e=n.length,a=r?r.length:0;++t<e;)for(var u=-1,o=n[t];++u<a;)r[u]===o&&(Ve.call(r,u--,1),a--);return r}function At(r,n,t){r=+r||0,t="number"==typeof t?t:+t||1,null==n&&(n=r,r=0);for(var e=-1,a=Xe(0,Ue((n-r)/(t||1))),u=he(a);++e<a;)u[e]=r,r+=t;return u}function bt(r,n,t){var e=-1,a=r?r.length:0,u=[];for(n=h.createCallback(n,t,3);++e<a;){var o=r[e];n(o,e,r)&&(u.push(o),Ve.call(r,e--,1),a--)}return u}function Tt(r,n,t){if("number"!=typeof n&&null!=n){var e=0,a=-1,u=r?r.length:0;for(n=h.createCallback(n,t,3);++a<u&&n(r[a],a,r);)e++}else e=null==n||t?1:Xe(0,n);return s(r,e)}function St(r,n,t,e){var a=0,u=r?r.length:a;for(t=t?h.createCallback(t,e,1):Zt,n=t(n);u>a;){var o=a+u>>>1;t(r[o])<n?a=o+1:u=o}return a}function wt(){return an(rn(arguments,!0,!0))}function Ut(r,n,t,e){return"boolean"!=typeof n&&null!=n&&(e=t,t="function"!=typeof n&&e&&e[n]===r?null:n,n=!1),null!=t&&(t=h.createCallback(t,e,3)),an(r,n,t)}function Rt(r){return Z(r,s(arguments,1))}function Ct(){for(var r=-1,n=arguments.length;++r<n;){var t=arguments[r];if(Ze(t)||pn(t))var e=e?an(Z(e,t).concat(Z(t,e))):t}return e||[]}function Ot(){for(var r=arguments.length>1?arguments:arguments[0],n=-1,t=r?nt(pa(r,"length")):0,e=he(0>t?0:t);++n<t;)e[n]=pa(r,n);return e}function xt(r,n){var t=-1,e=r?r.length:0,a={};for(n||!e||Ze(r[0])||(n=[]);++t<e;){var u=r[t];n?a[u]=n[t]:u&&(a[u[0]]=u[1])}return a}function Lt(r,n){if(!Rn(n))throw new Ie;return function(){return--r<1?n.apply(this,arguments):void 0}}function Dt(r,n){return arguments.length>2?on(r,17,s(arguments,2),null,n):on(r,1,null,null,n)}function _t(r){for(var n=arguments.length>1?rn(arguments,!0,!1,1):En(r),t=-1,e=n.length;++t<e;){var a=n[t];r[a]=on(r[a],1,null,null,r)}return r}function Vt(r,n){return arguments.length>2?on(n,19,s(arguments,2),null,r):on(n,3,null,null,r)}function jt(){for(var r=arguments,n=r.length;n--;)if(!Rn(r[n]))throw new Ie;return function(){for(var n=arguments,t=r.length;t--;)n=[r[t].apply(this,n)];return n[0]}}function Pt(r,n){return n="number"==typeof n?n:+n||r.length,on(r,4,null,null,null,n)}function kt(r,n,t){var e,a,u,o,i,l,f,c=0,s=!1,m=!0;if(!Rn(r))throw new Ie;if(n=Xe(0,n)||0,t===!0){var h=!0;m=!1}else Cn(t)&&(h=t.leading,s="maxWait"in t&&(Xe(n,t.maxWait)||0),m="trailing"in t?t.trailing:m);var g=function(){var t=n-(ga()-o);if(0>=t){a&&Re(a);var s=f;a=l=f=p,s&&(c=ga(),u=r.apply(i,e),l||a||(e=i=null))}else l=_e(g,t)},d=function(){l&&Re(l),a=l=f=p,(m||s!==n)&&(c=ga(),u=r.apply(i,e),l||a||(e=i=null))};return function(){if(e=arguments,o=ga(),i=this,f=m&&(l||!h),s===!1)var t=h&&!l;else{a||h||(c=o);var p=s-(o-c),v=0>=p;v?(a&&(a=Re(a)),c=o,u=r.apply(i,e)):a||(a=_e(d,p))}return v&&l?l=Re(l):l||n===s||(l=_e(g,n)),t&&(v=!0,u=r.apply(i,e)),!v||l||a||(e=i=null),u}}function Bt(r){if(!Rn(r))throw new Ie;var n=s(arguments,1);return _e(function(){r.apply(p,n)},1)}function Gt(r,n){if(!Rn(r))throw new Ie;var t=s(arguments,2);return _e(function(){r.apply(p,t)},n)}function qt(r,n){if(!Rn(r))throw new Ie;var t=function(){var e=t.cache,a=n?n.apply(this,arguments):v+arguments[0];return Le.call(e,a)?e[a]:e[a]=r.apply(this,arguments)};return t.cache={},t}function Yt(r){var n,t;if(!Rn(r))throw new Ie;return function(){return n?t:(n=!0,t=r.apply(this,arguments),r=null,t)}}function Xt(r){return on(r,16,s(arguments,1))}function Ht(r){return on(r,32,null,s(arguments,1))}function $t(r,n,t){var e=!0,a=!0;if(!Rn(r))throw new Ie;return t===!1?e=!1:Cn(t)&&(e="leading"in t?t.leading:e,a="trailing"in t?t.trailing:a),Y.leading=e,Y.maxWait=n,Y.trailing=a,kt(r,n,Y)}function zt(r,n){return on(n,16,[r])}function Wt(r){return function(){return r}}function Kt(r,n,t){var e=typeof r;if(null==r||"function"==e)return K(r,n,t);if("object"!=e)return te(r);var a=ra(r),u=a[0],o=r[u];return 1!=a.length||o!==o||Cn(o)?function(n){for(var t=a.length,e=!1;t--&&(e=nn(n[a[t]],r[a[t]],null,!0)););return e}:function(r){var n=r[u];return o===n&&(0!==o||1/o==1/n)}}function Qt(r){return null==r?"":ye(r).replace(aa,ln)}function Zt(r){return r}function Jt(r,n,t){var e=!0,a=n&&En(n);n&&(t||a.length)||(null==t&&(t=n),u=g,n=r,r=h,a=En(n)),t===!1?e=!1:Cn(t)&&"chain"in t&&(e=t.chain);var u=r,o=Rn(u);Qn(a,function(t){var a=r[t]=n[t];o&&(u.prototype[t]=function(){var n=this.__chain__,t=this.__wrapped__,o=[t];De.apply(o,arguments);var i=a.apply(r,o);if(e||n){if(t===i&&Cn(i))return this;i=new u(i),i.__chain__=n}return i})})}function re(){return t._=Te,this}function ne(){}function te(r){return function(n){return n[r]}}function ee(r,n,t){var e=null==r,a=null==n;if(null==t&&("boolean"==typeof r&&a?(t=r,r=1):a||"boolean"!=typeof n||(t=n,a=!0)),e&&a&&(n=1),r=+r||0,a?(n=r,r=0):n=+n||0,t||r%1||n%1){var u=ze();
return He(r+u*(n-r+parseFloat("1e-"+((u+"").length-1))),n)}return en(r,n)}function ae(r,n){if(r){var t=r[n];return Rn(t)?r[n]():t}}function ue(r,n,t){var e=h.templateSettings;r=ye(r||""),t=oa({},t,e);var a,u=oa({},t.imports,e.imports),i=ra(u),l=Yn(u),f=0,c=t.interpolate||U,s="__p += '",m=Ee((t.escape||U).source+"|"+c.source+"|"+(c===S?A:U).source+"|"+(t.evaluate||U).source+"|$","g");r.replace(m,function(n,t,e,u,i,l){return e||(e=u),s+=r.slice(f,l).replace(C,o),t&&(s+="' +\n__e("+t+") +\n'"),i&&(a=!0,s+="';\n"+i+";\n__p += '"),e&&(s+="' +\n((__t = ("+e+")) == null ? '' : __t) +\n'"),f=l+n.length,n}),s+="';\n";var g=t.variable,d=g;d||(g="obj",s="with ("+g+") {\n"+s+"\n}\n"),s=(a?s.replace(E,""):s).replace(y,"$1").replace(I,"$1;"),s="function("+g+") {\n"+(d?"":g+" || ("+g+" = {});\n")+"var __t, __p = '', __e = _.escape"+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+s+"return __p\n}";var v="\n/*\n//# sourceURL="+(t.sourceURL||"/lodash/template/source["+x++ +"]")+"\n*/";try{var M=ve(i,"return "+s+v).apply(p,l)}catch(F){throw F.source=s,F}return n?M(n):(M.source=s,M)}function oe(r,n,t){r=(r=+r)>-1?r:0;var e=-1,a=he(r);for(n=K(n,t,1);++e<r;)a[e]=n(e);return a}function ie(r){return null==r?"":ye(r).replace(ea,mn)}function le(r){var n=++d;return ye(null==r?"":r)+n}function fe(r){return r=new g(r),r.__chain__=!0,r}function ce(r,n){return n(r),r}function se(){return this.__chain__=!0,this}function me(){return ye(this.__wrapped__)}function pe(){return this.__wrapped__}t=t?J.defaults(z.Object(),t,J.pick(z,O)):z;var he=t.Array,ge=t.Boolean,de=t.Date,ve=t.Function,Me=t.Math,Fe=t.Number,Ne=t.Object,Ee=t.RegExp,ye=t.String,Ie=t.TypeError,Ae=[],be=Ne.prototype,Te=t._,Se=be.toString,we=Ee("^"+ye(Se).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Ue=Me.ceil,Re=t.clearTimeout,Ce=Me.floor,Oe=ve.prototype.toString,xe=cn(xe=Ne.getPrototypeOf)&&xe,Le=be.hasOwnProperty,De=Ae.push,_e=t.setTimeout,Ve=Ae.splice,je=Ae.unshift,Pe=function(){try{var r={},n=cn(n=Ne.defineProperty)&&n,t=n(r,r,r)&&n}catch(e){}return t}(),ke=cn(ke=Ne.create)&&ke,Be=cn(Be=he.isArray)&&Be,Ge=t.isFinite,qe=t.isNaN,Ye=cn(Ye=Ne.keys)&&Ye,Xe=Me.max,He=Me.min,$e=t.parseInt,ze=Me.random,We={};We[D]=he,We[_]=ge,We[V]=de,We[j]=ve,We[k]=Ne,We[P]=Fe,We[B]=Ee,We[G]=ye,g.prototype=h.prototype;var Ke=h.support={};Ke.funcDecomp=!cn(t.WinRTError)&&R.test(m),Ke.funcNames="string"==typeof ve.name,h.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:S,variable:"",imports:{_:h}},ke||(W=function(){function r(){}return function(n){if(Cn(n)){r.prototype=n;var e=new r;r.prototype=null}return e||t.Object()}}());var Qe=Pe?function(r,n){X.value=n,Pe(r,"__bindData__",X)}:ne,Ze=Be||function(r){return r&&"object"==typeof r&&"number"==typeof r.length&&Se.call(r)==D||!1},Je=function(r){var n,t=r,e=[];if(!t)return e;if(!H[typeof r])return e;for(n in t)Le.call(t,n)&&e.push(n);return e},ra=Ye?function(r){return Cn(r)?Ye(r):[]}:Je,na={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ta=In(na),ea=Ee("("+ra(ta).join("|")+")","g"),aa=Ee("["+ra(na).join("")+"]","g"),ua=function(r,n,t){var e,a=r,u=a;if(!a)return u;var o=arguments,i=0,l="number"==typeof t?2:o.length;if(l>3&&"function"==typeof o[l-2])var f=K(o[--l-1],o[l--],2);else l>2&&"function"==typeof o[l-1]&&(f=o[--l]);for(;++i<l;)if(a=o[i],a&&H[typeof a])for(var c=-1,s=H[typeof a]&&ra(a),m=s?s.length:0;++c<m;)e=s[c],u[e]=f?f(u[e],a[e]):a[e];return u},oa=function(r,n,t){var e,a=r,u=a;if(!a)return u;for(var o=arguments,i=0,l="number"==typeof t?2:o.length;++i<l;)if(a=o[i],a&&H[typeof a])for(var f=-1,c=H[typeof a]&&ra(a),s=c?c.length:0;++f<s;)e=c[f],"undefined"==typeof u[e]&&(u[e]=a[e]);return u},ia=function(r,n,t){var e,a=r,u=a;if(!a)return u;if(!H[typeof a])return u;n=n&&"undefined"==typeof t?n:K(n,t,3);for(e in a)if(n(a[e],e,r)===!1)return u;return u},la=function(r,n,t){var e,a=r,u=a;if(!a)return u;if(!H[typeof a])return u;n=n&&"undefined"==typeof t?n:K(n,t,3);for(var o=-1,i=H[typeof a]&&ra(a),l=i?i.length:0;++o<l;)if(e=i[o],n(a[e],e,r)===!1)return u;return u},fa=xe?function(r){if(!r||Se.call(r)!=k)return!1;var n=r.valueOf,t=cn(n)&&(t=xe(n))&&xe(t);return t?r==t||xe(r)==t:sn(r)}:sn,ca=un(function(r,n,t){Le.call(r,t)?r[t]++:r[t]=1}),sa=un(function(r,n,t){(Le.call(r,t)?r[t]:r[t]=[]).push(n)}),ma=un(function(r,n,t){r[t]=n}),pa=rt,ha=zn,ga=cn(ga=de.now)&&ga||function(){return(new de).getTime()},da=8==$e(N+"08")?$e:function(r,n){return $e(_n(r)?r.replace(w,""):r,n||0)};return h.after=Lt,h.assign=ua,h.at=Xn,h.bind=Dt,h.bindAll=_t,h.bindKey=Vt,h.chain=fe,h.compact=mt,h.compose=jt,h.constant=Wt,h.countBy=ca,h.create=dn,h.createCallback=Kt,h.curry=Pt,h.debounce=kt,h.defaults=oa,h.defer=Bt,h.delay=Gt,h.difference=pt,h.filter=zn,h.flatten=vt,h.forEach=Qn,h.forEachRight=Zn,h.forIn=ia,h.forInRight=Fn,h.forOwn=la,h.forOwnRight=Nn,h.functions=En,h.groupBy=sa,h.indexBy=ma,h.initial=Ft,h.intersection=Nt,h.invert=In,h.invoke=Jn,h.keys=ra,h.map=rt,h.mapValues=jn,h.max=nt,h.memoize=qt,h.merge=Pn,h.min=tt,h.omit=kn,h.once=Yt,h.pairs=Bn,h.partial=Xt,h.partialRight=Ht,h.pick=Gn,h.pluck=pa,h.property=te,h.pull=It,h.range=At,h.reject=ut,h.remove=bt,h.rest=Tt,h.shuffle=it,h.sortBy=ct,h.tap=ce,h.throttle=$t,h.times=oe,h.toArray=st,h.transform=qn,h.union=wt,h.uniq=Ut,h.values=Yn,h.where=ha,h.without=Rt,h.wrap=zt,h.xor=Ct,h.zip=Ot,h.zipObject=xt,h.collect=rt,h.drop=Tt,h.each=Qn,h.eachRight=Zn,h.extend=ua,h.methods=En,h.object=xt,h.select=zn,h.tail=Tt,h.unique=Ut,h.unzip=Ot,Jt(h),h.clone=hn,h.cloneDeep=gn,h.contains=Hn,h.escape=Qt,h.every=$n,h.find=Wn,h.findIndex=ht,h.findKey=vn,h.findLast=Kn,h.findLastIndex=gt,h.findLastKey=Mn,h.has=yn,h.identity=Zt,h.indexOf=Mt,h.isArguments=pn,h.isArray=Ze,h.isBoolean=An,h.isDate=bn,h.isElement=Tn,h.isEmpty=Sn,h.isEqual=wn,h.isFinite=Un,h.isFunction=Rn,h.isNaN=On,h.isNull=xn,h.isNumber=Ln,h.isObject=Cn,h.isPlainObject=fa,h.isRegExp=Dn,h.isString=_n,h.isUndefined=Vn,h.lastIndexOf=yt,h.mixin=Jt,h.noConflict=re,h.noop=ne,h.now=ga,h.parseInt=da,h.random=ee,h.reduce=et,h.reduceRight=at,h.result=ae,h.runInContext=m,h.size=lt,h.some=ft,h.sortedIndex=St,h.template=ue,h.unescape=ie,h.uniqueId=le,h.all=$n,h.any=ft,h.detect=Wn,h.findWhere=Wn,h.foldl=et,h.foldr=at,h.include=Hn,h.inject=et,Jt(function(){var r={};return la(h,function(n,t){h.prototype[t]||(r[t]=n)}),r}(),!1),h.first=dt,h.last=Et,h.sample=ot,h.take=dt,h.head=dt,la(h,function(r,n){var t="sample"!==n;h.prototype[n]||(h.prototype[n]=function(n,e){var a=this.__chain__,u=r(this.__wrapped__,n,e);return a||null!=n&&(!e||t&&"function"==typeof n)?new g(u,a):u})}),h.VERSION="2.4.1",h.prototype.chain=se,h.prototype.toString=me,h.prototype.value=pe,h.prototype.valueOf=pe,Qn(["join","pop","shift"],function(r){var n=Ae[r];h.prototype[r]=function(){var r=this.__chain__,t=n.apply(this.__wrapped__,arguments);return r?new g(t,r):t}}),Qn(["push","reverse","sort","unshift"],function(r){var n=Ae[r];h.prototype[r]=function(){return n.apply(this.__wrapped__,arguments),this}}),Qn(["concat","slice","splice"],function(r){var n=Ae[r];h.prototype[r]=function(){return new g(n.apply(this.__wrapped__,arguments),this.__chain__)}}),h}var p,h=[],g=[],d=0,v=+new Date+"",M=75,F=40,N=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",E=/\b__p \+= '';/g,y=/\b(__p \+=) '' \+/g,I=/(__e\(.*?\)|\b__t\)) \+\n'';/g,A=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,b=/\w*$/,T=/^\s*function[ \n\r\t]+\w/,S=/<%=([\s\S]+?)%>/g,w=RegExp("^["+N+"]*0+(?=.$)"),U=/($^)/,R=/\bthis\b/,C=/['\n\r\t\u2028\u2029\\]/g,O=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],x=0,L="[object Arguments]",D="[object Array]",_="[object Boolean]",V="[object Date]",j="[object Function]",P="[object Number]",k="[object Object]",B="[object RegExp]",G="[object String]",q={};q[j]=!1,q[L]=q[D]=q[_]=q[V]=q[P]=q[k]=q[B]=q[G]=!0;var Y={leading:!1,maxWait:0,trailing:!1},X={configurable:!1,enumerable:!1,value:null,writable:!1},H={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},$={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},z=H[typeof window]&&window||this,W=H[typeof exports]&&exports&&!exports.nodeType&&exports,K=H[typeof module]&&module&&!module.nodeType&&module,Q=K&&K.exports===W&&W,Z=H[typeof global]&&global;!Z||Z.global!==Z&&Z.window!==Z||(z=Z);var J=m();if("function"==typeof define&&"object"==typeof define.amd&&define.amd)z._=J,define(function(){return J});else{if(!W||!K)return z._=z._||{},z._=J,z._;Q?(K.exports=J)._=J:W._=J}}.call(this),!function(r,n){"use strict";function t(r,n){var t,e,a=r.toLowerCase();for(n=[].concat(n),t=0;t<n.length;t+=1)if(e=n[t]){if(e.test&&e.test(r))return!0;if(e.toLowerCase()===a)return!0}}var e=n.prototype.trim,a=n.prototype.trimRight,u=n.prototype.trimLeft,o=function(r){return 1*r||0},i=function(r,n){if(1>n)return"";for(var t="";n>0;)1&n&&(t+=r),n>>=1,r+=r;return t},l=[].slice,f=function(r){return null==r?"\\s":r.source?r.source:"["+h.escapeRegExp(r)+"]"},c={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"},s={};for(var m in c)s[c[m]]=m;s["'"]="#39";var p=function(){function r(r){return Object.prototype.toString.call(r).slice(8,-1).toLowerCase()}var t=i,e=function(){return e.cache.hasOwnProperty(arguments[0])||(e.cache[arguments[0]]=e.parse(arguments[0])),e.format.call(null,e.cache[arguments[0]],arguments)};return e.format=function(e,a){var u,o,i,l,f,c,s,m=1,h=e.length,g="",d=[];for(o=0;h>o;o++)if(g=r(e[o]),"string"===g)d.push(e[o]);else if("array"===g){if(l=e[o],l[2])for(u=a[m],i=0;i<l[2].length;i++){if(!u.hasOwnProperty(l[2][i]))throw new Error(p('[_.sprintf] property "%s" does not exist',l[2][i]));u=u[l[2][i]]}else u=l[1]?a[l[1]]:a[m++];if(/[^s]/.test(l[8])&&"number"!=r(u))throw new Error(p("[_.sprintf] expecting number but found %s",r(u)));switch(l[8]){case"b":u=u.toString(2);break;case"c":u=n.fromCharCode(u);break;case"d":u=parseInt(u,10);break;case"e":u=l[7]?u.toExponential(l[7]):u.toExponential();break;case"f":u=l[7]?parseFloat(u).toFixed(l[7]):parseFloat(u);break;case"o":u=u.toString(8);break;case"s":u=(u=n(u))&&l[7]?u.substring(0,l[7]):u;break;case"u":u=Math.abs(u);break;case"x":u=u.toString(16);break;case"X":u=u.toString(16).toUpperCase()}u=/[def]/.test(l[8])&&l[3]&&u>=0?"+"+u:u,c=l[4]?"0"==l[4]?"0":l[4].charAt(1):" ",s=l[6]-n(u).length,f=l[6]?t(c,s):"",d.push(l[5]?u+f:f+u)}return d.join("")},e.cache={},e.parse=function(r){for(var n=r,t=[],e=[],a=0;n;){if(null!==(t=/^[^\x25]+/.exec(n)))e.push(t[0]);else if(null!==(t=/^\x25{2}/.exec(n)))e.push("%");else{if(null===(t=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(n)))throw new Error("[_.sprintf] huh?");if(t[2]){a|=1;var u=[],o=t[2],i=[];if(null===(i=/^([a-z_][a-z_\d]*)/i.exec(o)))throw new Error("[_.sprintf] huh?");for(u.push(i[1]);""!==(o=o.substring(i[0].length));)if(null!==(i=/^\.([a-z_][a-z_\d]*)/i.exec(o)))u.push(i[1]);else{if(null===(i=/^\[(\d+)\]/.exec(o)))throw new Error("[_.sprintf] huh?");u.push(i[1])}t[2]=u}else a|=2;if(3===a)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");e.push(t)}n=n.substring(t[0].length)}return e},e}(),h={VERSION:"2.3.0",isBlank:function(r){return null==r&&(r=""),/^\s*$/.test(r)},stripTags:function(r){return null==r?"":n(r).replace(/<\/?[^>]+>/g,"")},capitalize:function(r){return r=null==r?"":n(r),r.charAt(0).toUpperCase()+r.slice(1)},chop:function(r,t){return null==r?[]:(r=n(r),t=~~t,t>0?r.match(new RegExp(".{1,"+t+"}","g")):[r])},clean:function(r){return h.strip(r).replace(/\s+/g," ")},count:function(r,t){if(null==r||null==t)return 0;r=n(r),t=n(t);for(var e=0,a=0,u=t.length;;){if(a=r.indexOf(t,a),-1===a)break;e++,a+=u}return e},chars:function(r){return null==r?[]:n(r).split("")},swapCase:function(r){return null==r?"":n(r).replace(/\S/g,function(r){return r===r.toUpperCase()?r.toLowerCase():r.toUpperCase()})},escapeHTML:function(r){return null==r?"":n(r).replace(/[&<>"']/g,function(r){return"&"+s[r]+";"})},unescapeHTML:function(r){return null==r?"":n(r).replace(/\&([^;]+);/g,function(r,t){var e;return t in c?c[t]:(e=t.match(/^#x([\da-fA-F]+)$/))?n.fromCharCode(parseInt(e[1],16)):(e=t.match(/^#(\d+)$/))?n.fromCharCode(~~e[1]):r})},escapeRegExp:function(r){return null==r?"":n(r).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},splice:function(r,n,t,e){var a=h.chars(r);return a.splice(~~n,~~t,e),a.join("")},insert:function(r,n,t){return h.splice(r,n,0,t)},include:function(r,t){return""===t?!0:null==r?!1:-1!==n(r).indexOf(t)},join:function(){var r=l.call(arguments),n=r.shift();return null==n&&(n=""),r.join(n)},lines:function(r){return null==r?[]:n(r).split("\n")},reverse:function(r){return h.chars(r).reverse().join("")},startsWith:function(r,t){return""===t?!0:null==r||null==t?!1:(r=n(r),t=n(t),r.length>=t.length&&r.slice(0,t.length)===t)},endsWith:function(r,t){return""===t?!0:null==r||null==t?!1:(r=n(r),t=n(t),r.length>=t.length&&r.slice(r.length-t.length)===t)},succ:function(r){return null==r?"":(r=n(r),r.slice(0,-1)+n.fromCharCode(r.charCodeAt(r.length-1)+1))},titleize:function(r){return null==r?"":(r=n(r).toLowerCase(),r.replace(/(?:^|\s|-)\S/g,function(r){return r.toUpperCase()}))},camelize:function(r){return h.trim(r).replace(/[-_\s]+(.)?/g,function(r,n){return n?n.toUpperCase():""})},underscored:function(r){return h.trim(r).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(r){return h.trim(r).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},classify:function(r){return h.titleize(n(r).replace(/[\W_]/g," ")).replace(/\s/g,"")},humanize:function(r){return h.capitalize(h.underscored(r).replace(/_id$/,"").replace(/_/g," "))},trim:function(r,t){return null==r?"":!t&&e?e.call(r):(t=f(t),n(r).replace(new RegExp("^"+t+"+|"+t+"+$","g"),""))},ltrim:function(r,t){return null==r?"":!t&&u?u.call(r):(t=f(t),n(r).replace(new RegExp("^"+t+"+"),""))},rtrim:function(r,t){return null==r?"":!t&&a?a.call(r):(t=f(t),n(r).replace(new RegExp(t+"+$"),""))},truncate:function(r,t,e){return null==r?"":(r=n(r),e=e||"...",t=~~t,r.length>t?r.slice(0,t)+e:r)},prune:function(r,t,e){if(null==r)return"";if(r=n(r),t=~~t,e=null!=e?n(e):"...",r.length<=t)return r;var a=function(r){return r.toUpperCase()!==r.toLowerCase()?"A":" "},u=r.slice(0,t+1).replace(/.(?=\W*\w*$)/g,a);return u=u.slice(u.length-2).match(/\w\w/)?u.replace(/\s*\S+$/,""):h.rtrim(u.slice(0,u.length-1)),(u+e).length>r.length?r:r.slice(0,u.length)+e},words:function(r,n){return h.isBlank(r)?[]:h.trim(r,n).split(n||/\s+/)},pad:function(r,t,e,a){r=null==r?"":n(r),t=~~t;var u=0;switch(e?e.length>1&&(e=e.charAt(0)):e=" ",a){case"right":return u=t-r.length,r+i(e,u);case"both":return u=t-r.length,i(e,Math.ceil(u/2))+r+i(e,Math.floor(u/2));default:return u=t-r.length,i(e,u)+r}},lpad:function(r,n,t){return h.pad(r,n,t)},rpad:function(r,n,t){return h.pad(r,n,t,"right")},lrpad:function(r,n,t){return h.pad(r,n,t,"both")},sprintf:p,vsprintf:function(r,n){return n.unshift(r),p.apply(null,n)},toNumber:function(r,n){return r?(r=h.trim(r),r.match(/^-?\d+(?:\.\d+)?$/)?o(o(r).toFixed(~~n)):0/0):0},numberFormat:function(r,n,t,e){if(isNaN(r)||null==r)return"";r=r.toFixed(~~n),e="string"==typeof e?e:",";var a=r.split("."),u=a[0],o=a[1]?(t||".")+a[1]:"";return u.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+e)+o},strRight:function(r,t){if(null==r)return"";r=n(r),t=null!=t?n(t):t;var e=t?r.indexOf(t):-1;return~e?r.slice(e+t.length,r.length):r},strRightBack:function(r,t){if(null==r)return"";r=n(r),t=null!=t?n(t):t;var e=t?r.lastIndexOf(t):-1;return~e?r.slice(e+t.length,r.length):r},strLeft:function(r,t){if(null==r)return"";r=n(r),t=null!=t?n(t):t;var e=t?r.indexOf(t):-1;return~e?r.slice(0,e):r},strLeftBack:function(r,n){if(null==r)return"";r+="",n=null!=n?""+n:n;var t=r.lastIndexOf(n);return~t?r.slice(0,t):r},toSentence:function(r,n,t,e){n=n||", ",t=t||" and ";var a=r.slice(),u=a.pop();return r.length>2&&e&&(t=h.rtrim(n)+t),a.length?a.join(n)+t+u:u},toSentenceSerial:function(){var r=l.call(arguments);return r[3]=!0,h.toSentence.apply(h,r)},slugify:function(r){if(null==r)return"";var t="ąàáäâãåæăćęèéëêìíïîłńòóöôõøśșțùúüûñçżź",e="aaaaaaaaaceeeeeiiiilnoooooosstuuuunczz",a=new RegExp(f(t),"g");return r=n(r).toLowerCase().replace(a,function(r){var n=t.indexOf(r);return e.charAt(n)||"-"}),h.dasherize(r.replace(/[^\w\s-]/g,""))},surround:function(r,n){return[n,r,n].join("")},quote:function(r,n){return h.surround(r,n||'"')},unquote:function(r,n){return n=n||'"',r[0]===n&&r[r.length-1]===n?r.slice(1,r.length-1):r},exports:function(){var r={};for(var n in this)this.hasOwnProperty(n)&&!n.match(/^(?:include|contains|reverse)$/)&&(r[n]=this[n]);return r},repeat:function(r,t,e){if(null==r)return"";if(t=~~t,null==e)return i(n(r),t);for(var a=[];t>0;a[--t]=r);return a.join(e)},naturalCmp:function(r,t){if(r==t)return 0;if(!r)return-1;if(!t)return 1;for(var e=/(\.\d+)|(\d+)|(\D+)/g,a=n(r).toLowerCase().match(e),u=n(t).toLowerCase().match(e),o=Math.min(a.length,u.length),i=0;o>i;i++){var l=a[i],f=u[i];if(l!==f){var c=parseInt(l,10);if(!isNaN(c)){var s=parseInt(f,10);if(!isNaN(s)&&c-s)return c-s}return f>l?-1:1}}return a.length===u.length?a.length-u.length:t>r?-1:1},levenshtein:function(r,t){if(null==r&&null==t)return 0;if(null==r)return n(t).length;if(null==t)return n(r).length;r=n(r),t=n(t);for(var e,a,u=[],o=0;o<=t.length;o++)for(var i=0;i<=r.length;i++)a=o&&i?r.charAt(i-1)===t.charAt(o-1)?e:Math.min(u[i],u[i-1],e)+1:o+i,e=u[i],u[i]=a;return u.pop()},toBoolean:function(r,n,e){return"number"==typeof r&&(r=""+r),"string"!=typeof r?!!r:(r=h.trim(r),t(r,n||["true","1"])?!0:t(r,e||["false","0"])?!1:void 0)}};h.strip=h.trim,h.lstrip=h.ltrim,h.rstrip=h.rtrim,h.center=h.lrpad,h.rjust=h.lpad,h.ljust=h.rpad,h.contains=h.include,h.q=h.quote,h.toBool=h.toBoolean,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(module.exports=h),exports._s=h),"function"==typeof define&&define.amd&&define("underscore.string",[],function(){return h}),r._=r._||{},r._.string=r._.str=h}(this,String),function(){function r(r){this._value=r}function n(r,n,t,e){var a,u,o=Math.pow(10,n);return u=(t(r*o)/o).toFixed(n),e&&(a=new RegExp("0{1,"+e+"}$"),u=u.replace(a,"")),u}function t(r,n,t){var e;return e=n.indexOf("$")>-1?a(r,n,t):n.indexOf("%")>-1?u(r,n,t):n.indexOf(":")>-1?o(r,n):l(r._value,n,t)}function e(r,n){var t,e,a,u,o,l=n,f=["KB","MB","GB","TB","PB","EB","ZB","YB"],c=!1;if(n.indexOf(":")>-1)r._value=i(n);else if(n===d)r._value=0;else{for("."!==h[g].delimiters.decimal&&(n=n.replace(/\./g,"").replace(h[g].delimiters.decimal,".")),t=new RegExp("[^a-zA-Z]"+h[g].abbreviations.thousand+"(?:\\)|(\\"+h[g].currency.symbol+")?(?:\\))?)?$"),e=new RegExp("[^a-zA-Z]"+h[g].abbreviations.million+"(?:\\)|(\\"+h[g].currency.symbol+")?(?:\\))?)?$"),a=new RegExp("[^a-zA-Z]"+h[g].abbreviations.billion+"(?:\\)|(\\"+h[g].currency.symbol+")?(?:\\))?)?$"),u=new RegExp("[^a-zA-Z]"+h[g].abbreviations.trillion+"(?:\\)|(\\"+h[g].currency.symbol+")?(?:\\))?)?$"),o=0;o<=f.length&&!(c=n.indexOf(f[o])>-1?Math.pow(1024,o+1):!1);o++);r._value=(c?c:1)*(l.match(t)?Math.pow(10,3):1)*(l.match(e)?Math.pow(10,6):1)*(l.match(a)?Math.pow(10,9):1)*(l.match(u)?Math.pow(10,12):1)*(n.indexOf("%")>-1?.01:1)*((n.split("-").length+Math.min(n.split("(").length-1,n.split(")").length-1))%2?1:-1)*Number(n.replace(/[^0-9\.]+/g,"")),r._value=c?Math.ceil(r._value):r._value}return r._value}function a(r,n,t){var e,a,u=n.indexOf("$"),o=n.indexOf("("),i=n.indexOf("-"),f="";return n.indexOf(" $")>-1?(f=" ",n=n.replace(" $","")):n.indexOf("$ ")>-1?(f=" ",n=n.replace("$ ","")):n=n.replace("$",""),a=l(r._value,n,t),1>=u?a.indexOf("(")>-1||a.indexOf("-")>-1?(a=a.split(""),e=1,(o>u||i>u)&&(e=0),a.splice(e,0,h[g].currency.symbol+f),a=a.join("")):a=h[g].currency.symbol+f+a:a.indexOf(")")>-1?(a=a.split(""),a.splice(-1,0,f+h[g].currency.symbol),a=a.join("")):a=a+f+h[g].currency.symbol,a}function u(r,n,t){var e,a="",u=100*r._value;return n.indexOf(" %")>-1?(a=" ",n=n.replace(" %","")):n=n.replace("%",""),e=l(u,n,t),e.indexOf(")")>-1?(e=e.split(""),e.splice(-1,0,a+"%"),e=e.join("")):e=e+a+"%",e}function o(r){var n=Math.floor(r._value/60/60),t=Math.floor((r._value-60*n*60)/60),e=Math.round(r._value-60*n*60-60*t);return n+":"+(10>t?"0"+t:t)+":"+(10>e?"0"+e:e)}function i(r){var n=r.split(":"),t=0;return 3===n.length?(t+=60*Number(n[0])*60,t+=60*Number(n[1]),t+=Number(n[2])):2===n.length&&(t+=60*Number(n[0]),t+=Number(n[1])),Number(t)}function l(r,t,e){var a,u,o,i,l,f,c=!1,s=!1,m=!1,p="",v=!1,M=!1,F=!1,N=!1,E=!1,y="",I="",A=Math.abs(r),b=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],T="",S=!1;if(0===r&&null!==d)return d;if(t.indexOf("(")>-1?(c=!0,t=t.slice(1,-1)):t.indexOf("+")>-1&&(s=!0,t=t.replace(/\+/g,"")),t.indexOf("a")>-1&&(v=t.indexOf("aK")>=0,M=t.indexOf("aM")>=0,F=t.indexOf("aB")>=0,N=t.indexOf("aT")>=0,E=v||M||F||N,t.indexOf(" a")>-1?(p=" ",t=t.replace(" a","")):t=t.replace("a",""),A>=Math.pow(10,12)&&!E||N?(p+=h[g].abbreviations.trillion,r/=Math.pow(10,12)):A<Math.pow(10,12)&&A>=Math.pow(10,9)&&!E||F?(p+=h[g].abbreviations.billion,r/=Math.pow(10,9)):A<Math.pow(10,9)&&A>=Math.pow(10,6)&&!E||M?(p+=h[g].abbreviations.million,r/=Math.pow(10,6)):(A<Math.pow(10,6)&&A>=Math.pow(10,3)&&!E||v)&&(p+=h[g].abbreviations.thousand,r/=Math.pow(10,3))),t.indexOf("b")>-1)for(t.indexOf(" b")>-1?(y=" ",t=t.replace(" b","")):t=t.replace("b",""),o=0;o<=b.length;o++)if(a=Math.pow(1024,o),u=Math.pow(1024,o+1),r>=a&&u>r){y+=b[o],a>0&&(r/=a);break}return t.indexOf("o")>-1&&(t.indexOf(" o")>-1?(I=" ",t=t.replace(" o","")):t=t.replace("o",""),I+=h[g].ordinal(r)),t.indexOf("[.]")>-1&&(m=!0,t=t.replace("[.]",".")),i=r.toString().split(".")[0],l=t.split(".")[1],f=t.indexOf(","),l?(l.indexOf("[")>-1?(l=l.replace("]",""),l=l.split("["),T=n(r,l[0].length+l[1].length,e,l[1].length)):T=n(r,l.length,e),i=T.split(".")[0],T=T.split(".")[1].length?h[g].delimiters.decimal+T.split(".")[1]:"",m&&0===Number(T.slice(1))&&(T="")):i=n(r,null,e),i.indexOf("-")>-1&&(i=i.slice(1),S=!0),f>-1&&(i=i.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+h[g].delimiters.thousands)),0===t.indexOf(".")&&(i=""),(c&&S?"(":"")+(!c&&S?"-":"")+(!S&&s?"+":"")+i+T+(I?I:"")+(p?p:"")+(y?y:"")+(c&&S?")":"")}function f(r,n){h[r]=n}function c(r){var n=r.toString().split(".");return n.length<2?1:Math.pow(10,n[1].length)}function s(){var r=Array.prototype.slice.call(arguments);return r.reduce(function(r,n){var t=c(r),e=c(n);return t>e?t:e},-1/0)}var m,p="1.5.3",h={},g="en",d=null,v="0,0",M="undefined"!=typeof module&&module.exports;m=function(n){return m.isNumeral(n)?n=n.value():0===n||"undefined"==typeof n?n=0:Number(n)||(n=m.fn.unformat(n)),new r(Number(n))},m.version=p,m.isNumeral=function(n){return n instanceof r},m.language=function(r,n){if(!r)return g;if(r&&!n){if(!h[r])throw new Error("Unknown language : "+r);g=r}return(n||!h[r])&&f(r,n),m},m.languageData=function(r){if(!r)return h[g];if(!h[r])throw new Error("Unknown language : "+r);return h[r]},m.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(r){var n=r%10;return 1===~~(r%100/10)?"th":1===n?"st":2===n?"nd":3===n?"rd":"th"},currency:{symbol:"$"}}),m.zeroFormat=function(r){d="string"==typeof r?r:null},m.defaultFormat=function(r){v="string"==typeof r?r:"0.0"},m.validate=function(r,n){var t,e,a,u,o,i,l,f;if("string"!=typeof r&&(r+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",r)),r=r.trim(),""===r)return!1;r=r.replace(/^[+-]?/,"");try{l=m.languageData(n)}catch(c){l=m.languageData(m.language())}return a=l.currency.symbol,o=l.abbreviations,t=l.delimiters.decimal,e="."===l.delimiters.thousands?"\\.":l.delimiters.thousands,f=r.match(/^[^\d]+/),null!==f&&(r=r.substr(1),f[0]!==a)?!1:(f=r.match(/[^\d]+$/),null!==f&&(r=r.slice(0,-1),f[0]!==o.thousand&&f[0]!==o.million&&f[0]!==o.billion&&f[0]!==o.trillion)?!1:r.match(/^\d+$/)?!0:(i=new RegExp(e+"{2}"),r.match(/[^\d.,]/g)?!1:(u=r.split(t),u.length>2?!1:u.length<2?!!u[0].match(/^\d+.*\d$/)&&!u[0].match(i):1===u[0].length?!!u[0].match(/^\d+$/)&&!u[0].match(i)&&!!u[1].match(/^\d+$/):!!u[0].match(/^\d+.*\d$/)&&!u[0].match(i)&&!!u[1].match(/^\d+$/))))},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(r,n){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof r)throw new TypeError(r+" is not a function");var t,e,a=this.length>>>0,u=!1;for(1<arguments.length&&(e=n,u=!0),t=0;a>t;++t)this.hasOwnProperty(t)&&(u?e=r(e,this[t],t,this):(e=this[t],u=!0));if(!u)throw new TypeError("Reduce of empty array with no initial value");return e}),m.fn=r.prototype={clone:function(){return m(this)},format:function(r,n){return t(this,r?r:v,void 0!==n?n:Math.round)},unformat:function(r){return"[object Number]"===Object.prototype.toString.call(r)?r:e(this,r?r:v)},value:function(){return this._value},valueOf:function(){return this._value},set:function(r){return this._value=Number(r),this},add:function(r){function n(r,n){return r+t*n}var t=s.call(null,this._value,r);return this._value=[this._value,r].reduce(n,0)/t,this},subtract:function(r){function n(r,n){return r-t*n}var t=s.call(null,this._value,r);return this._value=[r].reduce(n,this._value*t)/t,this},multiply:function(r){function n(r,n){var t=s(r,n);return r*t*n*t/(t*t)}return this._value=[this._value,r].reduce(n,1),this},divide:function(r){function n(r,n){var t=s(r,n);return r*t/(n*t)}return this._value=[this._value,r].reduce(n),this},difference:function(r){return Math.abs(m(this._value).subtract(r).value())}},M&&(module.exports=m),"undefined"==typeof ender&&(this.numeral=m),"function"==typeof define&&define.amd&&define([],function(){return m})}.call(window),function(r){"use strict";function n(r,n){var t=(65535&r)+(65535&n),e=(r>>16)+(n>>16)+(t>>16);return e<<16|65535&t}function t(r,n){return r<<n|r>>>32-n}function e(r,e,a,u,o,i){return n(t(n(n(e,r),n(u,i)),o),a)}function a(r,n,t,a,u,o,i){return e(n&t|~n&a,r,n,u,o,i)}function u(r,n,t,a,u,o,i){return e(n&a|t&~a,r,n,u,o,i)}function o(r,n,t,a,u,o,i){return e(n^t^a,r,n,u,o,i)}function i(r,n,t,a,u,o,i){return e(t^(n|~a),r,n,u,o,i)}function l(r,t){r[t>>5]|=128<<t%32,r[(t+64>>>9<<4)+14]=t;var e,l,f,c,s,m=1732584193,p=-271733879,h=-1732584194,g=271733878;for(e=0;e<r.length;e+=16)l=m,f=p,c=h,s=g,m=a(m,p,h,g,r[e],7,-680876936),g=a(g,m,p,h,r[e+1],12,-389564586),h=a(h,g,m,p,r[e+2],17,606105819),p=a(p,h,g,m,r[e+3],22,-1044525330),m=a(m,p,h,g,r[e+4],7,-176418897),g=a(g,m,p,h,r[e+5],12,1200080426),h=a(h,g,m,p,r[e+6],17,-1473231341),p=a(p,h,g,m,r[e+7],22,-45705983),m=a(m,p,h,g,r[e+8],7,1770035416),g=a(g,m,p,h,r[e+9],12,-1958414417),h=a(h,g,m,p,r[e+10],17,-42063),p=a(p,h,g,m,r[e+11],22,-1990404162),m=a(m,p,h,g,r[e+12],7,1804603682),g=a(g,m,p,h,r[e+13],12,-40341101),h=a(h,g,m,p,r[e+14],17,-1502002290),p=a(p,h,g,m,r[e+15],22,1236535329),m=u(m,p,h,g,r[e+1],5,-165796510),g=u(g,m,p,h,r[e+6],9,-1069501632),h=u(h,g,m,p,r[e+11],14,643717713),p=u(p,h,g,m,r[e],20,-373897302),m=u(m,p,h,g,r[e+5],5,-701558691),g=u(g,m,p,h,r[e+10],9,38016083),h=u(h,g,m,p,r[e+15],14,-660478335),p=u(p,h,g,m,r[e+4],20,-405537848),m=u(m,p,h,g,r[e+9],5,568446438),g=u(g,m,p,h,r[e+14],9,-1019803690),h=u(h,g,m,p,r[e+3],14,-187363961),p=u(p,h,g,m,r[e+8],20,1163531501),m=u(m,p,h,g,r[e+13],5,-1444681467),g=u(g,m,p,h,r[e+2],9,-51403784),h=u(h,g,m,p,r[e+7],14,1735328473),p=u(p,h,g,m,r[e+12],20,-1926607734),m=o(m,p,h,g,r[e+5],4,-378558),g=o(g,m,p,h,r[e+8],11,-2022574463),h=o(h,g,m,p,r[e+11],16,1839030562),p=o(p,h,g,m,r[e+14],23,-35309556),m=o(m,p,h,g,r[e+1],4,-1530992060),g=o(g,m,p,h,r[e+4],11,1272893353),h=o(h,g,m,p,r[e+7],16,-155497632),p=o(p,h,g,m,r[e+10],23,-1094730640),m=o(m,p,h,g,r[e+13],4,681279174),g=o(g,m,p,h,r[e],11,-358537222),h=o(h,g,m,p,r[e+3],16,-722521979),p=o(p,h,g,m,r[e+6],23,76029189),m=o(m,p,h,g,r[e+9],4,-640364487),g=o(g,m,p,h,r[e+12],11,-421815835),h=o(h,g,m,p,r[e+15],16,530742520),p=o(p,h,g,m,r[e+2],23,-995338651),m=i(m,p,h,g,r[e],6,-198630844),g=i(g,m,p,h,r[e+7],10,1126891415),h=i(h,g,m,p,r[e+14],15,-1416354905),p=i(p,h,g,m,r[e+5],21,-57434055),m=i(m,p,h,g,r[e+12],6,1700485571),g=i(g,m,p,h,r[e+3],10,-1894986606),h=i(h,g,m,p,r[e+10],15,-1051523),p=i(p,h,g,m,r[e+1],21,-2054922799),m=i(m,p,h,g,r[e+8],6,1873313359),g=i(g,m,p,h,r[e+15],10,-30611744),h=i(h,g,m,p,r[e+6],15,-1560198380),p=i(p,h,g,m,r[e+13],21,1309151649),m=i(m,p,h,g,r[e+4],6,-145523070),g=i(g,m,p,h,r[e+11],10,-1120210379),h=i(h,g,m,p,r[e+2],15,718787259),p=i(p,h,g,m,r[e+9],21,-343485551),m=n(m,l),p=n(p,f),h=n(h,c),g=n(g,s);return[m,p,h,g]}function f(r){var n,t="";for(n=0;n<32*r.length;n+=8)t+=String.fromCharCode(r[n>>5]>>>n%32&255);return t}function c(r){var n,t=[];for(t[(r.length>>2)-1]=void 0,n=0;n<t.length;n+=1)t[n]=0;for(n=0;n<8*r.length;n+=8)t[n>>5]|=(255&r.charCodeAt(n/8))<<n%32;return t}function s(r){return f(l(c(r),8*r.length))}function m(r,n){var t,e,a=c(r),u=[],o=[];for(u[15]=o[15]=void 0,a.length>16&&(a=l(a,8*r.length)),t=0;16>t;t+=1)u[t]=909522486^a[t],o[t]=1549556828^a[t];return e=l(u.concat(c(n)),512+8*n.length),f(l(o.concat(e),640))}function p(r){var n,t,e="0123456789abcdef",a="";for(t=0;t<r.length;t+=1)n=r.charCodeAt(t),a+=e.charAt(n>>>4&15)+e.charAt(15&n);return a}function h(r){return unescape(encodeURIComponent(r))}function g(r){return s(h(r))}function d(r){return p(g(r))}function v(r,n){return m(h(r),h(n))}function M(r,n){return p(v(r,n))}function F(r,n,t){return n?t?v(n,r):M(n,r):t?g(r):d(r)}"function"==typeof define&&define.amd?define(function(){return F}):r.md5=F}(this),this.j$=this.jStat=function(r){function n(n,t){var e=n>t?n:t;return r.pow(10,17-~~(r.log(e>0?e:-e)*r.LOG10E))}function t(r){return"[object Function]"===s.call(r)}function e(r){return"number"==typeof r&&r===r}function a(r){return f.apply([],r)}function u(){return new u._init(arguments)}function o(){return 0}function i(){return 1}function l(r,n){return r===n?1:0}var f=Array.prototype.concat,c=Array.prototype.slice,s=Object.prototype.toString,m=Array.isArray||function(r){return"[object Array]"===s.call(r)};u.fn=u.prototype,u._init=function(r){var n;if(m(r[0]))if(m(r[0][0])){for(t(r[1])&&(r[0]=u.map(r[0],r[1])),n=0;n<r[0].length;n++)this[n]=r[0][n];this.length=r[0].length}else this[0]=t(r[1])?u.map(r[0],r[1]):r[0],this.length=1;else if(e(r[0]))this[0]=u.seq.apply(null,r),this.length=1;else{if(r[0]instanceof u)return u(r[0].toArray());this[0]=[],this.length=1}return this},u._init.prototype=u.prototype,u._init.constructor=u,u.utils={calcRdx:n,isArray:m,isFunction:t,isNumber:e,toVector:a},u.extend=function(r){var n,t;if(1===arguments.length){for(t in r)u[t]=r[t];return this}for(n=1;n<arguments.length;n++)for(t in arguments[n])r[t]=arguments[n][t];return r},u.rows=function(r){return r.length||1},u.cols=function(r){return r[0].length||1},u.dimensions=function(r){return{rows:u.rows(r),cols:u.cols(r)}},u.row=function(r,n){return r[n]},u.col=function(r,n){for(var t=new Array(r.length),e=0;e<r.length;e++)t[e]=[r[e][n]];return t},u.diag=function(r){for(var n=u.rows(r),t=new Array(n),e=0;n>e;e++)t[e]=[r[e][e]];return t},u.antidiag=function(r){for(var n=u.rows(r)-1,t=new Array(n),e=0;n>=0;n--,e++)t[e]=[r[e][n]];return t},u.transpose=function(r){var n,t,e,a,u,o=[];for(m(r[0])||(r=[r]),t=r.length,e=r[0].length,u=0;e>u;u++){for(n=new Array(t),a=0;t>a;a++)n[a]=r[a][u];o.push(n)}return 1===o.length?o[0]:o},u.map=function(r,n,t){var e,a,u,o,i;for(m(r[0])||(r=[r]),a=r.length,u=r[0].length,o=t?r:new Array(a),e=0;a>e;e++)for(o[e]||(o[e]=new Array(u)),i=0;u>i;i++)o[e][i]=n(r[e][i],e,i);return 1===o.length?o[0]:o},u.alter=function(r,n){return u.map(r,n,!0)},u.create=function(r,n,e){var a,u,o=new Array(r);for(t(n)&&(e=n,n=r),a=0;r>a;a++)for(o[a]=new Array(n),u=0;n>u;u++)o[a][u]=e(a,u);return o},u.zeros=function(r,n){return e(n)||(n=r),u.create(r,n,o)},u.ones=function(r,n){return e(n)||(n=r),u.create(r,n,i)},u.rand=function(n,t){return e(t)||(t=n),u.create(n,t,r.random)},u.identity=function(r,n){return e(n)||(n=r),u.create(r,n,l)
},u.symmetric=function(r){var n,t,e=r.length;if(r.length!==r[0].length)return!1;for(n=0;e>n;n++)for(t=0;e>t;t++)if(r[t][n]!==r[n][t])return!1;return!0},u.clear=function(r){return u.alter(r,o)},u.seq=function(r,e,a,u){t(u)||(u=!1);var o,i=[],l=n(r,e),f=(e*l-r*l)/((a-1)*l),c=r;for(o=0;e>=c;o++,c=(r*l+f*l*o)/l)i.push(u?u(c,o):c);return i};var p=u.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?c.call(this):c.call(this)[0]},p.map=function(r,n){return u(u.map(this,r,n))},p.alter=function(r){return u.alter(this,r),this},function(r){for(var n=0;n<r.length;n++)(function(r){p[r]=function(n){var t,e=this;return n?(setTimeout(function(){n.call(e,p[r].call(e))}),this):(t=u[r](this),m(t)?u(t):t)}})(r[n])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(r){for(var n=0;n<r.length;n++)(function(r){p[r]=function(n,t){var e=this;return t?(setTimeout(function(){t.call(e,p[r].call(e,n))}),this):u(u[r](this,n))}})(r[n])}("row col".split(" ")),function(r){for(var n=0;n<r.length;n++)(function(r){p[r]=new Function("return jStat(jStat."+r+".apply(null, arguments));")})(r[n])}("create zeros ones rand identity".split(" ")),u}(Math),function(r,n){function t(r,n){return r-n}function e(r,t,e){return n.max(t,n.min(r,e))}var a=r.utils.isFunction;r.sum=function o(r){for(var o=0,n=r.length;--n>=0;)o+=r[n];return o},r.sumsqrd=function(r){for(var n=0,t=r.length;--t>=0;)n+=r[t]*r[t];return n},r.sumsqerr=function(n){for(var t,e=r.mean(n),a=0,u=n.length;--u>=0;)t=n[u]-e,a+=t*t;return a},r.product=function(r){for(var n=1,t=r.length;--t>=0;)n*=r[t];return n},r.min=function(r){for(var n=r[0],t=0;++t<r.length;)r[t]<n&&(n=r[t]);return n},r.max=function(r){for(var n=r[0],t=0;++t<r.length;)r[t]>n&&(n=r[t]);return n},r.mean=function(n){return r.sum(n)/n.length},r.meansqerr=function(n){return r.sumsqerr(n)/n.length},r.geomean=function(t){return n.pow(r.product(t),1/t.length)},r.median=function(r){var n=r.length,e=r.slice().sort(t);return 1&n?e[n/2|0]:(e[n/2-1]+e[n/2])/2},r.cumsum=function(r){var n,t=r.length,e=new Array(t);for(e[0]=r[0],n=1;t>n;n++)e[n]=e[n-1]+r[n];return e},r.diff=function(r){var n,t=[],e=r.length;for(n=1;e>n;n++)t.push(r[n]-r[n-1]);return t},r.mode=function(r){var n,e=r.length,a=r.slice().sort(t),u=1,o=0,i=0,l=[];for(n=0;e>n;n++)a[n]===a[n+1]?u++:(u>o?(l=[a[n]],o=u,i=0):u===o&&(l.push(a[n]),i++),u=1);return 0===i?l[0]:l},r.range=function(n){return r.max(n)-r.min(n)},r.variance=function(n,t){return r.sumsqerr(n)/(n.length-(t?1:0))},r.stdev=function(t,e){return n.sqrt(r.variance(t,e))},r.meandev=function(t){var e,a=0,u=r.mean(t);for(e=t.length-1;e>=0;e--)a+=n.abs(t[e]-u);return a/t.length},r.meddev=function(t){var e,a=0,u=r.median(t);for(e=t.length-1;e>=0;e--)a+=n.abs(t[e]-u);return a/t.length},r.coeffvar=function(n){return r.stdev(n)/r.mean(n)},r.quartiles=function(r){var e=r.length,a=r.slice().sort(t);return[a[n.round(e/4)-1],a[n.round(e/2)-1],a[n.round(3*e/4)-1]]},r.quantiles=function(r,a,u,o){var i,l,f,c,s,m,p=r.slice().sort(t),h=[a.length],g=r.length;for("undefined"==typeof u&&(u=3/8),"undefined"==typeof o&&(o=3/8),i=0;i<a.length;i++)l=a[i],f=u+l*(1-u-o),c=g*l+f,s=n.floor(e(c,1,g-1)),m=e(c-s,0,1),h[i]=(1-m)*p[s-1]+m*p[s];return h},r.percentileOfScore=function(r,n,t){var e,a,u=0,o=r.length,i=!1;for("strict"===t&&(i=!0),a=0;o>a;a++)e=r[a],(i&&n>e||!i&&n>=e)&&u++;return u/o},r.covariance=function(n,t){var e,a=r.mean(n),u=r.mean(t),o=n.length,i=new Array(o);for(e=0;o>e;e++)i[e]=(n[e]-a)*(t[e]-u);return r.sum(i)/(o-1)},r.corrcoeff=function(n,t){return r.covariance(n,t)/r.stdev(n,1)/r.stdev(t,1)};var u=r.prototype;u.cumsum=function(n,t){var e=[],o=0,i=this;if(a(n)&&(t=n,n=!1),t)return setTimeout(function(){t.call(i,u.cumsum.call(i,n))}),this;if(this.length>1){for(i=n===!0?this:this.transpose();o<i.length;o++)e[o]=r.cumsum(i[o]);return e}return r.cumsum(this[0],n)},function(n){for(var t=0;t<n.length;t++)(function(n){u[n]=function(t,e){var o=[],i=0,l=this;if(a(t)&&(e=t,t=!1),e)return setTimeout(function(){e.call(l,u[n].call(l,t))}),this;if(this.length>1){for(l=t===!0?this:this.transpose();i<l.length;i++)o[i]=r[n](l[i]);return t===!0?r[n](r.utils.toVector(o)):o}return r[n](this[0],t)}})(n[t])}("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles".split(" ")),function(n){for(var t=0;t<n.length;t++)(function(n){u[n]=function(){var t=[],e=0,o=this,i=Array.prototype.slice.call(arguments);if(a(i[i.length-1])){var l=i[i.length-1],f=i.slice(0,i.length-1);return setTimeout(function(){l.call(o,u[n].apply(o,f))}),this}var l=void 0,c=function(t){return r[n].apply(o,[t].concat(i))};if(this.length>1){for(o=o.transpose();e<o.length;e++)t[e]=c(o[e]);return t}return c(this[0])}})(n[t])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(r,n){r.gammaln=function(r){var t,e,a,u=0,o=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],i=1.000000000190015;for(a=(e=t=r)+5.5,a-=(t+.5)*n.log(a);6>u;u++)i+=o[u]/++e;return n.log(2.5066282746310007*i/t)-a},r.gammafn=function(r){var t,e,a,u,o=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],i=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],l=!1,f=0,c=0,s=0,m=r;if(0>=m){if(u=m%1+3.6e-16,!u)return 1/0;l=(1&m?-1:1)*n.PI/n.sin(n.PI*u),m=1-m}for(a=m,e=1>m?m++:(m-=f=(0|m)-1)-1,t=0;8>t;++t)s=(s+o[t])*e,c=c*e+i[t];if(u=s/c+1,m>a)u/=a;else if(a>m)for(t=0;f>t;++t)u*=m,m++;return l&&(u=l/u),u},r.gammap=function(t,e){var a,u=r.gammaln(t),o=t,i=1/t,l=i,f=e+1-t,c=1/1e-30,s=1/f,m=s,p=1,h=-~(8.5*n.log(t>=1?t:1/t)+.4*t+17);if(0>e||0>=t)return 0/0;if(t+1>e){for(;h>=p;p++)i+=l*=e/++o;return i*n.exp(-e+t*n.log(e)-u)}for(;h>=p;p++)a=-p*(p-t),f+=2,s=a*s+f,c=f+a/c,s=1/s,m*=s*c;return 1-m*n.exp(-e+t*n.log(e)-u)},r.factorialln=function(n){return 0>n?0/0:r.gammaln(n+1)},r.factorial=function(n){return 0>n?0/0:r.gammafn(n+1)},r.combination=function(t,e){return t>170||e>170?n.exp(r.combinationln(t,e)):r.factorial(t)/r.factorial(e)/r.factorial(t-e)},r.combinationln=function(n,t){return r.factorialln(n)-r.factorialln(t)-r.factorialln(n-t)},r.permutation=function(n,t){return r.factorial(n)/r.factorial(n-t)},r.betafn=function(t,e){return 0>=t||0>=e?void 0:t+e>170?n.exp(r.betaln(t,e)):r.gammafn(t)*r.gammafn(e)/r.gammafn(t+e)},r.betaln=function(n,t){return r.gammaln(n)+r.gammaln(t)-r.gammaln(n+t)},r.betacf=function(r,t,e){var a,u,o,i,l=1e-30,f=1,c=t+e,s=t+1,m=t-1,p=1,h=1-c*r/s;for(n.abs(h)<l&&(h=l),h=1/h,i=h;100>=f&&(a=2*f,u=f*(e-f)*r/((m+a)*(t+a)),h=1+u*h,n.abs(h)<l&&(h=l),p=1+u/p,n.abs(p)<l&&(p=l),h=1/h,i*=h*p,u=-(t+f)*(c+f)*r/((t+a)*(s+a)),h=1+u*h,n.abs(h)<l&&(h=l),p=1+u/p,n.abs(p)<l&&(p=l),h=1/h,o=h*p,i*=o,!(n.abs(o-1)<3e-7));f++);return i},r.gammapinv=function(t,e){var a,u,o,i,l,f,c,s=0,m=e-1,p=1e-8,h=r.gammaln(e);if(t>=1)return n.max(100,e+100*n.sqrt(e));if(0>=t)return 0;for(e>1?(f=n.log(m),c=n.exp(m*(f-1)-h),l=.5>t?t:1-t,o=n.sqrt(-2*n.log(l)),a=(2.30753+.27061*o)/(1+o*(.99229+.04481*o))-o,.5>t&&(a=-a),a=n.max(.001,e*n.pow(1-1/(9*e)-a/(3*n.sqrt(e)),3))):(o=1-e*(.253+.12*e),a=o>t?n.pow(t/o,1/e):1-n.log(1-(t-o)/(1-o)));12>s;s++){if(0>=a)return 0;if(u=r.gammap(e,a)-t,o=e>1?c*n.exp(-(a-m)+m*(n.log(a)-f)):n.exp(-a+m*n.log(a)-h),i=u/o,a-=o=i/(1-.5*n.min(1,i*((e-1)/a-1))),0>=a&&(a=.5*(a+o)),n.abs(o)<p*a)break}return a},r.erf=function(r){var t,e,a,u,o=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],i=o.length-1,l=!1,f=0,c=0;for(0>r&&(r=-r,l=!0),t=2/(2+r),e=4*t-2;i>0;i--)a=f,f=e*f-c+o[i],c=a;return u=t*n.exp(-r*r+.5*(o[0]+e*f)-c),l?u-1:1-u},r.erfc=function(n){return 1-r.erf(n)},r.erfcinv=function(t){var e,a,u,o,i=0;if(t>=2)return-100;if(0>=t)return 100;for(o=1>t?t:2-t,u=n.sqrt(-2*n.log(o/2)),e=-.70711*((2.30753+.27061*u)/(1+u*(.99229+.04481*u))-u);2>i;i++)a=r.erfc(e)-o,e+=a/(1.1283791670955126*n.exp(-e*e)-e*a);return 1>t?e:-e},r.ibetainv=function(t,e,a){var u,o,i,l,f,c,s,m,p,h,g,d=1e-8,v=e-1,M=a-1,F=0;if(0>=t)return 0;if(t>=1)return 1;for(e>=1&&a>=1?(i=.5>t?t:1-t,l=n.sqrt(-2*n.log(i)),s=(2.30753+.27061*l)/(1+l*(.99229+.04481*l))-l,.5>t&&(s=-s),m=(s*s-3)/6,p=2/(1/(2*e-1)+1/(2*a-1)),h=s*n.sqrt(m+p)/p-(1/(2*a-1)-1/(2*e-1))*(m+5/6-2/(3*p)),s=e/(e+a*n.exp(2*h))):(u=n.log(e/(e+a)),o=n.log(a/(e+a)),l=n.exp(e*u)/e,f=n.exp(a*o)/a,h=l+f,s=l/h>t?n.pow(e*h*t,1/e):1-n.pow(a*h*(1-t),1/a)),g=-r.gammaln(e)-r.gammaln(a)+r.gammaln(e+a);10>F;F++){if(0===s||1===s)return s;if(c=r.ibeta(s,e,a)-t,l=n.exp(v*n.log(s)+M*n.log(1-s)+g),f=c/l,s-=l=f/(1-.5*n.min(1,f*(v/s-M/(1-s)))),0>=s&&(s=.5*(s+l)),s>=1&&(s=.5*(s+l+1)),n.abs(l)<d*s&&F>0)break}return s},r.ibeta=function(t,e,a){var u=0===t||1===t?0:n.exp(r.gammaln(e+a)-r.gammaln(e)-r.gammaln(a)+e*n.log(t)+a*n.log(1-t));return 0>t||t>1?!1:(e+1)/(e+a+2)>t?u*r.betacf(t,e,a)/e:1-u*r.betacf(1-t,a,e)/a},r.randn=function(t,e){var a,u,o,i,l;if(e||(e=t),t)return r.create(t,e,function(){return r.randn()});do a=n.random(),u=1.7156*(n.random()-.5),o=a-.449871,i=n.abs(u)+.386595,l=o*o+i*(.196*i-.25472*o);while(l>.27597&&(l>.27846||u*u>-4*n.log(a)*a*a));return u/a},r.randg=function(t,e,a){var u,o,i,l,f,c,s=t;if(a||(a=e),t||(t=1),e)return c=r.zeros(e,a),c.alter(function(){return r.randg(t)}),c;1>t&&(t+=1),u=t-1/3,o=1/n.sqrt(9*u);do{do f=r.randn(),l=1+o*f;while(0>=l);l=l*l*l,i=n.random()}while(i>1-.331*n.pow(f,4)&&n.log(i)>.5*f*f+u*(1-l+n.log(l)));if(t==s)return u*l;do i=n.random();while(0===i);return n.pow(i,1/s)*u*l},function(n){for(var t=0;t<n.length;t++)(function(n){r.fn[n]=function(){return r(r.map(this,function(t){return r[n](t)}))}})(n[t])}("gammaln gammafn factorial factorialln".split(" ")),function(n){for(var t=0;t<n.length;t++)(function(n){r.fn[n]=function(){return r(r[n].apply(null,arguments))}})(n[t])}("randn".split(" "))}(this.jStat,Math),function(r,n){!function(n){for(var t=0;t<n.length;t++)(function(n){r[n]=function(r,n,t){return this instanceof arguments.callee?(this._a=r,this._b=n,this._c=t,this):new arguments.callee(r,n,t)},r.fn[n]=function(t,e,a){var u=r[n](t,e,a);return u.data=this,u},r[n].prototype.sample=function(t){var e=this._a,a=this._b,u=this._c;return t?r.alter(t,function(){return r[n].sample(e,a,u)}):r[n].sample(e,a,u)},function(t){for(var e=0;e<t.length;e++)(function(t){r[n].prototype[t]=function(e){var a=this._a,u=this._b,o=this._c;return e||0===e||(e=this.data),"number"!=typeof e?r.fn.map.call(e,function(e){return r[n][t](e,a,u,o)}):r[n][t](e,a,u,o)}})(t[e])}("pdf cdf inv".split(" ")),function(t){for(var e=0;e<t.length;e++)(function(t){r[n].prototype[t]=function(){return r[n][t](this._a,this._b,this._c)}})(t[e])}("mean median mode variance".split(" "))})(n[t])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" ")),r.extend(r.beta,{pdf:function(t,e,a){return t>1||0>t?0:1==e&&1==a?1:512>e||512>a?n.pow(t,e-1)*n.pow(1-t,a-1)/r.betafn(e,a):n.exp((e-1)*n.log(t)+(a-1)*n.log(1-t)-r.betaln(e,a))},cdf:function(n,t,e){return n>1||0>n?1*(n>1):r.ibeta(n,t,e)},inv:function(n,t,e){return r.ibetainv(n,t,e)},mean:function(r,n){return r/(r+n)},median:function(){throw new Error("median not yet implemented")},mode:function(r,t){return r*t/(n.pow(r+t,2)*(r+t+1))},sample:function(n,t){var e=r.randg(n);return e/(e+r.randg(t))},variance:function(r,t){return r*t/(n.pow(r+t,2)*(r+t+1))}}),r.extend(r.centralF,{pdf:function(t,e,a){return 0>t?void 0:n.sqrt(n.pow(e*t,e)*n.pow(a,a)/n.pow(e*t+a,e+a))/(t*r.betafn(e/2,a/2))},cdf:function(n,t,e){return r.ibeta(t*n/(t*n+e),t/2,e/2)},inv:function(n,t,e){return e/(t*(1/r.ibetainv(n,t/2,e/2)-1))},mean:function(r,n){return n>2?n/(n-2):void 0},mode:function(r,n){return r>2?n*(r-2)/(r*(n+2)):void 0},sample:function(n,t){var e=2*r.randg(n/2),a=2*r.randg(t/2);return e/n/(a/t)},variance:function(r,n){return 4>=n?void 0:2*n*n*(r+n-2)/(r*(n-2)*(n-2)*(n-4))}}),r.extend(r.cauchy,{pdf:function(r,t,e){return e/(n.pow(r-t,2)+n.pow(e,2))/n.PI},cdf:function(r,t,e){return n.atan((r-t)/e)/n.PI+.5},inv:function(r,t,e){return t+e*n.tan(n.PI*(r-.5))},median:function(r){return r},mode:function(r){return r},sample:function(t,e){return r.randn()*n.sqrt(1/(2*r.randg(.5)))*e+t}}),r.extend(r.chisquare,{pdf:function(t,e){return n.exp((e/2-1)*n.log(t)-t/2-e/2*n.log(2)-r.gammaln(e/2))},cdf:function(n,t){return r.gammap(t/2,n/2)},inv:function(n,t){return 2*r.gammapinv(n,.5*t)},mean:function(r){return r},median:function(r){return r*n.pow(1-2/(9*r),3)},mode:function(r){return r-2>0?r-2:0},sample:function(n){return 2*r.randg(n/2)},variance:function(r){return 2*r}}),r.extend(r.exponential,{pdf:function(r,t){return 0>r?0:t*n.exp(-t*r)},cdf:function(r,t){return 0>r?0:1-n.exp(-t*r)},inv:function(r,t){return-n.log(1-r)/t},mean:function(r){return 1/r},median:function(r){return 1/r*n.log(2)},mode:function(){return 0},sample:function(r){return-1/r*n.log(n.random())},variance:function(r){return n.pow(r,-2)}}),r.extend(r.gamma,{pdf:function(t,e,a){return n.exp((e-1)*n.log(t)-t/a-r.gammaln(e)-e*n.log(a))},cdf:function(n,t,e){return r.gammap(t,n/e)},inv:function(n,t,e){return r.gammapinv(n,t)*e},mean:function(r,n){return r*n},mode:function(r,n){return r>1?(r-1)*n:void 0},sample:function(n,t){return r.randg(n)*t},variance:function(r,n){return r*n*n}}),r.extend(r.invgamma,{pdf:function(t,e,a){return n.exp(-(e+1)*n.log(t)-a/t-r.gammaln(e)+e*n.log(a))},cdf:function(n,t,e){return 1-r.gammap(t,e/n)},inv:function(n,t,e){return e/r.gammapinv(1-n,t)},mean:function(r,n){return r>1?n/(r-1):void 0},mode:function(r,n){return n/(r+1)},sample:function(n,t){return t/r.randg(n)},variance:function(r,n){return 2>=r?void 0:n*n/((r-1)*(r-1)*(r-2))}}),r.extend(r.kumaraswamy,{pdf:function(r,t,e){return n.exp(n.log(t)+n.log(e)+(t-1)*n.log(r)+(e-1)*n.log(1-n.pow(r,t)))},cdf:function(r,t,e){return 1-n.pow(1-n.pow(r,t),e)},mean:function(n,t){return t*r.gammafn(1+1/n)*r.gammafn(t)/r.gammafn(1+1/n+t)},median:function(r,t){return n.pow(1-n.pow(2,-1/t),1/r)},mode:function(r,t){return r>=1&&t>=1&&1!==r&&1!==t?n.pow((r-1)/(r*t-1),1/r):void 0},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(r,t,e){return n.exp(-n.log(r)-.5*n.log(2*n.PI)-n.log(e)-n.pow(n.log(r)-t,2)/(2*e*e))},cdf:function(t,e,a){return.5+.5*r.erf((n.log(t)-e)/n.sqrt(2*a*a))},inv:function(t,e,a){return n.exp(-1.4142135623730951*a*r.erfcinv(2*t)+e)},mean:function(r,t){return n.exp(r+t*t/2)},median:function(r){return n.exp(r)},mode:function(r,t){return n.exp(r-t*t)},sample:function(t,e){return n.exp(r.randn()*e+t)},variance:function(r,t){return(n.exp(t*t)-1)*n.exp(2*r+t*t)}}),r.extend(r.normal,{pdf:function(r,t,e){return n.exp(-.5*n.log(2*n.PI)-n.log(e)-n.pow(r-t,2)/(2*e*e))},cdf:function(t,e,a){return.5*(1+r.erf((t-e)/n.sqrt(2*a*a)))},inv:function(n,t,e){return-1.4142135623730951*e*r.erfcinv(2*n)+t},mean:function(r){return r},median:function(r){return r},mode:function(r){return r},sample:function(n,t){return r.randn()*t+n},variance:function(r,n){return n*n}}),r.extend(r.pareto,{pdf:function(r,t,e){return t>=r?void 0:e*n.pow(t,e)/n.pow(r,e+1)},cdf:function(r,t,e){return 1-n.pow(t/r,e)},mean:function(r,t){return 1>=t?void 0:t*n.pow(r,t)/(t-1)},median:function(r,t){return r*t*n.SQRT2},mode:function(r){return r},variance:function(r,t){return 2>=t?void 0:r*r*t/(n.pow(t-1,2)*(t-2))}}),r.extend(r.studentt,{pdf:function(t,e){return r.gammafn((e+1)/2)/(n.sqrt(e*n.PI)*r.gammafn(e/2))*n.pow(1+t*t/e,-((e+1)/2))},cdf:function(t,e){var a=e/2;return r.ibeta((t+n.sqrt(t*t+e))/(2*n.sqrt(t*t+e)),a,a)},inv:function(t,e){var a=r.ibetainv(2*n.min(t,1-t),.5*e,.5);return a=n.sqrt(e*(1-a)/a),t>0?a:-a},mean:function(r){return r>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(t){return r.randn()*n.sqrt(t/(2*r.randg(t/2)))},variance:function(r){return r>2?r/(r-2):r>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(r,t,e){return 0>r?0:e/t*n.pow(r/t,e-1)*n.exp(-n.pow(r/t,e))},cdf:function(r,t,e){return 0>r?0:1-n.exp(-n.pow(r/t,e))},inv:function(r,t,e){return t*n.pow(-n.log(1-r),1/e)},mean:function(n,t){return n*r.gammafn(1+1/t)},median:function(r,t){return r*n.pow(n.log(2),1/t)},mode:function(r,t){return 1>=t?void 0:r*n.pow((t-1)/t,1/t)},sample:function(r,t){return r*n.pow(-n.log(n.random()),1/t)},variance:function(t,e){return t*t*r.gammafn(1+2/e)-n.pow(this.mean(t,e),2)}}),r.extend(r.uniform,{pdf:function(r,n,t){return n>r||r>t?0:1/(t-n)},cdf:function(r,n,t){return n>r?0:t>r?(r-n)/(t-n):1},mean:function(r,n){return.5*(r+n)},median:function(n,t){return r.mean(n,t)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(r,t){return r/2+t/2+(t/2-r/2)*(2*n.random()-1)},variance:function(r,t){return n.pow(t-r,2)/12}}),r.extend(r.binomial,{pdf:function(t,e,a){return 0===a||1===a?e*a===t?1:0:r.combination(e,t)*n.pow(a,t)*n.pow(1-a,e-t)},cdf:function(n,t,e){var a=[],u=0;if(0>n)return 0;if(t>n){for(;n>=u;u++)a[u]=r.binomial.pdf(u,t,e);return r.sum(a)}return 1}}),r.extend(r.negbin,{pdf:function(t,e,a){return t!==t|0?!1:0>t?0:r.combination(t+e-1,e-1)*n.pow(1-a,t)*n.pow(a,e)},cdf:function(n,t,e){var a=0,u=0;if(0>n)return 0;for(;n>=u;u++)a+=r.negbin.pdf(u,t,e);return a}}),r.extend(r.hypgeom,{pdf:function(t,e,a,u){if(t!==t|0)return!1;if(0>t||a-(e-u)>t)return 0;if(t>u||t>a)return 0;if(2*a>e)return 2*u>e?r.hypgeom.pdf(e-a-u+t,e,e-a,e-u):r.hypgeom.pdf(u-t,e,e-a,u);if(2*u>e)return r.hypgeom.pdf(a-t,e,a,e-u);if(u>a)return r.hypgeom.pdf(t,e,u,a);for(var o=1,i=0,l=0;t>l;l++){for(;o>1&&u>i;)o*=1-a/(e-i),i++;o*=(u-l)*(a-l)/((l+1)*(e-a-u+l+1))}for(;u>i;i++)o*=1-a/(e-i);return n.min(1,n.max(0,o))},cdf:function(t,e,a,u){if(0>t||a-(e-u)>t)return 0;if(t>=u||t>=a)return 1;if(2*a>e)return 2*u>e?r.hypgeom.cdf(e-a-u+t,e,e-a,e-u):1-r.hypgeom.cdf(u-t-1,e,e-a,u);if(2*u>e)return 1-r.hypgeom.cdf(a-t-1,e,a,e-u);if(u>a)return r.hypgeom.cdf(t,e,u,a);for(var o=1,i=1,l=0,f=0;t>f;f++){for(;o>1&&u>l;){var c=1-a/(e-l);i*=c,o*=c,l++}i*=(u-f)*(a-f)/((f+1)*(e-a-u+f+1)),o+=i}for(;u>l;l++)o*=1-a/(e-l);return n.min(1,n.max(0,o))}}),r.extend(r.poisson,{pdf:function(t,e){return n.pow(e,t)*n.exp(-e)/r.factorial(t)},cdf:function(n,t){var e=[],a=0;if(0>n)return 0;for(;n>=a;a++)e.push(r.poisson.pdf(a,t));return r.sum(e)},mean:function(r){return r},variance:function(r){return r},sample:function(r){var t=1,e=0,a=n.exp(-r);do e++,t*=n.random();while(t>a);return e-1}}),r.extend(r.triangular,{pdf:function(r,n,t,e){return n>=t||n>e||e>t?void 0:n>r||r>t?0:e>=r?2*(r-n)/((t-n)*(e-n)):2*(t-r)/((t-n)*(t-e))},cdf:function(r,t,e,a){return t>=e||t>a||a>e?void 0:t>r?0:a>=r?n.pow(r-t,2)/((e-t)*(a-t)):1-n.pow(e-r,2)/((e-t)*(e-a))},mean:function(r,n,t){return(r+n+t)/3},median:function(r,t,e){return(r+t)/2>=e?t-n.sqrt((t-r)*(t-e))/n.sqrt(2):e>(r+t)/2?r+n.sqrt((t-r)*(e-r))/n.sqrt(2):void 0},mode:function(r,n,t){return t},sample:function(r,t,e){var a=n.random();return(e-r)/(t-r)>a?r+n.sqrt(a*(t-r)*(e-r)):t-n.sqrt((1-a)*(t-r)*(t-e))},variance:function(r,n,t){return(r*r+n*n+t*t-r*n-r*t-n*t)/18}})}(this.jStat,Math),function(r,n){var t=Array.prototype.push,e=r.utils.isArray;r.extend({add:function(n,t){return e(t)?(e(t[0])||(t=[t]),r.map(n,function(r,n,e){return r+t[n][e]})):r.map(n,function(r){return r+t})},subtract:function(n,t){return e(t)?(e(t[0])||(t=[t]),r.map(n,function(r,n,e){return r-t[n][e]||0})):r.map(n,function(r){return r-t})},divide:function(n,t){return e(t)?(e(t[0])||(t=[t]),r.multiply(n,r.inv(t))):r.map(n,function(r){return r/t})},multiply:function(n,t){var a,u,o,i,l=n.length,f=n[0].length,c=r.zeros(l,o=e(t)?t[0].length:f),s=0;if(e(t)){for(;o>s;s++)for(a=0;l>a;a++){for(i=0,u=0;f>u;u++)i+=n[a][u]*t[u][s];c[a][s]=i}return 1===l&&1===s?c[0][0]:c}return r.map(n,function(r){return r*t})},dot:function(n,t){e(n[0])||(n=[n]),e(t[0])||(t=[t]);for(var a,u,o=1===n[0].length&&1!==n.length?r.transpose(n):n,i=1===t[0].length&&1!==t.length?r.transpose(t):t,l=[],f=0,c=o.length,s=o[0].length;c>f;f++){for(l[f]=[],a=0,u=0;s>u;u++)a+=o[f][u]*i[f][u];l[f]=a}return 1===l.length?l[0]:l},pow:function(t,e){return r.map(t,function(r){return n.pow(r,e)})},abs:function(t){return r.map(t,function(r){return n.abs(r)})},norm:function(r,t){var a=0,u=0;for(isNaN(t)&&(t=2),e(r[0])&&(r=r[0]);u<r.length;u++)a+=n.pow(n.abs(r[u]),t);return n.pow(a,1/t)},angle:function(t,e){return n.acos(r.dot(t,e)/(r.norm(t)*r.norm(e)))},aug:function(r,n){for(var e=r.slice(),a=0;a<e.length;a++)t.apply(e[a],n[a]);return e},inv:function(n){for(var t,e=n.length,a=n[0].length,u=r.identity(e,a),o=r.gauss_jordan(n,u),i=[],l=0;e>l;l++)for(i[l]=[],t=a-1;t<o[0].length;t++)i[l][t-a]=o[l][t];return i},det:function(r){var n,t=r.length,e=2*t,a=new Array(e),u=t-1,o=e-1,i=u-t+1,l=o,f=0,c=0;if(2===t)return r[0][0]*r[1][1]-r[0][1]*r[1][0];for(;e>f;f++)a[f]=1;for(f=0;t>f;f++){for(n=0;t>n;n++)a[0>i?i+t:i]*=r[f][n],a[t>l?l+t:l]*=r[f][n],i++,l--;i=--u-t+1,l=--o}for(f=0;t>f;f++)c+=a[f];for(;e>f;f++)c-=a[f];return c},gauss_elimination:function(t,e){var a,u,o,i,l=0,f=0,c=t.length,s=t[0].length,m=1,p=0,h=[];for(t=r.aug(t,e),a=t[0].length;c>l;l++){for(u=t[l][l],f=l,i=l+1;s>i;i++)u<n.abs(t[i][l])&&(u=t[i][l],f=i);if(f!=l)for(i=0;a>i;i++)o=t[l][i],t[l][i]=t[f][i],t[f][i]=o;for(f=l+1;c>f;f++)for(m=t[f][l]/t[l][l],i=l;a>i;i++)t[f][i]=t[f][i]-m*t[l][i]}for(l=c-1;l>=0;l--){for(p=0,f=l+1;c-1>=f;f++)p=h[f]*t[l][f];h[l]=(t[l][a-1]-p)/t[l][l]}return h},gauss_jordan:function(t,e){for(var a=r.aug(t,e),u=a.length,o=a[0].length,i=0;u>i;i++){for(var l=i,f=i+1;u>f;f++)n.abs(a[f][i])>n.abs(a[l][i])&&(l=f);var s=a[i];a[i]=a[l],a[l]=s;for(var f=i+1;u>f;f++){c=a[f][i]/a[i][i];for(var m=i;o>m;m++)a[f][m]-=a[i][m]*c}}for(var i=u-1;i>=0;i--){c=a[i][i];for(var f=0;i>f;f++)for(var m=o-1;m>i-1;m--)a[f][m]-=a[i][m]*a[f][i]/c;a[i][i]/=c;for(var m=u;o>m;m++)a[i][m]/=c}return a},lu:function(){throw new Error("lu not yet implemented")},cholesky:function(){throw new Error("cholesky not yet implemented")},gauss_jacobi:function(t,e,a,u){for(var o,i,l,f,c=0,s=0,m=t.length,p=[],h=[],g=[];m>c;c++)for(p[c]=[],h[c]=[],g[c]=[],s=0;m>s;s++)c>s?(p[c][s]=t[c][s],h[c][s]=g[c][s]=0):s>c?(h[c][s]=t[c][s],p[c][s]=g[c][s]=0):(g[c][s]=t[c][s],p[c][s]=h[c][s]=0);for(l=r.multiply(r.multiply(r.inv(g),r.add(p,h)),-1),i=r.multiply(r.inv(g),e),o=a,f=r.add(r.multiply(l,a),i),c=2;n.abs(r.norm(r.subtract(f,o)))>u;)o=f,f=r.add(r.multiply(l,o),i),c++;return f},gauss_seidel:function(t,e,a,u){for(var o,i,l,f,c,s=0,m=t.length,p=[],h=[],g=[];m>s;s++)for(p[s]=[],h[s]=[],g[s]=[],o=0;m>o;o++)s>o?(p[s][o]=t[s][o],h[s][o]=g[s][o]=0):o>s?(h[s][o]=t[s][o],p[s][o]=g[s][o]=0):(g[s][o]=t[s][o],p[s][o]=h[s][o]=0);for(f=r.multiply(r.multiply(r.inv(r.add(g,p)),h),-1),l=r.multiply(r.inv(r.add(g,p)),e),i=a,c=r.add(r.multiply(f,a),l),s=2;n.abs(r.norm(r.subtract(c,i)))>u;)i=c,c=r.add(r.multiply(f,i),l),s+=1;return c},SOR:function(t,e,a,u,o){for(var i,l,f,c,s,m=0,p=t.length,h=[],g=[],d=[];p>m;m++)for(h[m]=[],g[m]=[],d[m]=[],i=0;p>i;i++)m>i?(h[m][i]=t[m][i],g[m][i]=d[m][i]=0):i>m?(g[m][i]=t[m][i],h[m][i]=d[m][i]=0):(d[m][i]=t[m][i],h[m][i]=g[m][i]=0);for(c=r.multiply(r.inv(r.add(d,r.multiply(h,o))),r.subtract(r.multiply(d,1-o),r.multiply(g,o))),f=r.multiply(r.multiply(r.inv(r.add(d,r.multiply(h,o))),e),o),l=a,s=r.add(r.multiply(c,a),f),m=2;n.abs(r.norm(r.subtract(s,l)))>u;)l=s,s=r.add(r.multiply(c,l),f),m++;return s},householder:function(t){for(var e,a,u,o,i,l=t.length,f=t[0].length,c=0,s=[],m=[];l-1>c;c++){for(e=0,o=c+1;f>o;o++)e+=t[o][c]*t[o][c];for(i=t[c+1][c]>0?-1:1,e=i*n.sqrt(e),a=n.sqrt((e*e-t[c+1][c]*e)/2),s=r.zeros(l,1),s[c+1][0]=(t[c+1][c]-e)/(2*a),u=c+2;l>u;u++)s[u][0]=t[u][c]/(2*a);m=r.subtract(r.identity(l,f),r.multiply(r.multiply(s,r.transpose(s)),2)),t=r.multiply(m,r.multiply(t,m))}return t},QR:function(t,e){for(var a,u,o,i,l,f,c=t.length,s=t[0].length,m=0,p=[],h=[],g=[];c-1>m;m++){for(u=0,a=m+1;s>a;a++)u+=t[a][m]*t[a][m];for(l=t[m+1][m]>0?-1:1,u=l*n.sqrt(u),o=n.sqrt((u*u-t[m+1][m]*u)/2),p=r.zeros(c,1),p[m+1][0]=(t[m+1][m]-u)/(2*o),i=m+2;c>i;i++)p[i][0]=t[i][m]/(2*o);h=r.subtract(r.identity(c,s),r.multiply(r.multiply(p,r.transpose(p)),2)),t=r.multiply(h,t),e=r.multiply(h,e)}for(m=c-1;m>=0;m--){for(f=0,a=m+1;s-1>=a;a++)f=g[a]*t[m][a];g[m]=e[m][0]/t[m][m]}return g},jacobi:function(t){for(var e,a,u,o,i,l,f,c,s=1,m=0,p=t.length,h=r.identity(p,p),g=[];1===s;){for(m++,l=t[0][1],o=0,i=1,a=0;p>a;a++)for(u=0;p>u;u++)a!=u&&l<n.abs(t[a][u])&&(l=n.abs(t[a][u]),o=a,i=u);for(f=t[o][o]===t[i][i]?t[o][i]>0?n.PI/4:-n.PI/4:n.atan(2*t[o][i]/(t[o][o]-t[i][i]))/2,c=r.identity(p,p),c[o][o]=n.cos(f),c[o][i]=-n.sin(f),c[i][o]=n.sin(f),c[i][i]=n.cos(f),h=r.multiply(h,c),e=r.multiply(r.multiply(r.inv(c),t),c),t=e,s=0,a=1;p>a;a++)for(u=1;p>u;u++)a!=u&&n.abs(t[a][u])>.001&&(s=1)}for(a=0;p>a;a++)g.push(t[a][a]);return[h,g]},rungekutta:function(r,n,t,e,a,u){var o,i,l,f,c;if(2===u)for(;t>=e;)o=n*r(e,a),i=n*r(e+n,a+o),l=a+(o+i)/2,a=l,e+=n;if(4===u)for(;t>=e;)o=n*r(e,a),i=n*r(e+n/2,a+o/2),f=n*r(e+n/2,a+i/2),c=n*r(e+n,a+f),l=a+(o+2*i+2*f+c)/6,a=l,e+=n;return a},romberg:function(r,t,e,a){for(var u,o,i,l,f,c=0,s=(e-t)/2,m=[],p=[],h=[];a/2>c;){for(f=r(t),i=t,l=0;e>=i;i+=s,l++)m[l]=i;for(u=m.length,i=1;u-1>i;i++)f+=(i%2!==0?4:2)*r(m[i]);f=s/3*(f+r(e)),h[c]=f,s/=2,c++}for(o=h.length,u=1;1!==o;){for(i=0;o-1>i;i++)p[i]=(n.pow(4,u)*h[i+1]-h[i])/(n.pow(4,u)-1);o=p.length,h=p,p=[],u++}return h},richardson:function(r,t,e,a){function u(r,n){for(var t,e=0,a=r.length;a>e;e++)r[e]===n&&(t=e);return t}for(var o,i,l,f,c,s=(r.length,n.abs(e-r[u(r,e)+1])),m=0,p=[],h=[];a>=s;)o=u(r,e+a),i=u(r,e),p[m]=(t[o]-2*t[i]+t[2*i-o])/(a*a),a/=2,m++;for(f=p.length,l=1;1!=f;){for(c=0;f-1>c;c++)h[c]=(n.pow(4,l)*p[c+1]-p[c])/(n.pow(4,l)-1);f=h.length,p=h,h=[],l++}return p},simpson:function(r,n,t,e){for(var a,u=(t-n)/e,o=r(n),i=[],l=n,f=0,c=1;t>=l;l+=u,f++)i[f]=l;for(a=i.length;a-1>c;c++)o+=(c%2!==0?4:2)*r(i[c]);return u/3*(o+r(t))},hermite:function(r,n,t,e){for(var a,u=r.length,o=0,i=0,l=[],f=[],c=[],s=[];u>i;i++){for(l[i]=1,a=0;u>a;a++)i!=a&&(l[i]*=(e-r[a])/(r[i]-r[a]));for(f[i]=0,a=0;u>a;a++)i!=a&&(f[i]+=1/(r[i]-r[a]));c[i]=(1-2*(e-r[i])*f[i])*l[i]*l[i],s[i]=(e-r[i])*l[i]*l[i],o+=c[i]*n[i]+s[i]*t[i]}return o},lagrange:function(r,n,t){for(var e,a,u=0,o=0,i=r.length;i>o;o++){for(a=n[o],e=0;i>e;e++)o!=e&&(a*=(t-r[e])/(r[o]-r[e]));u+=a}return u},cubic_spline:function(n,t,e){for(var a,u=n.length,o=0,i=[],l=[],f=[],c=[],s=[],m=[],p=[];u-1>o;o++)s[o]=n[o+1]-n[o];for(f[0]=0,o=1;u-1>o;o++)f[o]=3/s[o]*(t[o+1]-t[o])-3/s[o-1]*(t[o]-t[o-1]);for(o=1;u-1>o;o++)i[o]=[],l[o]=[],i[o][o-1]=s[o-1],i[o][o]=2*(s[o-1]+s[o]),i[o][o+1]=s[o],l[o][0]=f[o];for(c=r.multiply(r.inv(i),l),a=0;u-1>a;a++)m[a]=(t[a+1]-t[a])/s[a]-s[a]*(c[a+1][0]+2*c[a][0])/3,p[a]=(c[a+1][0]-c[a][0])/(3*s[a]);for(a=0;u>a&&!(n[a]>e);a++);return a-=1,t[a]+(e-n[a])*m[a]+r.sq(e-n[a])*c[a]+(e-n[a])*r.sq(e-n[a])*p[a]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(n){var t,e,a=n.length,u=n[0].length,o=0,i=[],l=[],f=[],c=[],s=[],m=[],p=[],h=[],g=[],d=[];for(o=0;a>o;o++)i[o]=r.sum(n[o])/u;for(o=0;u>o;o++)for(p[o]=[],t=0;a>t;t++)p[o][t]=n[t][o]-i[t];for(p=r.transpose(p),o=0;a>o;o++)for(h[o]=[],t=0;a>t;t++)h[o][t]=r.dot([p[o]],[p[t]])/(u-1);for(f=r.jacobi(h),g=f[0],l=f[1],d=r.transpose(g),o=0;o<l.length;o++)for(t=o;t<l.length;t++)l[o]<l[t]&&(e=l[o],l[o]=l[t],l[t]=e,c=d[o],d[o]=d[t],d[t]=c);for(m=r.transpose(p),o=0;a>o;o++)for(s[o]=[],t=0;t<m.length;t++)s[o][t]=r.dot([d[o]],[m[t]]);return[n,l,d,s]}}),function(n){for(var t=0;t<n.length;t++)(function(n){r.fn[n]=function(t,e){var a=this;return e?(setTimeout(function(){e.call(a,r.fn[n].call(a,t))},15),this):r(r[n](this,t))}})(n[t])}("add divide multiply subtract dot pow abs norm angle".split(" "))}(this.jStat,Math),function(r,n){var t=[].slice,e=r.utils.isNumber;r.extend({zscore:function(){var n=t.call(arguments);return e(n[1])?(n[0]-n[1])/n[2]:(n[0]-r.mean(n[1]))/r.stdev(n[1],n[2])},ztest:function(){var a=t.call(arguments);if(4===a.length){if(e(a[1])){var u=r.zscore(a[0],a[1],a[2]);return 1===a[3]?r.normal.cdf(-n.abs(u),0,1):2*r.normal.cdf(-n.abs(u),0,1)}var u=a[0];return 1===a[2]?r.normal.cdf(-n.abs(u),0,1):2*r.normal.cdf(-n.abs(u),0,1)}var u=r.zscore(a[0],a[1],a[3]);return 1===a[1]?r.normal.cdf(-n.abs(u),0,1):2*r.normal.cdf(-n.abs(u),0,1)}}),r.extend(r.fn,{zscore:function(r,n){return(r-this.mean())/this.stdev(n)},ztest:function(t,e,a){var u=n.abs(this.zscore(t,a));return 1===e?r.normal.cdf(-u,0,1):2*r.normal.cdf(-u,0,1)}}),r.extend({tscore:function(){var e=t.call(arguments);return 4===e.length?(e[0]-e[1])/(e[2]/n.sqrt(e[3])):(e[0]-r.mean(e[1]))/(r.stdev(e[1],!0)/n.sqrt(e[1].length))},ttest:function(){var a,u=t.call(arguments);return 5===u.length?(a=n.abs(r.tscore(u[0],u[1],u[2],u[3])),1===u[4]?r.studentt.cdf(-a,u[3]-1):2*r.studentt.cdf(-a,u[3]-1)):e(u[1])?(a=n.abs(u[0]),1==u[2]?r.studentt.cdf(-a,u[1]-1):2*r.studentt.cdf(-a,u[1]-1)):(a=n.abs(r.tscore(u[0],u[1])),1==u[2]?r.studentt.cdf(-a,u[1].length-1):2*r.studentt.cdf(-a,u[1].length-1))}}),r.extend(r.fn,{tscore:function(r){return(r-this.mean())/(this.stdev(!0)/n.sqrt(this.cols()))},ttest:function(t,e){return 1===e?1-r.studentt.cdf(n.abs(this.tscore(t)),this.cols()-1):2*r.studentt.cdf(-n.abs(this.tscore(t)),this.cols()-1)}}),r.extend({anovafscore:function(){var e,a,u,o,i,l,f,c,s=t.call(arguments);if(1===s.length){for(i=new Array(s[0].length),f=0;f<s[0].length;f++)i[f]=s[0][f];s=i}if(2===s.length)return r.variance(s[0])/r.variance(s[1]);for(a=new Array,f=0;f<s.length;f++)a=a.concat(s[f]);for(u=r.mean(a),e=0,f=0;f<s.length;f++)e+=s[f].length*n.pow(r.mean(s[f])-u,2);for(e/=s.length-1,l=0,f=0;f<s.length;f++)for(o=r.mean(s[f]),c=0;c<s[f].length;c++)l+=n.pow(s[f][c]-o,2);return l/=a.length-s.length,e/l},anovaftest:function(){var n,a,u,o,i=t.call(arguments);if(e(i[0]))return 1-r.centralF.cdf(i[0],i[1],i[2]);for(anovafscore=r.anovafscore(i),n=i.length-1,u=0,o=0;o<i.length;o++)u+=i[o].length;return a=u-n-1,1-r.centralF.cdf(anovafscore,n,a)},ftest:function(n,t,e){return 1-r.centralF.cdf(n,t,e)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var n,t=0;for(n=0;n<this.length;n++)t+=this[n].length;return r.ftest(this.anovafscore(),this.length-1,t-this.length)}}),r.extend({normalci:function(){var e,a=t.call(arguments),u=new Array(2);return e=n.abs(4===a.length?r.normal.inv(a[1]/2,0,1)*a[2]/n.sqrt(a[3]):r.normal.inv(a[1]/2,0,1)*r.stdev(a[2])/n.sqrt(a[2].length)),u[0]=a[0]-e,u[1]=a[0]+e,u},tci:function(){var e,a=t.call(arguments),u=new Array(2);return e=n.abs(4===a.length?r.studentt.inv(a[1]/2,a[3]-1)*a[2]/n.sqrt(a[3]):r.studentt.inv(a[1]/2,a[2].length-1)*r.stdev(a[2],!0)/n.sqrt(a[2].length)),u[0]=a[0]-e,u[1]=a[0]+e,u},significant:function(r,n){return n>r}}),r.extend(r.fn,{normalci:function(n,t){return r.normalci(n,t,this.toArray())},tci:function(n,t){return r.tci(n,t,this.toArray())}})}(this.jStat,Math),function(){function exportModule(numeral,jStat,moment,_,_s,md5){var MEMOIZED_FACT=[],SQRT2PI=2.5066282746310002,WEEK_STARTS=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],WEEK_TYPES=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],WEEKEND_TYPES=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]],simplifyArguments=function(r){for(var n in r)_.isArray(r[n])&&(r[n]=Formula.FLATTEN(r[n]));return r};return Formula.UNIQUE=function(){return _.unique(arguments)
},Formula.FLATTEN=function(){return _.flatten(arguments)},Formula.FUNCTION=function(){var r=Array.prototype.slice.call(arguments),n=r[r.length-1],t=/(\w+)\(/g,e=n.replace(t,function(){return"Formulae."+arguments[0]});return r[r.length-1]="return "+e+";",e!==n&&r.unshift("Formulae"),Function.apply(null,r)},Formula.MOMENT=function(r,n){return moment(r).format(n)},Formula.MOMENTADD=function(r,n,t){return moment(r).add(n,t)},Formula.MOMENTDIFF=function(r,n,t){return moment(n).diff(moment.utc(r),t)},Formula.MOMENTSUB=function(r,n,t){return moment(r).subtract(n,t)},Formula.MOMENTUTC=function(r,n){return moment.utc(r).format(n)},Formula.MOMENTUTCADD=function(r,n,t){return moment.utc(r).add(n,t)},Formula.MOMENTUTCDIFF=function(r,n,t){return moment.utc(n).diff(moment.utc(r),t)},Formula.MOMENTUTCSUB=function(r,n,t){return moment.utc(r).subtract(n,t)},Formula.MOMENTUNIX=function(r){return moment.unix(r).toDate()},Formula.MOMENTFORMAT=function(r,n){return moment(r).format(n)},Formula.MOMENTISLEAPYEAR=function(r,n){return moment(r,n).isLeapYear()},Formula.MOMENTISDST=function(r,n){return moment(r,n).isDST()},Formula.MOMENTSTARTOF=function(r,n,t){return moment(r,t).startOf(n).toDate()},Formula.MOMENTENDOF=function(r,n,t){return moment(r,t).endOf(n).toDate()},Formula.MOMENTISAFTER=function(r,n,t){return moment(r,t).isAfter(moment(n,t))},Formula.MOMENTISBEFORE=function(r,n,t){return moment(r,t).isBefore(moment(n,t))},Formula.INTERVAL=function(r){var n=Math.floor(r/94608e4);r%=94608e4;var t=Math.floor(r/2592e3);r%=2592e3;var e=Math.floor(r/86400);r%=86400;var a=Math.floor(r/3600);r%=3600;var u=Math.floor(r/60);r%=60;var o=r;return n=n>0?n+"Y":"",t=t>0?t+"M":"",e=e>0?e+"D":"",a=a>0?a+"H":"",u=u>0?u+"M":"",o=o>0?o+"S":"","P"+n+t+e+"T"+a+u+o},Formula.ARGSCONCAT=function(r){for(var n=[],t=0;t<r.length;t++)n=n.concat(r[t]);return n},Formula.ARGSTOARRAY=function(r){return Array.prototype.slice.call(r,0)},Formula.CLEANFLOAT=function(r){var n=Math.pow(10,14);return Math.round(r*n)/n},Formula.COUNTIN=function(r,n){for(var t=0,e=0;e<r.length;e++)r[e]===n&&t++;return t},Formula.FINDFIELD=function(r,n){for(var t=null,e=0;e<r.length;e++)if(r[e][0]===n){t=e;break}return null==t?"#VALUE!":t},Formula.FINDRESULTINDEX=function(database,criteria){for(var maxCriteriaLength=criteria[0].length,i=1;i<criteria.length;i++)criteria[i].length>maxCriteriaLength&&(maxCriteriaLength=criteria[i].length);var columnResultIndexes=[];for(i=1;maxCriteriaLength>i;i++){for(var rowResultIndexes=[],j=0;j<criteria.length;j++)if(!(criteria[j].length<maxCriteriaLength)){for(var criteriaTitle=criteria[j][0],criteriaIndex=Formula.FINDFIELD(database,criteriaTitle),criteriaValues=_.rest(database[criteriaIndex]),count=0,singleResultIndexes=[],k=0;k<criteriaValues.length;k++)eval(criteriaValues[k]+criteria[j][i])&&(singleResultIndexes[count++]=k);rowResultIndexes[j]=singleResultIndexes}columnResultIndexes[i-1]=_.intersection.apply(_,rowResultIndexes)}var resultIndexes=_.union.apply(_,columnResultIndexes);return resultIndexes},Formula.DAVERAGE=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=0,i=0;i<e.length;i++)o+=a[e[i]];var l=Formula.IF(0===e.length,"#DIV/0!",o/e.length);return l},Formula.DCOUNT=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];return Formula.COUNT(o)},Formula.DCOUNTA=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];return Formula.COUNTA(o)},Formula.DGET=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);return 0===e.length?"#VALUE!":e.length>1?"#NUM!":a[e[0]]},Formula.DMAX=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=a[e[0]],i=1;i<e.length;i++)o<a[e[i]]&&(o=a[e[i]]);return o},Formula.DMIN=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=a[e[0]],i=1;i<e.length;i++)o>a[e[i]]&&(o=a[e[i]]);return o},Formula.DPRODUCT=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];o=_.compact(o);var l=1;for(i=0;i<o.length;i++)l*=o[i];return l},Formula.DSTDEV=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];return o=_.compact(o),Formula.STDEVS(o)},Formula.DSTDEVP=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];return o=_.compact(o),Formula.STDEVP(o)},Formula.DSUM=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];return Formula.SUM(o)},Formula.DVAR=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];return Formula.VARS(o)},Formula.DVARP=function(r,n,t){if(isNaN(n)&&"string"!=typeof n)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,t),a=[];if("string"==typeof n){var u=Formula.FINDFIELD(r,n);a=_.rest(r[u])}else a=_.rest(r[n]);for(var o=[],i=0;i<e.length;i++)o[i]=a[e[i]];return Formula.VARP(o)},Formula.GETJSON=function(r){var n=new XMLHttpRequest;return n.open("GET",r,!1),n.send(null),200===n.status?JSON.parse(n.responseText):void 0},Formula.DATE=function(){if(!arguments.length)return new Date;if(1===arguments.length)return new Date(arguments[0]);var r=arguments;return r[1]=r[1]-1,new(Date.bind.apply(Date,[Date].concat([].splice.call(r,0))))},Formula.DATEVALUE=function(r){return Math.ceil((moment(r)-moment("1900-01-01"))/864e5)+2},Formula.DAY=function(r){return new Date(r).getDate()},Formula.DAYS=function(r,n){return moment(new Date(r)).diff(moment(new Date(n)),"days")},Formula.DAYS360=function(r,n,t){var e=moment(new Date(r)),a=moment(new Date(n)),u=31,o=31,i=e.date(),l=a.date();return t?(i=31===i?30:i,l=31===l?30:l):(1===e.month()&&(u=e.daysInMonth()),1===a.month()&&(o=a.daysInMonth()),i=i===u?30:i,(30===i||i===u)&&(l=l===o?30:l)),360*(a.year()-e.year())+30*(a.month()-e.month())+(l-i)},Formula.EDATE=function(r,n){return moment(new Date(r)).add("months",n).toDate()},Formula.EOMONTH=function(r,n){var t=moment(new Date(r)).add("months",n);return new Date(t.year(),t.month(),t.daysInMonth())},Formula.FROMNOW=function(r,n){return moment(new Date(r)).fromNow(n)},Formula.HOUR=function(r){return 1>=r?Math.floor(24*r):new Date(r).getHours()},Formula.MINUTE=function(r){return 1>=r?Math.floor(1440*r)-60*Math.floor(24*r):new Date(r).getMinutes()},Formula.ISOWEEKNUM=function(r){return moment(new Date(r)).format("w")},Formula.MONTH=function(r){return new Date(r).getMonth()+1},Formula.NETWORKDAYS=function(r,n,t){return Formula.NETWORKDAYSINTL(r,n,1,t)},Formula.NETWORKDAYSINTL=function(r,n,t,e){var a="undefined"==typeof t?1:t,u=WEEKEND_TYPES[a],o=moment(r),i=moment(n),l=i.diff(o,"days")+1,f=l,c=o,s=[];if("undefined"!=typeof e)for(var m=0;m<e.length;m++)s[m]=moment(new Date(e[m])).format("MM-DD-YYYY");if(!u.length&&!s.length)return f;for(var p=0;l>p;)u.indexOf(parseInt(c.format("d"),10))>=0?f--:s.indexOf(c.format("MM-DD-YYYY"))>=0&&f--,c=c.add("days",1),p++;return f},Formula.NOW=function(){return new Date},Formula.SECOND=function(r){return new Date(r).getSeconds()},Formula.TIME=function(r,n,t){return(3600*r+60*n+t)/86400},Formula.TIMEVALUE=function(r){var n=new Date(r);return(3600*n.getHours()+60*n.getMinutes()+n.getSeconds())/86400},Formula.TODAY=Formula.NOW,Formula.WEEKDAY=function(r,n){var t=moment(new Date(r)).format("d"),e="undefined"==typeof n?1:n;return WEEK_TYPES[e][t]},Formula.WEEKNUM=function(r,n){var t=moment(new Date(r)),e=moment(new Date(t.year(),0,1)),a="undefined"==typeof n?1:n,u=WEEK_STARTS[a],o=e.format("d"),i=u>o?u-o+1:o-u;return 21===a?Formula.ISOWEEKNUM(r):Math.floor(t.diff(e.subtract("days",i),"days")/7)+1},Formula.WORKDAY=function(r,n,t){return Formula.WORKDAYINTL(r,n,1,t)},Formula.WORKDAYINTL=function(r,n,t,e){var a="undefined"==typeof t?1:t,u=WEEKEND_TYPES[a],o=moment(new Date(r)),i=o,l="",f=[];if("undefined"!=typeof e)for(var c=0;c<e.length;c++)f[c]=moment(new Date(e[c])).format("MM-DD-YYYY");for(var s=0;n>s;)i=i.add("days",1),l=i.format("d"),u.indexOf(parseInt(l,10))<0&&f.indexOf(i.format("MM-DD-YYYY"))<0&&s++;return i.toDate()},Formula.YEAR=function(r){return new Date(r).getFullYear()},Formula.YEARFRAC=function(r,n,t){t="undefined"==typeof t?0:t;var e=moment(new Date(r)),a=moment(new Date(n));if(!e.isValid()||!a.isValid())return"#VALUE!";if(-1===[0,1,2,3,4].indexOf(t))return"#NUM!";if(e===a)return 0;e.diff(a)>0&&(a=moment(new Date(r)),e=moment(new Date(n)));var u=e.year(),o=e.month(),i=e.date(),l=a.year(),f=a.month(),c=a.date();switch(t){case 0:return 31===i&&31===c?(i=30,c=30):31===i?i=30:30===i&&31===c?c=30:1===o&&1===f&&e.daysInMonth()===i&&a.daysInMonth()===c?(i=30,c=30):1===o&&e.daysInMonth()===i&&(i=30),(c+30*f+360*l-(i+30*o+360*u))/360;case 1:var s=function(r,n){var t=moment(new Date(r.year(),2,1));if(moment([r.year()]).isLeapYear()&&r.diff(t)<0&&n.diff(t)>=0)return!0;var e=moment(new Date(n.year(),2,1));return moment([n.year()]).isLeapYear()&&n.diff(e)>=0&&r.diff(e)<0?!0:!1},m=365;if(u===l||u+1===l&&(o>f||o===f&&i>=c))return u===l&&moment([u]).isLeapYear()?m=366:(s(e,a)||1===f&&29===c)&&(m=366),a.diff(e,"days")/m;var p=l-u+1,h=moment(new Date(l+1,0,1)).diff(moment(new Date(u,0,1)),"days"),g=h/p;return a.diff(e,"days")/g;case 2:return a.diff(e,"days")/360;case 3:return a.diff(e,"days")/365;case 4:return 31===i&&(i=30),31===c&&(c=30),(c+30*f+360*l-(i+30*o+360*u))/360}},Formula.BESSELI=function(){function r(r,n){return r.reduce(function(r,t){return n*r+t},0)}function n(n){return 3.75>=n?r(e,n*n/14.0625):Math.exp(Math.abs(n))/Math.sqrt(Math.abs(n))*r(a,3.75/Math.abs(n))}function t(n){return 3.75>n?n*r(u,n*n/14.0625):(0>n?-1:1)*Math.exp(Math.abs(n))/Math.sqrt(Math.abs(n))*r(o,3.75/Math.abs(n))}var e=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),a=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),u=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),o=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function i(r,e){if(e=Math.round(e),0===e)return n(r);if(1===e)return t(r);if(0>e)throw"BESSELI Order ("+e+") must be nonnegative";if(0===Math.abs(r))return 0;var a,u,o,l,f,c,s=2/Math.abs(r);for(o=2*Math.round((e+Math.round(Math.sqrt(40*e)))/2),l=a=0,f=1,u=o;u>0;u--)c=u*s*f+l,l=f,f=c,Math.abs(f)>1e10&&(f*=1e-10,l*=1e-10,a*=1e-10),u===e&&(a=l);return a*=i(r,0)/f,0>r&&e%2?-a:a}}(),Formula.BESSELJ=function(){function r(r,n){return r.reduce(function(r,t){return n*r+t},0)}function n(n){var t,e,f,c=n*n,s=Math.abs(n)-.785398164;return Math.abs(n)<8?(e=r(a,c),f=r(u,c),t=e/f):(c=64/c,e=r(o,c),f=r(i,c),t=Math.sqrt(l/Math.abs(n))*(Math.cos(s)*e-Math.sin(s)*f*8/Math.abs(n))),t}function t(n){var t,e,a,u=n*n,o=Math.abs(n)-2.356194491;return Math.abs(n)<8?(e=n*r(f,u),a=r(c,u),t=e/a):(u=64/u,e=r(s,u),a=r(m,u),t=Math.sqrt(l/Math.abs(n))*(Math.cos(o)*e-Math.sin(o)*a*8/Math.abs(n)),0>n&&(t=-t)),t}function e(r,n,t,e,a){a||(a=-1);var u,o=2/r;if(0===n)return t;if(1===n)return e;for(var i=1;i!==n;++i)u=e*i*o+a*t,t=e,e=u;return e}var a=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),u=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),o=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),l=.636619772,f=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),c=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),s=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),m=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return function(r,a){if(a=Math.round(a),0===a)return n(Math.abs(r));if(1===a)return t(Math.abs(r));if(0>a)throw"BESSELJ: Order ("+a+") must be nonnegative";if(0===Math.abs(r))return 0;var u,o,i,l,f,c,s,m,p=2/Math.abs(r);if(Math.abs(r)>a)u=e(r,a,n(Math.abs(r)),t(Math.abs(r)),-1);else{for(i=2*Math.floor((a+Math.floor(Math.sqrt(40*a)))/2),l=0,c=u=f=0,s=1,o=i;o>0;o--)m=o*p*s-c,c=s,s=m,Math.abs(s)>1e10&&(s*=1e-10,c*=1e-10,u*=1e-10,f*=1e-10),l&&(f+=s),l=!l,o===a&&(u=c);f=2*f-s,u/=f}return 0>r&&a%2?-u:u}}(),Formula.BESSELK=function(){function r(r,n){return r.reduce(function(r,t){return n*r+t},0)}function n(n){return 2>=n?-Math.log(n/2)*Formula.BESSELI(n,0)+r(u,n*n/4):Math.exp(-n)/Math.sqrt(n)*r(o,2/n)}function t(n){return 2>=n?Math.log(n/2)*Formula.BESSELI(n,1)+1/n*r(i,n*n/4):Math.exp(-n)/Math.sqrt(n)*r(l,2/n)}function e(r,n,t,e,a){a||(a=-1);var u,o=2/r;if(0===n)return t;if(1===n)return e;for(var i=1;i!==n;++i)u=e*i*o+a*t,t=e,e=u;return e}function a(r,n,t,a,u){return function(o,i){if(0===i)return r(o);if(1===i)return n(o);if(0>i)throw t+": Order ("+i+") must be nonnegative";if(1===a&&0===o)throw t+": Undefined when x == 0";if(2===a&&0>=o)throw t+": Undefined when x <= 0";var l=r(o),f=n(o);return e(o,i,l,f,u)}}var u=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),o=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),i=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),l=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return a(n,t,"BESSELK",2,1)}(),Formula.BESSELY=function(){function r(r,n){return r.reduce(function(r,t){return n*r+t},0)}function n(n){var t,e,a,c=n*n,s=n-.785398164;return 8>n?(e=r(u,c),a=r(o,c),t=e/a+f*Formula.BESSELJ(n,0)*Math.log(n)):(c=64/c,e=r(i,c),a=r(l,c),t=Math.sqrt(f/n)*(Math.sin(s)*e+Math.cos(s)*a*8/n)),t}function t(n){var t,e,a,u=n*n,o=n-2.356194491;return 8>n?(e=n*r(c,u),a=r(s,u),t=e/a+f*(Formula.BESSELJ(n,1)*Math.log(n)-1/n)):(u=64/u,e=r(m,u),a=r(p,u),t=Math.sqrt(f/n)*(Math.sin(o)*e+Math.cos(o)*a*8/n)),t}function e(r,n,t,e,a){a||(a=-1);var u,o=2/r;if(0===n)return t;if(1===n)return e;for(var i=1;i!==n;++i)u=e*i*o+a*t,t=e,e=u;return e}function a(r,n,t,a,u){return function(o,i){if(0===i)return r(o);if(1===i)return n(o);if(0>i)throw t+": Order ("+i+") must be nonnegative";if(1===a&&0===o)throw t+": Undefined when x == 0";if(2===a&&0>=o)throw t+": Undefined when x <= 0";var l=r(o),f=n(o);return e(o,i,l,f,u)}}var u=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),o=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),i=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),l=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),f=.636619772,c=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),s=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),m=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return a(n,t,"BESSELY",1,-1)}(),Formula.VALIDBIN=function(r){return/^[01]{1,10}$/.test(r)},Formula.BIN2DEC=function(r){if(!Formula.VALIDBIN(r))return"#NUM!";var n=parseInt(r,2),t=r.toString();return 10===t.length&&"1"===t.substring(0,1)?parseInt(t.substring(1),2)-512:n},Formula.BIN2HEX=function(r,n){if(!Formula.VALIDBIN(r))return"#NUM!";var t=r.toString();if(10===t.length&&"1"===t.substring(0,1))return(0xfffffffe00+parseInt(t.substring(1),2)).toString(16);var e=parseInt(r,2).toString(16);return"undefined"==typeof n?e:isNaN(n)?"#VALUE!":0>n?"#NUM!":(n=Math.floor(n),n>=e.length?_s.repeat("0",n-e.length)+e:"#NUM!")},Formula.BIN2OCT=function(r,n){if(!Formula.VALIDBIN(r))return"#NUM!";var t=r.toString();if(10===t.length&&"1"===t.substring(0,1))return(1073741312+parseInt(t.substring(1),2)).toString(8);var e=parseInt(r,2).toString(8);return"undefined"==typeof n?e:isNaN(n)?"#VALUE!":0>n?"#NUM!":(n=Math.floor(n),n>=e.length?_s.repeat("0",n-e.length)+e:"#NUM!")},Formula.BITAND=function(r,n){return isNaN(r)||isNaN(n)?"#VALUE!":0>r||0>n?"#NUM!":Math.floor(r)!==r||Math.floor(n)!==n?"#NUM!":r>0xffffffffffff||n>0xffffffffffff?"#NUM!":r&n},Formula.BITLSHIFT=function(r,n){return isNaN(r)||isNaN(n)?"#VALUE!":0>r?"#NUM!":Math.floor(r)!==r?"#NUM!":r>0xffffffffffff?"#NUM!":Math.abs(n)>53?"#NUM!":n>=0?r<<n:r>>-n},Formula.BITOR=function(r,n){return isNaN(r)||isNaN(n)?"#VALUE!":0>r||0>n?"#NUM!":Math.floor(r)!==r||Math.floor(n)!==n?"#NUM!":r>0xffffffffffff||n>0xffffffffffff?"#NUM!":r|n},Formula.BITRSHIFT=function(r,n){return isNaN(r)||isNaN(n)?"#VALUE!":0>r?"#NUM!":Math.floor(r)!==r?"#NUM!":r>0xffffffffffff?"#NUM!":Math.abs(n)>53?"#NUM!":n>=0?r>>n:r<<-n},Formula.BITXOR=function(r,n){return isNaN(r)||isNaN(n)?"#VALUE!":0>r||0>n?"#NUM!":Math.floor(r)!==r||Math.floor(n)!==n?"#NUM!":r>0xffffffffffff||n>0xffffffffffff?"#NUM!":r^n},Formula.COMPLEX=function(r,n,t){if(isNaN(r)||isNaN(n))return"#VALUE!";if(t="undefined"==typeof t?"i":t,"i"!==t&&"j"!==t)return"#VALUE!";if(0===r&&0===n)return 0;if(0===r)return 1===n?t:n.toString()+t;if(0===n)return r.toString();var e=n>0?"+":"";return r.toString()+e+(1===n?t:n.toString()+t)},Formula.CONVERT=function(r,n,t){if(isNaN(r))return"#VALUE!";for(var e,a=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],u={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},o={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},i=null,l=null,f=n,c=t,s=1,m=1,p=0;p<a.length;p++)e=null===a[p][2]?[]:a[p][2],(a[p][1]===f||e.indexOf(f)>=0)&&(i=a[p]),(a[p][1]===c||e.indexOf(c)>=0)&&(l=a[p]);if(null===i){var h=u[n.substring(0,2)],g=o[n.substring(0,1)];"da"===n.substring(0,2)&&(g=["dekao",10,"da"]),h?(s=h[2],f=n.substring(2)):g&&(s=g[1],f=n.substring(g[2].length));for(var d=0;d<a.length;d++)e=null===a[d][2]?[]:a[d][2],(a[d][1]===f||e.indexOf(f)>=0)&&(i=a[d])}if(null===l){var v=u[t.substring(0,2)],M=o[t.substring(0,1)];"da"===t.substring(0,2)&&(M=["dekao",10,"da"]),v?(m=v[2],c=t.substring(2)):M&&(m=M[1],c=t.substring(M[2].length));for(var F=0;F<a.length;F++)e=null===a[F][2]?[]:a[F][2],(a[F][1]===c||e.indexOf(c)>=0)&&(l=a[F])}return null===i||null===l?"#N/A":i[3]!==l[3]?"#N/A":r*i[6]*s/(l[6]*m)},Formula.DEC2BIN=function(r,n){if(isNaN(r))return"#VALUE!";if(!/^-?[0-9]{1,3}$/.test(r)||-512>r||r>511)return"#NUM!";if(0>r)return"1"+_s.repeat("0",9-(512+r).toString(2).length)+(512+r).toString(2);var t=parseInt(r,10).toString(2);return"undefined"==typeof n?t:isNaN(n)?"#VALUE!":0>n?"#NUM!":(n=Math.floor(n),n>=t.length?_s.repeat("0",n-t.length)+t:"#NUM!")},Formula.DEC2HEX=function(r,n){if(isNaN(r))return"#VALUE!";if(!/^-?[0-9]{1,12}$/.test(r)||-549755813888>r||r>549755813887)return"#NUM!";if(0>r)return(1099511627776+r).toString(16);var t=parseInt(r,10).toString(16);return"undefined"==typeof n?t:isNaN(n)?"#VALUE!":0>n?"#NUM!":(n=Math.floor(n),n>=t.length?_s.repeat("0",n-t.length)+t:"#NUM!")},Formula.DEC2OCT=function(r,n){if(isNaN(r))return"#VALUE!";if(!/^-?[0-9]{1,9}$/.test(r)||-536870912>r||r>536870911)return"#NUM!";if(0>r)return(1073741824+r).toString(8);var t=parseInt(r,10).toString(8);return"undefined"==typeof n?t:isNaN(n)?"#VALUE!":0>n?"#NUM!":(n=Math.floor(n),n>=t.length?_s.repeat("0",n-t.length)+t:"#NUM!")},Formula.DELTA=function(r,n){return n="undefined"==typeof n?0:n,isNaN(r)||isNaN(n)?"#VALUE!":r===n?1:0},Formula.ERF=function(r,n){return n="undefined"==typeof n?0:n,isNaN(r)||isNaN(n)?"#VALUE!":jStat.erf(r)},Formula.ERFC=function(r){return isNaN(r)?"#VALUE!":jStat.erfc(r)},Formula.ERFCPRECISE=function(){},Formula.ERFPRECISE=function(){},Formula.GESTEP=function(r,n){return n="undefined"==typeof n?0:n,isNaN(r)||isNaN(n)?"#VALUE!":r>=n?1:0},Formula.HEX2BIN=function(r,n){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return"#NUM!";var t=10===r.length&&"f"===r.substring(0,1).toLowerCase()?!0:!1,e=t?parseInt(r,16)-1099511627776:parseInt(r,16);if(-512>e||e>511)return"#NUM!";if(t)return"1"+_s.repeat("0",9-(512+e).toString(2).length)+(512+e).toString(2);var a=e.toString(2);return"undefined"==typeof n?a:isNaN(n)?"#VALUE!":0>n?"#NUM!":(n=Math.floor(n),n>=a.length?_s.repeat("0",n-a.length)+a:"#NUM!")},Formula.HEX2DEC=function(r){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return"#NUM!";var n=parseInt(r,16);return n>=549755813888?n-1099511627776:n},Formula.HEX2OCT=function(r,n){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return"#NUM!";var t=parseInt(r,16);if(t>536870911&&0xffe0000000>t)return"#NUM!";if(t>=0xffe0000000)return(t-0xffc0000000).toString(8);var e=t.toString(8);return"undefined"==typeof n?e:isNaN(n)?"#VALUE!":0>n?"#NUM!":(n=Math.floor(n),n>=e.length?_s.repeat("0",n-e.length)+e:"#NUM!")},Formula.IMABS=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":Math.sqrt(Math.pow(n,2)+Math.pow(t,2))},Formula.IMAGINARY=function(r){if(0===r||"0"===r)return 0;if(["i","j"].indexOf(r)>=0)return 1;r=r.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var n=r.indexOf("+"),t=r.indexOf("-");0===n&&(n=r.indexOf("+",1)),0===t&&(t=r.indexOf("-",1));var e=r.substring(r.length-1,r.length),a="i"===e||"j"===e;return n>=0||t>=0?a?n>=0?isNaN(r.substring(0,n))||isNaN(r.substring(n+1,r.length-1))?"#NUM!":Number(r.substring(n+1,r.length-1)):isNaN(r.substring(0,t))||isNaN(r.substring(t+1,r.length-1))?"#NUM!":-Number(r.substring(t+1,r.length-1)):"#NUM!":a?isNaN(r.substring(0,r.length-1))?"#NUM!":r.substring(0,r.length-1):isNaN(r)?"#NUM!":0},Formula.IMARGUMENT=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":0===n&&0===t?"#DIV/0!":0===n&&t>0?Math.PI/2:0===n&&0>t?-Math.PI/2:0===t&&n>0?0:0===t&&0>n?-Math.PI:n>0?Math.atan(t/n):0>n&&t>=0?Math.atan(t/n)+Math.PI:Math.atan(t/n)-Math.PI},Formula.IMCONJUGATE=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":0!==t?Formula.COMPLEX(n,-t,e):r},Formula.IMCOS=function(r){if(r===!0||r===!1)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.COMPLEX(Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,-Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2,e)},Formula.IMCOSH=function(r){if(r===!0||r===!1)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.COMPLEX(Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2,e)
},Formula.IMCOT=function(r){if(r===!0||r===!1)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.IMDIV(Formula.IMCOS(r),Formula.IMSIN(r))},Formula.IMCSC=function(r){if(r===!0||r===!1)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.IMDIV("1",Formula.IMSIN(r))},Formula.IMCSCH=function(r){if(r===!0||r===!1)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.IMDIV("1",Formula.IMSINH(r))},Formula.IMDIV=function(r,n){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),a=Formula.IMREAL(n),u=Formula.IMAGINARY(n),o=r.substring(r.length-1),i=r.substring(r.length-1),l="i";if("j"===o?l="j":"j"===i&&(l="j"),"#NUM!"===t||"#NUM!"===e||"#NUM!"===a||"#NUM!"===u)return"#NUM!";if(0===a&&0===u)return"#NUM!";var f=a*a+u*u;return Formula.COMPLEX((t*a+e*u)/f,(e*a-t*u)/f,l)},Formula.IMEXP=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);if(e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t)return"#NUM!";var a=Math.exp(n);return Formula.COMPLEX(a*Math.cos(t),a*Math.sin(t),e)},Formula.IMLN=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(n*n+t*t)),Math.atan(t/n),e)},Formula.IMLOG10=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(n*n+t*t))/Math.log(10),Math.atan(t/n)/Math.log(10),e)},Formula.IMLOG2=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(n*n+t*t))/Math.log(2),Math.atan(t/n)/Math.log(2),e)},Formula.IMPOWER=function(r,n){if(isNaN(n))return"#VALUE!";var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),a=r.substring(r.length-1);if(a="i"===a||"j"===a?a:"i","#NUM!"===t||"#NUM!"===e)return"#NUM!";var u=Math.pow(Formula.IMABS(r),n),o=Formula.IMARGUMENT(r);return Formula.COMPLEX(u*Math.cos(n*o),u*Math.sin(n*o),a)},Formula.IMPRODUCT=function(){for(var r=arguments[0],n=1;n<arguments.length;n++){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),a=Formula.IMREAL(arguments[n]),u=Formula.IMAGINARY(arguments[n]);if("#NUM!"===t||"#NUM!"===e||"#NUM!"===a||"#NUM!"===u)return"#NUM!";r=Formula.COMPLEX(t*a-e*u,t*u+e*a)}return r},Formula.IMREAL=function(r){if(0===r||"0"===r)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(r)>=0)return 0;var n=r.indexOf("+"),t=r.indexOf("-");0===n&&(n=r.indexOf("+",1)),0===t&&(t=r.indexOf("-",1));var e=r.substring(r.length-1,r.length),a="i"===e||"j"===e;return n>=0||t>=0?a?n>=0?isNaN(r.substring(0,n))||isNaN(r.substring(n+1,r.length-1))?"#NUM!":Number(r.substring(0,n)):isNaN(r.substring(0,t))||isNaN(r.substring(t+1,r.length-1))?"#NUM!":Number(r.substring(0,t)):"#NUM!":a?isNaN(r.substring(0,r.length-1))?"#NUM!":0:isNaN(r)?"#NUM!":r},Formula.IMSEC=function(r){if(r===!0||r===!1)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.IMDIV("1",Formula.IMCOS(r))},Formula.IMSECH=function(r){if(r===!0||r===!1)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.IMDIV("1",Formula.IMCOSH(r))},Formula.IMSIN=function(r){if(r===!0||r===!1)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.COMPLEX(Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2,Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,e)},Formula.IMSINH=function(r){if(r===!0||r===!1)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.COMPLEX(Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2,Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,e)},Formula.IMSQRT=function(r){var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r),e=r.substring(r.length-1);if(e="i"===e||"j"===e?e:"i","#NUM!"===n||"#NUM!"===t)return"#NUM!";var a=Math.sqrt(Formula.IMABS(r)),u=Formula.IMARGUMENT(r);return Formula.COMPLEX(a*Math.cos(u/2),a*Math.sin(u/2),e)},Formula.IMSUB=function(r,n){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),a=Formula.IMREAL(n),u=Formula.IMAGINARY(n),o=r.substring(r.length-1),i=r.substring(r.length-1),l="i";return"j"===o?l="j":"j"===i&&(l="j"),"#NUM!"===t||"#NUM!"===e||"#NUM!"===a||"#NUM!"===u?"#NUM!":Formula.COMPLEX(t-a,e-u,l)},Formula.IMSUM=function(){for(var r=arguments[0],n=1;n<arguments.length;n++){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),a=Formula.IMREAL(arguments[n]),u=Formula.IMAGINARY(arguments[n]);if("#NUM!"===t||"#NUM!"===e||"#NUM!"===a||"#NUM!"===u)return"#NUM!";r=Formula.COMPLEX(t+a,e+u)}return r},Formula.IMTAN=function(r){if(r===!0||r===!1)return"#VALUE!";var n=Formula.IMREAL(r),t=Formula.IMAGINARY(r);return"#NUM!"===n||"#NUM!"===t?"#NUM!":Formula.IMDIV(Formula.IMSIN(r),Formula.IMCOS(r))},Formula.OCT2BIN=function(r,n){if(!/^[0-7]{1,10}$/.test(r))return"#NUM!";var t=10===r.length&&"7"===r.substring(0,1)?!0:!1,e=t?parseInt(r,8)-1073741824:parseInt(r,8);if(-512>e||e>511)return"#NUM!";if(t)return"1"+_s.repeat("0",9-(512+e).toString(2).length)+(512+e).toString(2);var a=e.toString(2);return"undefined"==typeof n?a:isNaN(n)?"#VALUE!":0>n?"#NUM!":(n=Math.floor(n),n>=a.length?_s.repeat("0",n-a.length)+a:"#NUM!")},Formula.OCT2DEC=function(r){if(!/^[0-7]{1,10}$/.test(r))return"#NUM!";var n=parseInt(r,8);return n>=536870912?n-1073741824:n},Formula.OCT2HEX=function(r,n){if(!/^[0-7]{1,10}$/.test(r))return"#NUM!";var t=parseInt(r,8);if(t>=536870912)return"ff"+(t+3221225472).toString(16);var e=t.toString(16);return"undefined"==typeof n?e:isNaN(n)?"#VALUE!":0>n?"#NUM!":(n=Math.floor(n),n>=e.length?_s.repeat("0",n-e.length)+e:"#NUM!")},Formula.ACCRINT=function(r,n,t,e,a,u,o,i){if(!moment(r).isValid()||!moment(n).isValid()||!moment(t).isValid())return"#VALUE!";if(0>=e||0>=a)return"#NUM!";if(-1===[1,2,4].indexOf(u))return"#NUM!";if(-1===[0,1,2,3,4].indexOf(o))return"#NUM!";if(moment(r).diff(moment(t))>=0)return"#NUM!";a="undefined"==typeof a?0:a,o="undefined"==typeof o?0:o,i="undefined"==typeof i?!0:i;var l=0;switch(o){case 0:l=Formula.YEARFRAC(r,t,o);break;case 1:l=Formula.YEARFRAC(r,t,o);break;case 2:l=Formula.YEARFRAC(r,t,o);break;case 3:l=Formula.YEARFRAC(r,t,o);break;case 4:l=Formula.YEARFRAC(r,t,o)}return a*e*l},Formula.ACCRINTM=function(){},Formula.AMORDEGRC=function(){},Formula.AMORLINC=function(){},Formula.COUPDAYBS=function(){},Formula.COUPDAYS=function(){},Formula.COUPDAYSNC=function(){},Formula.COUPNCD=function(){},Formula.COUPNUM=function(){},Formula.COUPPCD=function(){},Formula.CUMIPMT=function(rate,periods,value,start,end,type){if(rate=eval(rate),periods=eval(periods),0>=rate||0>=periods||0>=value)return"#NUM!";if(1>start||1>end||start>end)return"#NUM!";if(0!==type&&1!==type)return"#NUM!";var payment=Formula.PMT(rate,periods,value,0,type),interest=0;1===start&&0===type&&(interest=-value,start++);for(var i=start;end>=i;i++)interest+=1===type?Formula.FV(rate,i-2,payment,value,1)-payment:Formula.FV(rate,i-1,payment,value,0);return interest*=rate},Formula.CUMPRINC=function(rate,periods,value,start,end,type){if(rate=eval(rate),periods=eval(periods),0>=rate||0>=periods||0>=value)return"#NUM!";if(1>start||1>end||start>end)return"#NUM!";if(0!==type&&1!==type)return"#NUM!";var payment=Formula.PMT(rate,periods,value,0,type),principal=0;1===start&&(principal=0===type?payment+value*rate:payment,start++);for(var i=start;end>=i;i++)principal+=type>0?payment-(Formula.FV(rate,i-2,payment,value,1)-payment)*rate:payment-Formula.FV(rate,i-1,payment,value,0)*rate;return principal},Formula.DB=function(r,n,t,e,a){if(a="undefined"==typeof a?12:a,isNaN(r)||isNaN(n)||isNaN(t)||isNaN(e)||isNaN(a))return"#VALUE!";if(0>r||0>n||0>t||0>e)return"#NUM!";if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(a))return"#NUM!";if(e>t)return"#NUM!";if(n>=r)return 0;for(var u=(1-Math.pow(n/r,1/t)).toFixed(3),o=r*u*a/12,i=o,l=0,f=e===t?t-1:e,c=2;f>=c;c++)l=(r-i)*u,i+=l;return 1===e?o:e===t?(r-i)*u:l},Formula.DDB=function(r,n,t,e,a){if(a="undefined"==typeof a?2:a,isNaN(r)||isNaN(n)||isNaN(t)||isNaN(e)||isNaN(a))return"#VALUE!";if(0>r||0>n||0>t||0>e||0>=a)return"#NUM!";if(e>t)return"#NUM!";if(n>=r)return 0;for(var u=0,o=0,i=1;e>=i;i++)o=Math.min((r-u)*(a/t),r-n-u),u+=o;return o},Formula.DISC=function(){},Formula.DOLLARDE=function(r,n){if(isNaN(r)||isNaN(n))return"#VALUE!";if(0>n)return"#NUM!";if(n>=0&&1>n)return"#DIV/0!";n=parseInt(n,10);var t=parseInt(r,10);t+=r%1*Math.pow(10,Math.ceil(Math.log(n)/Math.LN10))/n;var e=Math.pow(10,Math.ceil(Math.log(n)/Math.LN2)+1);return t=Math.round(t*e)/e},Formula.DOLLARFR=function(r,n){if(isNaN(r)||isNaN(n))return"#VALUE!";if(0>n)return"#NUM!";if(n>=0&&1>n)return"#DIV/0!";n=parseInt(n,10);var t=parseInt(r,10);return t+=r%1*Math.pow(10,-Math.ceil(Math.log(n)/Math.LN10))*n},Formula.DURATION=function(){},Formula.EFFECT=function(r,n){return isNaN(r)||isNaN(n)?"#VALUE!":0>=r||1>n?"#NUM!":(n=parseInt(n,10),Math.pow(1+r/n,n)-1)},Formula.FV=function(rate,periods,payment,value,type){type="undefined"==typeof type?0:type,rate=eval(rate);var result;if(0===rate)result=value+payment*periods;else{var term=Math.pow(1+rate,periods);result=1===type?value*term+payment*(1+rate)*(term-1)/rate:value*term+payment*(term-1)/rate}return-result},Formula.FVSCHEDULE=function(r,n){for(var t=r,e=0;e<n.length;e++){if(isNaN(n[e]))return"#VALUE!";t*=1+n[e]}return t},Formula.INTRATE=function(){},Formula.IPMT=function(rate,period,periods,present,future,type){type="undefined"==typeof type?0:type,rate=eval(rate),periods=eval(periods);var payment=Formula.PMT(rate,periods,present,future,type),interest;return interest=1===period?1===type?0:-present:1===type?Formula.FV(rate,period-2,payment,present,1)-payment:Formula.FV(rate,period-1,payment,present,0),interest*rate},Formula.IRR=function(r,n){r=Formula.FLATTEN(r);for(var t=function(r,n,t){for(var e=t+1,a=r[0],u=1;u<r.length;u++)a+=r[u]/Math.pow(e,(n[u]-n[0])/365);return a},e=function(r,n,t){for(var e=t+1,a=0,u=1;u<r.length;u++){var o=(n[u]-n[0])/365;a-=o*r[u]/Math.pow(e,o+1)}return a},a=[],u=!1,o=!1,i=0;i<r.length;i++)a[i]=0===i?0:a[i-1]+365,r[i]>0&&(u=!0),r[i]<0&&(o=!0);if(!u||!o)return"#NUM!";n="undefined"==typeof n?.1:n;var l,f,c,s=n,m=1e-10,p=50,h=0,g=!0;do c=t(r,a,s),l=s-c/e(r,a,s),f=Math.abs(l-s),s=l,g=f>m&&Math.abs(c)>m;while(g&&++h<p);return g?"#NUM!":s},Formula.ISPMT=function(rate,period,periods,value){return rate=eval(rate),periods=eval(periods),value*rate*(period/periods-1)},Formula.MDURATION=function(){},Formula.MIRR=function(r,n,t){for(var e=r.length,a=[],u=[],o=0;e>o;o++)r[o]<0?a.push(r[o]):u.push(r[o]);var i=-Formula.NPV(t,u)*Math.pow(1+t,e-1),l=Formula.NPV(n,a)*(1+n);return Math.pow(i/l,1/(e-1))-1},Formula.NOMINAL=function(r,n){return isNaN(r)||isNaN(n)?"#VALUE!":0>=r||1>n?"#NUM!":(n=parseInt(n,10),(Math.pow(r+1,1/n)-1)*n)},Formula.NPER=function(rate,payment,present,future,type){type="undefined"==typeof type?0:type,future="undefined"==typeof future?0:future,rate=eval(rate);var num=payment*(1+rate*type)-future*rate,den=present*rate+payment*(1+rate*type);return Math.log(num/den)/Math.log(1+rate)},Formula.NPV=function(){for(var r=[],n=0;n<arguments.length;n++)r=r.concat(arguments[n]);for(var t=r[0],e=0,a=1;a<r.length;a++)e+=r[a]/Math.pow(1+t,a);return e},Formula.ODDFPRICE=function(){},Formula.ODDFYIELD=function(){},Formula.ODDLPRICE=function(){},Formula.ODDLYIELD=function(){},Formula.PDURATION=function(r,n,t){return isNaN(r)||isNaN(n)||isNaN(t)?"#VALUE!":0>=r?"#NUM!":(Math.log(t)-Math.log(n))/Math.log(1+r)},Formula.PMT=function(rate,periods,present,future,type){type="undefined"==typeof type?0:type,future=future||0,rate=eval(rate),periods=eval(periods);var result;if(0===rate)result=(present+future)/periods;else{var term=Math.pow(1+rate,periods);result=1===type?(future*rate/(term-1)+present*rate/(1-1/term))/(1+rate):future*rate/(term-1)+present*rate/(1-1/term)}return-result},Formula.PPMT=function(r,n,t,e,a,u){return Formula.PMT(r,t,e,a,u)-Formula.IPMT(r,n,t,e,a,u)},Formula.PRICE=function(){},Formula.PRICEDISC=function(){},Formula.PRICEMAT=function(){},Formula.PV=function(rate,periods,payment,future,type){return type="undefined"==typeof type?0:type,rate=eval(rate),periods=eval(periods),0===rate?-payment*periods-future:((1-Math.pow(1+rate,periods))/rate*payment*(1+rate*type)-future)/Math.pow(1+rate,periods)},Formula.RATE=function(periods,payment,present,future,type,guess){guess="undefined"==typeof guess?.01:guess,future="undefined"==typeof future?0:future,type="undefined"==typeof type?0:type,periods=eval(periods);var epsMax=1e-10,iterMax=50,y,y0,y1,x0,x1=0,f=0,i=0,rate=guess;for(Math.abs(rate)<epsMax?y=present*(1+periods*rate)+payment*(1+rate*type)*periods+future:(f=Math.exp(periods*Math.log(1+rate)),y=present*f+payment*(1/rate+type)*(f-1)+future),y0=present+payment*periods+future,y1=present*f+payment*(1/rate+type)*(f-1)+future,i=x0=0,x1=rate;Math.abs(y0-y1)>epsMax&&iterMax>i;)rate=(y1*x0-y0*x1)/(y1-y0),x0=x1,x1=rate,Math.abs(rate)<epsMax?y=present*(1+periods*rate)+payment*(1+rate*type)*periods+future:(f=Math.exp(periods*Math.log(1+rate)),y=present*f+payment*(1/rate+type)*(f-1)+future),y0=y1,y1=y,++i;return rate},Formula.RECEIVED=function(){},Formula.RRI=function(r,n,t){return isNaN(r)||isNaN(n)||isNaN(t)?"#VALUE!":0===r||0===n?"#NUM!":Math.pow(t/n,1/r)-1},Formula.SLN=function(r,n,t){return isNaN(r)||isNaN(n)||isNaN(t)?"#VALUE!":0===t?"#NUM!":(r-n)/t},Formula.SYD=function(r,n,t,e){return isNaN(r)||isNaN(n)||isNaN(t)||isNaN(e)?"#VALUE!":0===t?"#NUM!":1>e||e>t?"#NUM!":(e=parseInt(e,10),(r-n)*(t-e+1)*2/(t*(t+1)))},Formula.TBILLEQ=function(r,n,t){return moment(r).isValid()&&moment(n).isValid()?0>=t?"#NUM!":moment(r).diff(moment(n))>0?"#NUM!":moment(n).diff(moment(r),"years")>1?"#NUM!":365*t/(360-t*Formula.DAYS360(r,n)):"#VALUE!"},Formula.TBILLPRICE=function(r,n,t){return moment(r).isValid()&&moment(n).isValid()?0>=t?"#NUM!":moment(r).diff(moment(n))>0?"#NUM!":moment(n).diff(moment(r),"years")>1?"#NUM!":100*(1-t*Formula.DAYS360(r,n)/360):"#VALUE!"},Formula.TBILLYIELD=function(r,n,t){return moment(r).isValid()&&moment(n).isValid()?0>=t?"#NUM!":moment(r).diff(moment(n))>0?"#NUM!":moment(n).diff(moment(r),"years")>1?"#NUM!":360*(100-t)/(t*Formula.DAYS360(r,n)):"#VALUE!"},Formula.VDB=function(){},Formula.XIRR=function(r,n,t){for(var e=function(r,n,t){for(var e=t+1,a=r[0],u=1;u<r.length;u++)a+=r[u]/Math.pow(e,moment(n[u]).diff(moment(n[0]),"days")/365);return a},a=function(r,n,t){for(var e=t+1,a=0,u=1;u<r.length;u++){var o=moment(n[u]).diff(moment(n[0]),"days")/365;a-=o*r[u]/Math.pow(e,o+1)}return a},u=!1,o=!1,i=0;i<r.length;i++)r[i]>0&&(u=!0),r[i]<0&&(o=!0);if(!u||!o)return"#NUM!";t=t||.1;var l,f,c,s=t,m=1e-10,p=50,h=0,g=!0;do c=e(r,n,s),l=s-c/a(r,n,s),f=Math.abs(l-s),s=l,g=f>m&&Math.abs(c)>m;while(g&&++h<p);return g?"#NUM!":s},Formula.XNPV=function(r,n,t){for(var e=0,a=0;a<n.length;a++)e+=n[a]/Math.pow(1+r,moment(t[a]).diff(moment(t[0]),"days")/365);return e},Formula.YIELD=function(){},Formula.YIELDDISC=function(){},Formula.YIELDMAT=function(){},Formula.ISNUMBER=function(r){return!isNaN(parseFloat(r))&&isFinite(r)?!0:!1},Formula.AND=function(){for(var r=!0,n=0;n<arguments.length;n++)arguments[n]||(r=!1);return r},Formula.FALSE=function(){return!1},Formula.SWITCH=function(){var r;if(arguments.length>0){var n=arguments[0],t=arguments.length-1,e=Math.floor(t/2),a=!1,u=t%2===0?null:arguments[arguments.length-1];if(e)for(var o=0;e>o;o++)if(n===arguments[2*o+1]){r=arguments[2*o+2],a=!0;break}!a&&u&&(r=u)}return r},Formula.IF=function(r,n,t){return r?n:t},Formula.IFNA=function(r,n){return"#N/A"===r?n:r},Formula.NOT=function(r){return!r},Formula.OR=function(){for(var r=!1,n=0;n<arguments.length;n++)arguments[n]&&(r=!0);return r},Formula.TRUE=function(){return!0},Formula.XOR=function(){for(var r=0,n=0;n<arguments.length;n++)arguments[n]&&r++;return 1&Math.floor(Math.abs(r))?!0:!1},Formula.REFERENCE=function(r,n){try{var t=n.split("."),e=r;return _(t).forEach(function(r){if("]"===r[r.length-1]){var n=r.indexOf("["),t=r.substring(n+1,r.length-1);e=e[r.substring(0,n)][t]}else e=e[r]}),e}catch(a){return}},Formula.ABS=function(r){return Math.abs(r)},Formula.ACOS=function(r){return Math.acos(r)},Formula.ACOSH=function(r){return Math.log(r+Math.sqrt(r*r-1))},Formula.ACOT=function(r){return Math.atan(1/r)},Formula.ACOTH=function(r){return.5*Math.log((r+1)/(r-1))},Formula.AGGREGATE=function(r){for(var n=[],t=2;t<arguments.length;t++)switch(r){case 1:n[t-2]=Formula.AVERAGE(arguments[t]);break;case 2:n[t-2]=Formula.COUNT(arguments[t]);break;case 3:n[t-2]=Formula.COUNTA(arguments[t]);break;case 4:n[t-2]=Formula.MAX(arguments[t]);break;case 5:n[t-2]=Formula.MIN(arguments[t]);break;case 6:n[t-2]=Formula.PRODUCT(arguments[t]);break;case 7:n[t-2]=Formula.STDEVS(arguments[t]);break;case 8:n[t-2]=Formula.STDEVP(arguments[t]);break;case 9:n[t-2]=Formula.SUM(arguments[t]);break;case 10:n[t-2]=Formula.VARS(arguments[t]);break;case 11:n[t-2]=Formula.VARP(arguments[t]);break;case 12:n[t-2]=Formula.MEDIAN(arguments[t]);break;case 13:n[t-2]=Formula.MODESNGL(arguments[t]);break;case 14:n[t-2]=Formula.LARGE(arguments[t]);break;case 15:n[t-2]=Formula.SMALL(arguments[t]);break;case 16:n[t-2]=Formula.PERCENTILEINC(arguments[t]);break;case 17:n[t-2]=Formula.QUARTILEINC(arguments[t]);break;case 18:n[t-2]=Formula.PERCENTILEEXC(arguments[t]);break;case 19:n[t-2]=Formula.QUARTILEEXC(arguments[t])}return n},Formula.ARABIC=function(r){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(r))throw new Error("Incorrect roman number");var n=0;return r.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(r){n+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[r]}),n},Formula.ASIN=function(r){return Math.asin(r)},Formula.ASINH=function(r){return Math.log(r+Math.sqrt(r*r+1))},Formula.ATAN=function(r){return Math.atan(r)},Formula.ATAN2=function(r,n){return Math.atan2(r,n)},Formula.ATANH=function(r){return Math.log((1+r)/(1-r))/2},Formula.BASE=function(r,n,t){t="undefined"==typeof t?0:t;var e=r.toString(n);return new Array(Math.max(t+1-e.length,0)).join("0")+e},Formula.CEILING=function(r,n,t){if(0===n)return 0;n="undefined"==typeof n?1:Math.abs(n),t="undefined"==typeof t?0:t;var e=-Math.floor(Math.log(n)/Math.log(10));return r>=0?Formula.ROUND(Math.ceil(r/n)*n,e):0===t?-Formula.ROUND(Math.floor(Math.abs(r)/n)*n,e):-Formula.ROUND(Math.ceil(Math.abs(r)/n)*n,e)},Formula.CEILINGMATH=Formula.CEILING,Formula.CEILINGPRECISE=Formula.CEILING,Formula.COMBIN=function(r,n){return Formula.FACT(r)/(Formula.FACT(n)*Formula.FACT(r-n))},Formula.COMBINA=function(r,n){return 0===r&&0===n?1:Formula.COMBIN(r+n-1,r-1)},Formula.COS=Math.cos,Formula.COSH=function(r){return(Math.exp(r)+Math.exp(-r))/2},Formula.COT=function(r){return 1/Math.tan(r)},Formula.COTH=function(r){var n=Math.exp(2*r);return(n+1)/(n-1)},Formula.CSC=function(r){return 1/Math.sin(r)},Formula.CSCH=function(r){return 2/(Math.exp(r)-Math.exp(-r))},Formula.DECIMAL=function(r,n){return parseInt(r,n)},Formula.DEGREES=function(r){return 180*r/Math.PI},Formula.EVEN=function(r){return Formula.CEILING(r,-2,-1)},Formula.EXP=Math.exp,Formula.FACT=function(r){var n=Math.floor(r);return 0===n||1===n?1:MEMOIZED_FACT[n]>0?MEMOIZED_FACT[n]:(MEMOIZED_FACT[n]=Formula.FACT(n-1)*n,MEMOIZED_FACT[n])},Formula.FACTDOUBLE=function(r){var n=Math.floor(r);return 0>=n?1:n*Formula.FACTDOUBLE(n-2)},Formula.FLOOR=function(r,n,t){if(0===n)return 0;n=n?Math.abs(n):1;var e=-Math.floor(Math.log(n)/Math.log(10));return r>=0?Formula.ROUND(Math.floor(r/n)*n,e):0===t||"undefined"==typeof t?-Formula.ROUND(Math.ceil(Math.abs(r)/n)*n,e):-Formula.ROUND(Math.floor(Math.abs(r)/n)*n,e)},Formula.FLOORMATH=Formula.FLOOR,Formula.FLOORPRECISE=function(r,n){if(0===n)return 0;n=n?Math.abs(n):1;var t=-Math.floor(Math.log(n)/Math.log(10));return r>=0?Formula.ROUND(Math.round(r/n)*n,t):-Formula.ROUND(Math.ceil(Math.abs(r)/n)*n,t)},Formula.GCD=function(){for(var r,n,t=arguments.length-1,e=arguments[t];t;)for(n=arguments[--t];r=n%e;n=e,e=r);return e},Formula.INT=function(r){return Math.floor(r)},Formula.ISEVEN=function(r){return 1&Math.floor(Math.abs(r))?!1:!0},Formula.ISOCEILING=Formula.CEILING,Formula.ISODD=function(r){return 1&Math.floor(Math.abs(r))?!0:!1},Formula.LCM=function(){for(var r,n,t,e,a=Formula.ARGSTOARRAY(arguments),u=1;void 0!==(t=a.pop());)for(;t>1;){if(t%2){for(r=3,n=Math.floor(Math.sqrt(t));n>=r&&t%r;r+=2);e=n>=r?r:t}else e=2;for(t/=e,u*=e,r=a.length;r;a[--r]%e===0&&1===(a[r]/=e)&&a.splice(r,1));}return u},Formula.LN=function(r){return Math.log(r)},Formula.LOG=function(r,n){return n="undefined"==typeof n?10:n,Math.log(r)/Math.log(n)},Formula.LOG10=function(r){return Math.log(r)/Math.log(10)},Formula.MOD=function(r,n){var t=Math.abs(r%n);return n>0?t:-t},Formula.MROUND=function(r,n){if(0>r*n)throw new Error("Number and multiple must have the same sign.");return Math.round(r/n)*n},Formula.MULTINOMIAL=function(){for(var r=0,n=1,t=0;t<arguments.length;t++)r+=arguments[t],n*=Formula.FACT(arguments[t]);return Formula.FACT(r)/n},Formula.ODD=function(r){var n=Math.ceil(Math.abs(r));return n=1&n?n:n+1,r>0?n:-n},Formula.E=function(){return Math.E},Formula.PI=function(){return Math.PI},Formula.POWER=function(r,n){var t=Math.pow(r,n);return isNaN(t)?"#NUM!":t},Formula.PRODUCT=function(){for(var r=1,n=0;n<arguments.length;n++)r*=arguments[n];return r},Formula.QUOTIENT=function(r,n){return(r/n).toFixed(0)},Formula.RADIANS=function(r){return r*Math.PI/180},Formula.RAND=function(){return Math.random()},Formula.RANDBETWEEN=function(r,n){return r+Math.ceil((n-r+1)*Math.random())-1},Formula.ROUND=function(r,n){return Math.round(r*Math.pow(10,n))/Math.pow(10,n)},Formula.ROUNDDOWN=function(r,n){var t=r>0?1:-1;return t*Math.floor(Math.abs(r)*Math.pow(10,n))/Math.pow(10,n)},Formula.ROUNDUP=function(r,n){var t=r>0?1:-1;return t*Math.ceil(Math.abs(r)*Math.pow(10,n))/Math.pow(10,n)},Formula.SERIESSUM=function(r,n,t,e){for(var a=e[0]*Math.pow(r,n),u=1;u<e.length;u++)a+=e[u]*Math.pow(r,n+u*t);return a},Formula.SEC=function(r){return 1/Math.cos(r)},Formula.SECH=function(r){return 2/(Math.exp(r)+Math.exp(-r))},Formula.SIGN=function(r){return 0>r?-1:0===r?0:1},Formula.SIN=Math.sin,Formula.SINH=function(r){return(Math.exp(r)-Math.exp(-r))/2},Formula.SQRT=Math.sqrt,Formula.SQRTPI=function(r){return Math.sqrt(r*Math.PI)},Formula.SUBTOTAL=function(r){for(var n=[],t=1;t<arguments.length;t++)switch(r){case 1:n[t-1]=Formula.AVERAGE(arguments[t]);break;case 2:n[t-1]=Formula.COUNT(arguments[t]);break;case 3:n[t-1]=Formula.COUNTA(arguments[t]);break;case 4:n[t-1]=Formula.MAX(arguments[t]);break;case 5:n[t-1]=Formula.MIN(arguments[t]);break;case 6:n[t-1]=Formula.PRODUCT(arguments[t]);break;case 7:n[t-1]=Formula.STDEV(arguments[t]);break;case 8:n[t-1]=Formula.STDEVP(arguments[t]);break;case 9:n[t-1]=Formula.SUM(arguments[t]);break;case 10:n[t-1]=Formula.VAR(arguments[t]);break;case 11:n[t-1]=Formula.VARP(arguments[t])}return n},Formula.SUM=function(){for(var r=Formula.FLATTEN(arguments),n=0,t=0;t<r.length;t++)if(r[t]instanceof Array)for(var e=0;e<r[t].length;e++)n+=Formula.ISNUMBER(r[t][e])?r[t][e]:0;else n+=Formula.ISNUMBER(r[t])?r[t]:0;return n},Formula.SUMIF=function(range,criteria){range=Formula.FLATTEN(range);for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},Formula.SUMIFS=function(){for(var criteria=(arguments.length-1)/2,range=arguments[0],result=0,i=0;i<range.length;i++){for(var fit=!0,j=0;criteria>j;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);result+=fit?range[i]:0}return result},Formula.SUMPRODUCT=function(){for(var r=arguments.length+1,n=0,t=0;t<arguments[0].length;t++)for(var e=0;e<arguments[0][t].length;e++){for(var a=1,u=1;r>u;u++)a*=arguments[u-1][t][e];n+=a}return n},Formula.SUMSQ=function(){for(var r=Formula.FLATTEN(arguments),n=0,t=0;t<r.length;t++)n+=Formula.ISNUMBER(r[t])?r[t]*r[t]:0;return n},Formula.SUMX2MY2=function(r,n){var t=0;r=Formula.FLATTEN(r),n=Formula.FLATTEN(n);for(var e=0;e<r.length;e++)t+=r[e]*r[e]-n[e]*n[e];return t},Formula.SUMX2PY2=function(r,n){var t=0;r=Formula.FLATTEN(r),n=Formula.FLATTEN(n);for(var e=0;e<r.length;e++)t+=r[e]*r[e]+n[e]*n[e];return t},Formula.SUMXMY2=function(r,n){var t=0;r=Formula.FLATTEN(r),n=Formula.FLATTEN(n);for(var e=0;e<r.length;e++)t+=Math.pow(r[e]-n[e],2);return t},Formula.TAN=function(r){return Math.tan(r)},Formula.TANH=function(r){var n=Math.exp(2*r);return(n-1)/(n+1)},Formula.TRUNC=function(r,n){n="undefined"==typeof n?0:n;var t=r>0?1:-1;return t*Math.floor(Math.abs(r)*Math.pow(10,n))/Math.pow(10,n)},Formula.AVEDEV=function(){var r=Formula.FLATTEN(arguments);return jStat.sum(jStat(r).subtract(jStat.mean(r)).abs()[0])/r.length},Formula.AVERAGE=function(){for(var r=Formula.NUMBERS(Formula.FLATTEN(arguments)),n=r.length,t=0,e=0,a=0;n>a;a++)t+=r[a],e+=1;return t/e},Formula.AVERAGEA=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=0,e=0,a=0;n>a;a++){var u=r[a];"number"==typeof u&&(t+=u),u===!0&&t++,null!==u&&e++}return t/e},Formula.AVERAGEIF=function(range,criteria,average_range){average_range=average_range||range,range=Formula.FLATTEN(range),average_range=Formula.FLATTEN(average_range);for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},Formula.AVERAGEIFS=function(){for(var args=Formula.ARGSTOARRAY(arguments),criteria=(args.length-1)/2,range=Formula.FLATTEN(args[0]),count=0,result=0,i=0;i<range.length;i++){for(var condition="",j=0;criteria>j;j++)condition+=args[2*j+1][i]+args[2*j+2],j!==criteria-1&&(condition+="&&");eval(condition)&&(result+=range[i],count++)}var average=result/count;return isNaN(average)?0:average},Formula.BETADIST=function(r,n,t,e,a,u){return a="undefined"==typeof a?0:a,u="undefined"==typeof u?1:u,r=(r-a)/(u-a),e?jStat.beta.cdf(r,n,t):jStat.beta.pdf(r,n,t)},Formula.BETAINV=function(r,n,t,e,a){return e="undefined"==typeof e?0:e,a="undefined"==typeof a?1:a,jStat.beta.inv(r,n,t)*(a-e)+e},Formula.BINOMDIST=function(r,n,t,e){return e?jStat.binomial.cdf(r,n,t):jStat.binomial.pdf(r,n,t)},Formula.BINOMDISTRANGE=function(r,n,t,e){e="undefined"==typeof e?t:e;for(var a=0,u=t;e>=u;u++)a+=Formula.COMBIN(r,u)*Math.pow(n,u)*Math.pow(1-n,r-u);return a},Formula.BINOMINV=function(r,n,t){for(var e=0;r>=e;){if(jStat.binomial.cdf(e,r,n)>=t)return e;e++}},Formula.CHISQDIST=function(r,n,t){return t?jStat.chisquare.cdf(r,n):jStat.chisquare.pdf(r,n)},Formula.CHISQDISTRT=function(){},Formula.CHISQINV=function(r,n){return jStat.chisquare.inv(r,n)},Formula.CHISQINVRT=function(){},Formula.CHISQTEST=function(){},Formula.CONFIDENCENORM=function(r,n,t){return jStat.normalci(1,r,n,t)[1]-1},Formula.CONFIDENCET=function(r,n,t){return jStat.tci(1,r,n,t)[1]-1},Formula.CORREL=function(){return jStat.corrcoeff.apply(this,arguments)},Formula.COUNT=function(){var r=Formula.NUMBERS(Formula.FLATTEN(arguments));return r.length},Formula.COUNTA=function(){var r=Formula.FLATTEN(arguments);return r.length-Formula.COUNTBLANK(r)},Formula.COUNTBLANK=function(){for(var r,n=Formula.FLATTEN(arguments),t=0,e=0;e<n.length;e++)r=n[e],null!==r&&""!==r&&r||t++;return t},Formula.COUNTIF=function(r,n){r=Formula.FLATTEN(r);for(var t=0,e=0;e<r.length;e++)r[e].match(new RegExp(n))&&t++;return t},Formula.COUNTIFS=function(){for(var criteria=(arguments.length-1)/2,range=arguments[0],result=0,i=0;i<range.length;i++){for(var fit=!0,j=0;criteria>j;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);result+=fit?1:0}return result},Formula.COUNTUNIQUE=function(){return _.uniq(Formula.FLATTEN(arguments)).length},Formula.COVARIANCEP=function(r,n){r=Formula.FLATTEN(r),n=Formula.FLATTEN(n);for(var t=jStat.mean(r),e=jStat.mean(n),a=0,u=r.length,o=0;u>o;o++)a+=(r[o]-t)*(n[o]-e);return a/u},Formula.COVARIANCES=function(){return jStat.covariance.apply(this,simplifyArguments(arguments))},Formula.DEVSQ=function(){for(var r=Formula.ARGSCONCAT(arguments),n=jStat.mean(r),t=0,e=0;e<r.length;e++)t+=Math.pow(r[e]-n,2);return t},Formula.EXPONDIST=function(r,n,t){return t?jStat.exponential.cdf(r,n):jStat.exponential.pdf(r,n)},Formula.FDIST=function(r,n,t,e){return e?jStat.centralF.cdf(r,n,t):jStat.centralF.pdf(r,n,t)},Formula.FDISTRT=function(){},Formula.FINV=function(r,n,t){return 0>=r||r>1?"#NUM!":jStat.centralF.inv(1-r,n,t)},Formula.FINVRT=function(){},Formula.FTEST=function(){},Formula.FISHER=function(r){return Math.log((1+r)/(1-r))/2},Formula.FISHERINV=function(r){var n=Math.exp(2*r);return(n-1)/(n+1)},Formula.FORECAST=function(r,n,t){t=Formula.FLATTEN(t),n=Formula.FLATTEN(n);for(var e=jStat.mean(t),a=jStat.mean(n),u=t.length,o=0,i=0,l=0;u>l;l++)o+=(t[l]-e)*(n[l]-a),i+=Math.pow(t[l]-e,2);var f=o/i,c=a-f*e;return c+f*r},Formula.FREQUENCY=function(r,n){for(var t=r.length,e=n.length,a=[],u=0;e>=u;u++){a[u]=0;for(var o=0;t>o;o++)0===u?r[o]<=n[0]&&(a[0]+=1):e>u?r[o]>n[u-1]&&r[o]<=n[u]&&(a[u]+=1):u===e&&r[o]>n[e-1]&&(a[e]+=1)}return a},Formula.GAMMA=function(){return jStat.gammafn.apply(this,arguments)},Formula.GAMMADIST=function(){},Formula.GAMMAINV=function(){},Formula.GAMMALN=function(){return jStat.gammaln.apply(this,arguments)},Formula.GAMMALNPRECISE=function(){},Formula.GAUSS=function(r){return jStat.normal.cdf(r,0,1)-.5},Formula.GEOMEAN=function(){return jStat.geomean(Formula.ARGSCONCAT(arguments))},Formula.GROWTH=function(r,n,t,e){var a;if("undefined"==typeof n)for(n=[],a=1;a<=r.length;a++)n.push(a);if("undefined"==typeof t)for(t=[],a=1;a<=r.length;a++)t.push(a);"undefined"==typeof e&&(e=!0);var u=r.length,o=0,i=0,l=0,f=0;for(a=0;u>a;a++){var c=n[a],s=Math.log(r[a]);o+=c,i+=s,l+=c*s,f+=c*c}o/=u,i/=u,l/=u,f/=u;var m,p;e?(m=(l-o*i)/(f-o*o),p=i-m*o):(m=l/f,p=0);var h=[];for(a=0;a<t.length;a++)h.push(Math.exp(p+m*t[a]));return h},Formula.HARMEAN=function(){for(var r=Formula.ARGSCONCAT(arguments),n=r.length,t=0,e=0;n>e;e++)t+=1/r[e];return n/t},Formula.HYPGEOMDIST=function(r,n,t,e,a){function u(r,n,t,e){return Formula.COMBIN(t,r)*Formula.COMBIN(e-t,n-r)/Formula.COMBIN(e,n)}function o(r,n,t,e){for(var a=0,o=0;r>=o;o++)a+=u(o,n,t,e);return a}return a?o(r,n,t,e):u(r,n,t,e)},Formula.INTERCEPT=function(r,n){return Formula.FORECAST(0,r,n)},Formula.KURT=function(){for(var r=Formula.ARGSCONCAT(arguments),n=jStat.mean(r),t=r.length,e=0,a=0;t>a;a++)e+=Math.pow(r[a]-n,4);return e/=Math.pow(jStat.stdev(r,!0),4),t*(t+1)/((t-1)*(t-2)*(t-3))*e-3*(t-1)*(t-1)/((t-2)*(t-3))},Formula.LARGE=function(r,n){return r.sort(function(r,n){return n-r})[n-1]},Formula.LINEST=function(r,n){for(var t=jStat.mean(n),e=jStat.mean(r),a=n.length,u=0,o=0,i=0;a>i;i++)u+=(n[i]-t)*(r[i]-e),o+=Math.pow(n[i]-t,2);var l=u/o,f=e-l*t;return[l,f]},Formula.LOGEST=function(){},Formula.LOGNORMDIST=function(r,n,t,e){return e?jStat.lognormal.cdf(r,n,t):jStat.lognormal.pdf(r,n,t)},Formula.LOGNORMINV=function(r,n,t){return jStat.lognormal.inv(r,n,t)},Formula.MAX=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=n>0?r[0]:0,e=0;n>e;e++)t=r[e]>t&&r[e]!==!0&&r[e]!==!1?r[e]:t;return t},Formula.MAXA=function(){var r=Formula.FLATTEN(arguments);return r.length>0?Math.max.apply(Math,r):0},Formula.MEDIAN=function(){return jStat.median(Formula.FLATTEN(arguments))},Formula.MIN=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=n>0?r[0]:0,e=0;n>e;e++)t=r[e]<t&&r[e]!==!0&&r[e]!==!1?r[e]:t;return t},Formula.MINA=function(){var r=Formula.FLATTEN(arguments);return r.length>0?Math.min.apply(Math,r):0},Formula.MODEMULT=function(){for(var r,n=Formula.ARGSCONCAT(arguments),t=n.length,e={},a=[],u=0,o=0;t>o;o++)r=n[o],e[r]=e[r]?e[r]+1:1,e[r]>u&&(u=e[r],a=[]),e[r]===u&&(a[a.length]=r);return a},Formula.MODESNGL=function(){return Formula.MODEMULT(Formula.ARGSCONCAT(arguments)).sort(function(r,n){return r-n})[0]},Formula.NEGBINOMDIST=function(r,n,t,e){return e?jStat.negbin.cdf(r,n,t):jStat.negbin.pdf(r,n,t)
},Formula.NORMDIST=function(r,n,t,e){return isNaN(r)||isNaN(n)||isNaN(t)?"#VALUE!":0>=t?"#NUM!":e?jStat.normal.cdf(r,n,t):jStat.normal.pdf(r,n,t)},Formula.NORMINV=function(r,n,t){return jStat.normal.inv(r,n,t)},Formula.NORMSDIST=function(r,n){return n?jStat.normal.cdf(r,0,1):jStat.normal.pdf(r,0,1)},Formula.NORMSINV=function(r){return jStat.normal.inv(r,0,1)},Formula.PEARSON=function(r,n){for(var t=jStat.mean(r),e=jStat.mean(n),a=r.length,u=0,o=0,i=0,l=0;a>l;l++)u+=(r[l]-t)*(n[l]-e),o+=Math.pow(r[l]-t,2),i+=Math.pow(n[l]-e,2);return u/Math.sqrt(o*i)},Formula.PERCENTILEEXC=function(r,n){r=r.sort(function(r,n){return r-n});var t=r.length;if(1/(t+1)>n||n>1-1/(t+1))return"#NUM!";var e=n*(t+1)-1,a=Math.floor(e);return Formula.CLEANFLOAT(e===a?r[e]:r[a]+(e-a)*(r[a+1]-r[a]))},Formula.PERCENTILEINC=function(r,n){r=r.sort(function(r,n){return r-n});var t=r.length,e=n*(t-1),a=Math.floor(e);return Formula.CLEANFLOAT(e===a?r[e]:r[a]+(e-a)*(r[a+1]-r[a]))},Formula.PERCENTRANKEXC=function(r,n,t){r=r.sort(function(r,n){return r-n});var e=_.uniq(r),a=r.length,u=e.length;t="undefined"==typeof t?3:t;for(var o=Math.pow(10,t),i=0,l=!1,f=0;!l&&u>f;)n===e[f]?(i=(r.indexOf(e[f])+1)/(a+1),l=!0):n>=e[f]&&(n<e[f+1]||f===u-1)&&(i=(r.indexOf(e[f])+1+(n-e[f])/(e[f+1]-e[f]))/(a+1),l=!0),f++;return Math.floor(i*o)/o},Formula.PERCENTRANKINC=function(r,n,t){r=r.sort(function(r,n){return r-n});var e=_.uniq(r),a=r.length,u=e.length;t="undefined"==typeof t?3:t;for(var o=Math.pow(10,t),i=0,l=!1,f=0;!l&&u>f;)n===e[f]?(i=r.indexOf(e[f])/(a-1),l=!0):n>=e[f]&&(n<e[f+1]||f===u-1)&&(i=(r.indexOf(e[f])+(n-e[f])/(e[f+1]-e[f]))/(a-1),l=!0),f++;return Math.floor(i*o)/o},Formula.PERMUT=function(r,n){return Formula.FACT(r)/Formula.FACT(r-n)},Formula.PERMUTATIONA=function(r,n){return Math.pow(r,n)},Formula.PHI=function(r){return Math.exp(-.5*r*r)/SQRT2PI},Formula.POISSONDIST=function(r,n,t){return t?jStat.poisson.cdf(r,n):jStat.poisson.pdf(r,n)},Formula.PROB=function(r,n,t,e){if("undefined"==typeof t)return 0;if(e="undefined"==typeof e?t:e,t===e)return r.indexOf(t)>=0?n[r.indexOf(t)]:0;for(var a=r.sort(function(r,n){return r-n}),u=a.length,o=0,i=0;u>i;i++)a[i]>=t&&a[i]<=e&&(o+=n[r.indexOf(a[i])]);return o},Formula.QUARTILEEXC=function(r,n){switch(n){case 1:return Formula.PERCENTILEEXC(r,.25);case 2:return Formula.PERCENTILEEXC(r,.5);case 3:return Formula.PERCENTILEEXC(r,.75);default:return"#NUM!"}},Formula.QUARTILEINC=function(r,n){switch(n){case 1:return Formula.PERCENTILEINC(r,.25);case 2:return Formula.PERCENTILEINC(r,.5);case 3:return Formula.PERCENTILEINC(r,.75);default:return"#NUM!"}},Formula.RANKAVG=function(r,n,t){t="undefined"==typeof t?!1:t;var e=t?function(r,n){return r-n}:function(r,n){return n-r};n=n.sort(e);var a=Formula.COUNTIN(n,r);return a>1?(2*n.indexOf(r)+a+1)/2:n.indexOf(r)+1},Formula.RANKEQ=function(r,n,t){t="undefined"==typeof t?!1:t;var e=t?function(r,n){return r-n}:function(r,n){return n-r};return n=n.sort(e),n.indexOf(r)+1},Formula.RSQ=function(r,n){return Math.pow(Formula.PEARSON(r,n),2)},Formula.SKEW=function(){for(var r=Formula.ARGSCONCAT(arguments),n=jStat.mean(r),t=r.length,e=0,a=0;t>a;a++)e+=Math.pow(r[a]-n,3);return t*e/((t-1)*(t-2)*Math.pow(jStat.stdev(r,!0),3))},Formula.SKEWP=function(){for(var r=Formula.ARGSCONCAT(arguments),n=jStat.mean(r),t=r.length,e=0,a=0,u=0;t>u;u++)a+=Math.pow(r[u]-n,3),e+=Math.pow(r[u]-n,2);return a/=t,e/=t,a/Math.pow(e,1.5)},Formula.SLOPE=function(r,n){for(var t=jStat.mean(n),e=jStat.mean(r),a=n.length,u=0,o=0,i=0;a>i;i++)u+=(n[i]-t)*(r[i]-e),o+=Math.pow(n[i]-t,2);return u/o},Formula.SMALL=function(r,n){return r.sort(function(r,n){return r-n})[n-1]},Formula.STANDARDIZE=function(r,n,t){return(r-n)/t},Formula.STDEVA=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=0,e=jStat.mean(r),a=0;n>a;a++)t+=Math.pow(r[a]-e,2);return Math.sqrt(t/(n-1))},Formula.STDEVP=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=0,e=0,a=Formula.AVERAGE(r),u=0;n>u;u++)r[u]!==!0&&r[u]!==!1&&(t+=Math.pow(r[u]-a,2),e++);return Math.sqrt(t/e)},Formula.STDEVPA=function(){for(var r=Formula.ARGSCONCAT(arguments),n=r.length,t=0,e=jStat.mean(r),a=0;n>a;a++)t+=Math.pow(r[a]-e,2);return Math.sqrt(t/n)},Formula.STDEVS=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=0,e=0,a=Formula.AVERAGE(r),u=0;n>u;u++)r[u]!==!0&&r[u]!==!1&&(t+=Math.pow(r[u]-a,2),e++);return Math.sqrt(t/(e-1))},Formula.STEYX=function(r,n){for(var t=jStat.mean(n),e=jStat.mean(r),a=n.length,u=0,o=0,i=0,l=0;a>l;l++)u+=Math.pow(r[l]-e,2),o+=(n[l]-t)*(r[l]-e),i+=Math.pow(n[l]-t,2);return Math.sqrt((u-o*o/i)/(a-2))},Formula.TDIST=function(r,n,t){return t?jStat.studentt.cdf(r,n):jStat.studentt.pdf(r,n)},Formula.TDIST2T=function(){},Formula.TDISTRT=function(){},Formula.TINV=function(r,n){return jStat.studentt.inv(r,n)},Formula.TINV2T=function(){},Formula.TTEST=function(){},Formula.TREND=function(){},Formula.TRIMMEAN=function(r,n){r=Formula.FLATTEN(r);var t=Formula.FLOOR(r.length*n,2)/2;return jStat.mean(_.initial(_.rest(r.sort(function(r,n){return r-n}),t),t))},Formula.VARA=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=0,e=0,a=Formula.AVERAGEA(r),u=0;n>u;u++){var o=r[u];t+="number"==typeof o?Math.pow(o-a,2):o===!0?Math.pow(1-a,2):Math.pow(0-a,2),null!==o&&e++}return t/(e-1)},Formula.VARP=function(){for(var r=Formula.NUMBERS(Formula.FLATTEN(arguments)),n=r.length,t=0,e=0,a=Formula.AVERAGE(r),u=0;n>u;u++)t+=Math.pow(r[u]-a,2),e++;return t/e},Formula.VARPA=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=0,e=0,a=Formula.AVERAGEA(r),u=0;n>u;u++){var o=r[u];t+="number"==typeof o?Math.pow(o-a,2):o===!0?Math.pow(1-a,2):Math.pow(0-a,2),null!==o&&e++}return t/e},Formula.VARS=function(){for(var r=Formula.FLATTEN(arguments),n=r.length,t=0,e=0,a=Formula.AVERAGE(r),u=0;n>u;u++)r[u]!==!0&&r[u]!==!1&&(t+=Math.pow(r[u]-a,2),e++);return t/(e-1)},Formula.WEIBULLDIST=function(r,n,t,e){return e?1-Math.exp(-Math.pow(r/t,n)):Math.pow(r,n-1)*Math.exp(-Math.pow(r/t,n))*n/Math.pow(t,n)},Formula.ZTEST=function(r,n,t){var e=r.length,a="undefined"==typeof t?Formula.STDEVS(r):t;return 1-Formula.NORMSDIST((Formula.AVERAGE(r)-n)/(a/Math.sqrt(e)),Formula.TRUE)},Formula.CHAR=function(r){return String.fromCharCode(r)},Formula.CLEAN=function(r){return r.replace(/[\0-\x1F]/g,"")},Formula.CODE=function(r){return r.charCodeAt(0)},Formula.CONCATENATE=function(){for(var r="",n=0;n<arguments.length;n++)null!==arguments[n]&&void 0!==arguments[n]&&(r+=arguments[n]);return r},Formula.DOLLAR=function(r,n){n="undefined"==typeof n?2:n;var t="";return 0>=n?(r=Math.round(r*Math.pow(10,n))/Math.pow(10,n),t="$0,0"):n>0&&(t="$0,0."+new Array(n+1).join("0")),numeral(r).format(t)},Formula.EXACT=function(r,n){return r===n},Formula.FIND=function(r,n,t){return t="undefined"==typeof t?0:t,n?n.indexOf(r,t-1)+1:null},Formula.FIXED=function(r,n,t){n="undefined"==typeof n?2:n,t="undefined"==typeof t?!1:t;var e=t?"0":"0,0";return 0>=n?r=Math.round(r*Math.pow(10,n))/Math.pow(10,n):n>0&&(e+="."+new Array(n+1).join("0")),numeral(r).format(e)},Formula.HTML2TEXT=function(r){var n="";return r&&(r instanceof Array?r.forEach(function(r){""!==n&&(n+="\n"),n+=r.replace(/<(?:.|\n)*?>/gm,"")}):n=r.replace(/<(?:.|\n)*?>/gm,"")),n},Formula.HUMANIZE=function(r){if(r instanceof Date){var n=moment(r);return n.format(n.hours()||n.minutes()||n.seconds()?"dddd, MMMM Do YYYY, h:mm:ss":"dddd, MMMM Do YYYY")}return r},Formula.JOIN=function(r,n){return r.join(n)},Formula.LEFT=function(r,n){return n="undefined"==typeof n?1:n,r?r.substring(0,n):null},Formula.LEN=function(r){return r?r.length:0},Formula.LOWER=function(r){return r?r.toLowerCase():r},Formula.MID=function(r,n,t){return r.substring(n-1,t)},Formula.NUMBERVALUE=function(r,n,t){return n="undefined"==typeof n?".":n,t="undefined"==typeof t?",":t,Number(r.replace(n,".").replace(t,""))},Formula.NUMBERS=function(){var r=Formula.FLATTEN(arguments);return r.filter(function(r){return"number"==typeof r})},Formula.PROPER=function(r){return r?r.replace(/\w\S*/g,function(r){return r.charAt(0).toUpperCase()+r.substr(1).toLowerCase()}):void 0},Formula.REGEXEXTRACT=function(r,n){var t=r.match(new RegExp(n));return t?t[t.length>1?t.length-1:0]:null},Formula.REGEXMATCH=function(r,n,t){var e=r.match(new RegExp(n));return t?e:!!e},Formula.REGEXREPLACE=function(r,n,t){return r.replace(new RegExp(n),t)},Formula.REPLACE=function(r,n,t,e){return r.substr(0,n-1)+e+r.substr(n-1+t)},Formula.REPT=function(r,n){return new Array(n+1).join(r)},Formula.RIGHT=function(r,n){return n="undefined"==typeof n?1:n,r?r.substring(r.length-n):null},Formula.ROMAN=function(r){for(var n=String(r).split(""),t=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],e="",a=3;a--;)e=(t[+n.pop()+10*a]||"")+e;return new Array(+n.join("")+1).join("M")+e},Formula.SEARCH=function(r,n,t){return t="undefined"==typeof t?0:t,n.toLowerCase().indexOf(r.toLowerCase(),t-1)+1},Formula.SPLIT=function(r,n){return _s.words(r,n)},Formula.SUBSTITUTE=function(r,n,t,e){if(!(r&&n&&t))return r;if("undefined"==typeof e)return r.replace(new RegExp(n,"g"),t);for(var a=0,u=0;r.indexOf(n,a)>0;)if(a=r.indexOf(n,a+1),u++,u===e)return r.substring(0,a)+t+r.substring(a+n.length)},Formula.T=function(r){return"string"==typeof r?r:null},Formula.TEXT=function(r,n){if(!r)return"";if(r instanceof Object)try{return JSON.stringify(r)}catch(t){return""}return"string"==typeof r?n?n.indexOf("0")>=0?numeral(r).format(n):moment(new Date(r)).format(n):r:r.toString&&"function"==typeof r.toString?r.toString():""},Formula.TRIM=function(r){return _s.clean(r)},Formula.UNICHAR=Formula.CHAR,Formula.UNICODE=Formula.CODE,Formula.UPPER=function(r){return r.toUpperCase()},Formula.VALUE=function(r){return numeral().unformat(r)},Formula.MD5=function(r,n,t){return md5(r,n,t)},Formula.NUMERAL=function(r,n){return numeral(r).format(n)},Formula.ISERR=function(r){return["#DIV/0!","#NAME?","#NUM!","#NULL!","#REF!","#VALUE!"].indexOf(r)>=0?!0:!1},Formula.ISERROR=function(r){return Formula.ISERR(r)||"#N/A"===r},Formula.IFERROR=function(r,n){return Formula.ISERROR(r)?n:r},Formula}var root=this,Formula=root.Formula={},_=root._,numeral=root.numeral,jStat=root.jStat,moment=root.moment,lodash=_,md5=root.md5,_s=_.str;if("undefined"!=typeof exports)module.exports=exportModule(require("numeral"),require("jStat"),require("moment"),require("lodash"),require("underscore.string"),require("blueimp-md5"));else{if("function"!=typeof define||!define.amd)return Formula=exportModule(numeral,jStat,moment,lodash,_s,md5);define("formula",["numeral","jstat","moment","lodash","underscore.string","md5"],exportModule)}}.call(this),"function"==typeof _u&&(_=_u.noConflict());