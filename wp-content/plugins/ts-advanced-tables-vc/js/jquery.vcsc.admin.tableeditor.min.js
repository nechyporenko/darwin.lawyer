var TS_Table_HandsOnTableMaster=null,TS_Table_HandsOnTableComments=null;!function(e){jQuery(document).ready(function(){function t(e){if(it=TS_Table_HandsOnTableMaster.countEmptyRows(!0),ct=TS_Table_HandsOnTableMaster.countEmptyCols(!0),ot=TS_Table_HandsOnTableMaster.countRows()-it,lt=TS_Table_HandsOnTableMaster.countCols()-ct,st=0,jQuery("#wp-ts-advanced-table-info-input-wrap").hasClass("tmce-active")?jQuery(Z).val(tinymce.activeEditor.getContent({format:"html"})):jQuery("#wp-ts-advanced-table-info-input-wrap").hasClass("html-active")?jQuery(Z).val(jQuery("textarea#ts-advanced-table-info-input").val()):jQuery(Z).val(""),jQuery("#ts-advanced-table-transfer-rows").val(ot),jQuery("#ts-advanced-table-transfer-columns").val(lt),M=[],jQuery(_e).prop("checked"))for(var t=0;t<TS_Table_HandsOnTableMaster.mergeCells.mergedCellInfoCollection.length;t++)M.push(TS_Table_HandsOnTableMaster.mergeCells.mergedCellInfoCollection[t]);if(jQuery("#ts-advanced-table-transfer-merged").val(JSON.stringify(M)),M=[],B={},jQuery(".ts-advanced-table-defaults-format").each(function(e,t){var a=jQuery(this).attr("data-default"),r=jQuery(this).val();B[a]=r}),jQuery("#ts-advanced-table-transfer-defaults").val(JSON.stringify(B)),B={},""!=(H=JSON.stringify(TS_Table_HandsOnTableMaster.getData()))&&null!=H&&(H=encodeURIComponent(H)),jQuery("#ts-advanced-table-transfer-data").val(H),A=[],at)for(i=0;i<ot;i++)for(c=0;c<lt;c++){dt++;var a={},r=l(u=TS_Table_HandsOnTableMaster.getDataAtCell(i,c)),n=null;if(r)try{n=TS_Table_HandsOnTableMaster.plugin.matrix.getItem(TS_Table_HandsOnTableMaster.plugin.utils.translateCellCoords({row:i,col:c})).value,st++}catch(e){n=u,r=!1}else n=u;""!=n&&null!=n&&(n=encodeURIComponent(n));var o=TS_Table_HandsOnTableMaster.getCellMeta(i,c),s=jQuery.trim(o.className)||"",d=""!=o.formatType&&void 0!=o.formatType?o.formatType:"text";s=s.replace(/\s\s+/g," "),a.count=dt,a.row=i,a.column=c,a.value=n,a.momentdate=""!=o.momentdate&&void 0!=o.momentdate?o.momentdate:"",a.momenttime=""!=o.momenttime&&void 0!=o.momenttime?o.momenttime:"",a.formula=r,a.className=s,a.locale=""!=o.language&&void 0!=o.language?o.language:E,a.symbol=""!=o.symbol&&void 0!=o.symbol?o.symbol:numbro.cultureData().currency.symbol,a.dateFormat=""!=o.dateFormat&&void 0!=o.dateFormat?o.dateFormat:Ve,a.timeFormat=""!=o.timeFormat&&void 0!=o.timeFormat?o.timeFormat:Je,a.type=""!=o.type&&void 0!=o.type?o.type:"text",a.dataType=""!=o.dataType&&void 0!=o.dataType?o.dataType:"text",a.format=""!=o.format&&void 0!=o.format?o.format:"text",a.formatType=d,a.placement=""!=o.placement&&void 0!=o.placement?o.placement:Mt(qe,"format"),a.decimals="number"==d||"numeric"==d?""!=o.decimals&&void 0!=o.decimals?o.decimals:Ge:"currency"==d?""!=o.decimals&&void 0!=o.decimals?o.decimals:Ye:"percent"==d?""!=o.decimals&&void 0!=o.decimals?o.decimals:Xe:""!=o.decimals&&void 0!=o.decimals?o.decimals:Ge,jQuery.isPlainObject(o.comment)&&o.comment.hasOwnProperty("value")?a.comment=o.comment.value:a.comment=o.comment,A.push(a)}else for(var i=0;i<ot;i++)for(var c=0;c<lt;c++){dt++;var a={},u=TS_Table_HandsOnTableMaster.getDataAtCell(i,c);""!=u&&null!=u&&(u=encodeURIComponent(u)),a.count=dt,a.row=i,a.column=c,a.value=u,a.momentdate="",a.momenttime="",a.formula=!1,a.className="",a.locale=E,a.symbol=numbro.cultureData().currency.symbol,a.dateFormat=Ve,a.timeFormat=Je,a.type="text",a.dataType="text",a.format="text",a.formatType="text",a.decimals=Ge,a.comment="",a.placement=Mt(qe,"format"),A.push(a)}jQuery("#ts-advanced-table-transfer-meta").val(JSON.stringify(A)),A=[],(R={}).urlencoded="true",R.csvexternal="false",R.csvpath="",R.savemeta=at?"true":"false",R.usecharts="false",R.useformulas=st>0?"true":"false",jQuery(xe).prop("checked")?R.usesearch="true":R.usesearch="false",jQuery(Se).prop("checked")?R.usecontext="true":R.usecontext="false",jQuery(ke).prop("checked")?R.usevalidator="true":R.usevalidator="false",jQuery(Oe).prop("checked")?R.usemoving="true":R.usemoving="false",jQuery(Ee).prop("checked")?R.usecomments="true":R.usecomments="false",jQuery(_e).prop("checked")?R.usemerging="true":R.usemerging="false",jQuery(Fe).prop("checked")?R.fixrow="true":R.fixrow="false",jQuery(Ie).prop("checked")?R.fixcolumn="true":R.fixcolumn="false",R.categories=jQuery(de).val(),R.tags=jQuery(ie).val(),jQuery("#ts-advanced-table-transfer-other").val(JSON.stringify(R)),R={},_=!0,e&&_&&(jQuery("form#ts-advanced-table-edit-form").validationEngine("detach"),setTimeout(function(){jQuery("#ts-advanced-table-check-true").val("1").attr("value","1"),jQuery("form#ts-advanced-table-edit-form").off("submit").dequeue().stop(),jQuery("#ts-advanced-table-trigger-button").trigger("click"),k.hide()},250))}function a(){var e=jQuery("#ts-advanced-table-icondata-wrapper"),t=e.attr("data-active");jQuery("#ts-advanced-table-controls-wrapper").slideFade(),jQuery("#ts-advanced-table-icondata-wrapper").slideFade(),jQuery("#ts-advanced-table-toolbar-wrapper").slideFade(),jQuery("#ts-advanced-table-handsontable-wrapper").slideFade(),jQuery("#ts-advanced-table-celldata-wrapper").slideFade(),jQuery("#ts-advanced-table-separator-controls").slideFade(),"true"==t?(e.attr("data-active","false"),jQuery("#ts-advanced-table-overlay-layer").fadeOut(250)):(e.attr("data-active","true"),jQuery("#ts-advanced-table-overlay-layer").fadeIn(250))}function r(e){var t=e.target.files[0],a=escape(t.name),r=(t.type,t.size),n=t.lastModifiedDate?t.lastModifiedDate.toLocaleDateString():"N/A",l=0,o=0,s=0,d=new FileReader;d.readAsText(t),d.onload=function(e){var t=e.target.result;t=jQuery.csv.toArrays(t,{separator:",",delimiter:'"'});var d=[],i=[];TS_Table_HandsOnTableMaster.clear(),TS_Table_HandsOnTableMaster.deselectCell(),TS_Table_HandsOnTableMaster.updateSettings({data:[]});for(var c in t){i=[],l++;for(var u in t[c])1==l&&o++,s++,i.push(jQuery.trim(t[c][u]));d.push(i)}TS_Table_HandsOnTableMaster.updateSettings({data:d}),TS_Table_HandsOnTableMaster.render();var d=[],i=[];jQuery("#ts-advanced-table-upload-button").trigger("click"),y=jQuery("#ts-advanced-table-csv-file").attr("data-success")+"<br/><br/>",y+=jQuery("#ts-advanced-table-csv-file").attr("data-name")+" "+a+"<br/>",y+=jQuery("#ts-advanced-table-csv-file").attr("data-updated")+" "+n+"<br/>",y+=jQuery("#ts-advanced-table-csv-file").attr("data-size")+" "+function(e){var t=Math.floor(Math.log(e)/Math.log(1024));return 1*(e/Math.pow(1024,t)).toFixed(2)+" "+["B","kB","MB","GB","TB"][t]}(r)+"<br/>",y+=jQuery("#ts-advanced-table-csv-file").attr("data-rows")+" "+l+"<br/>",y+=jQuery("#ts-advanced-table-csv-file").attr("data-columns")+" "+o+"<br/>",y+=jQuery("#ts-advanced-table-csv-file").attr("data-cells")+" "+s+"<br/>",j="success",Q=!0,w=!1,T=!1,TS_VCSC_SweetAlert({title:jQuery("#ts-advanced-table-language-plugin").html(),text:"",html:y,type:j,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:Q,showCancelButton:w,showOtherButton:T,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33d33",otherButtonColor:"#d33d33",confirmButtonText:jQuery("#ts-advanced-table-language-ok").html(),cancelButtonText:jQuery("#ts-advanced-table-language-no").html(),otherButtonText:jQuery("#ts-advanced-table-language-understood").html(),closeOnConfirm:!0,closeOnCancel:!0},function(e){jQuery("html, body").animate({scrollTop:0},500),jQuery("#ts-advanced-table-tabs-navigation").find("ul li:first").click()}),jQuery("#ts-advanced-table-csv-file").val(""),jQuery("#ts-advanced-table-csv-name").html(""),jQuery("#ts-advanced-table-csv-import").hide()},d.onerror=function(){y=jQuery("#ts-advanced-table-csv-file").attr("data-error")+" "+a,j="error",Q=!1,w=!1,T=!0,TS_VCSC_SweetAlert({title:jQuery("#ts-advanced-table-language-plugin").html(),text:"",html:y,type:j,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:Q,showCancelButton:w,showOtherButton:T,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33d33",otherButtonColor:"#d33d33",confirmButtonText:jQuery("#ts-advanced-table-language-yes").html(),cancelButtonText:jQuery("#ts-advanced-table-language-no").html(),otherButtonText:jQuery("#ts-advanced-table-language-ok").html(),closeOnConfirm:!0,closeOnCancel:!0}),jQuery("#ts-advanced-table-csv-file").val(""),jQuery("#ts-advanced-table-csv-name").html(""),jQuery("#ts-advanced-table-csv-import").hide()}}function n(){jQuery("#ts-advanced-table-fullscreen-wrapper").trigger("detach.ScrollToFixed"),!pt&&jQuery(window).height()>400&&"false"==jQuery("#ts-advanced-table-icondata-wrapper").attr("data-active")&&jQuery("#ts-advanced-table-fullscreen-wrapper").scrollToFixed({marginTop:jQuery("#wpadminbar").outerHeight(),zIndex:499})}function l(e){return!(!e||"="!==e[0])}function o(e){if(void 0!==e&&"undefined"!==e||null==We){var t=e.from.row,a=e.to.row,r=e.from.col,n=e.to.col;return singleCell=!0,t>a&&(t=e.to.row,a=e.from.row,singleCell=!1),r>n&&(r=e.to.col,n=e.from.col,singleCell=!1),{from:{col:r,row:t},to:{col:n,row:a},single:singleCell}}}function s(e,t){var a=o(e.getSelectedRange());if(void 0===a||"undefined"===a){if(null==We)return;a=We}for(var r=new RegExp(t),n="",l=a.from.row;l<=a.to.row;l++)for(var s=a.from.col;s<=a.to.col;s++){var d=e.getCellMeta(l,s);d.className=d.className||"",n=d.className.match(r)?d.className.replace(t,""):d.className+" "+t,e.setCellMeta(d.row,d.col,"className",n)}u(a.single,n)}function d(e,t,a){var r=o(e.getSelectedRange());if(void 0===r||"undefined"===r){if(null==We)return;r=We}if(a instanceof RegExp)n=a;else if(a instanceof Array)n=new RegExp(a.join("|"));else var n=a;for(var l="",s=r.from.row;s<=r.to.row;s++)for(var d=r.from.col;d<=r.to.col;d++){var i=e.getCellMeta(s,d);i.className=i.className||"",l=i.className.replace(n,"")+" "+t,e.setCellMeta(i.row,i.col,"className",l)}u(r.single,l)}function c(e,t){var a=o(e.getSelectedRange());if(void 0===a||"undefined"===a){if(null==We)return;a=We}for(var r="",n=a.from.row;n<=a.to.row;n++)for(var l=a.from.col;l<=a.to.col;l++){var s=e.getCellMeta(n,l);r=s.className.replace(t,""),e.setCellMeta(s.row,s.col,"className",r)}u(a.single,r)}function u(e,t){if(e){var a="";t=(t=(t=jQuery.trim(t)||"").replace(/\s\s+/g," ")).split(" "),jQuery("#ts-advanced-table-toolbar-wrapper button").removeClass("ts-advanced-table-button-active"),jQuery("#ts-advanced-table-toolbar-wrapper .ts-advanced-table-submenu-items a").removeClass("ts-advanced-table-button-active"),-1!==jQuery.inArray("bold",t)&&jQuery("#ts-advanced-table-button-bold").addClass("ts-advanced-table-button-active"),-1!==jQuery.inArray("italic",t)&&jQuery("#ts-advanced-table-button-italic").addClass("ts-advanced-table-button-active"),-1!==jQuery.inArray("underline",t)?jQuery("#ts-advanced-table-button-underline").addClass("ts-advanced-table-button-active"):-1!==jQuery.inArray("overline",t)?jQuery("#ts-advanced-table-button-overline").addClass("ts-advanced-table-button-active"):-1!==jQuery.inArray("linethrough",t)?jQuery("#ts-advanced-table-button-linethrough").addClass("ts-advanced-table-button-active"):jQuery("#ts-advanced-table-button-nodecoration").addClass("ts-advanced-table-button-active"),-1!==jQuery.inArray("htLeft",t)?jQuery("#ts-advanced-table-button-left").addClass("ts-advanced-table-button-active"):-1!==jQuery.inArray("htRight",t)?jQuery("#ts-advanced-table-button-right").addClass("ts-advanced-table-button-active"):-1!==jQuery.inArray("htCenter",t)?jQuery("#ts-advanced-table-button-center").addClass("ts-advanced-table-button-active"):-1!==jQuery.inArray("htJustify",t)?jQuery("#ts-advanced-table-button-justify").addClass("ts-advanced-table-button-active"):""!=jQuery("#ts-advanced-table-defaults-alignhorizontal").val()&&(a=(a=jQuery("#ts-advanced-table-defaults-alignhorizontal").val().toLowerCase()).replace("ht",""),jQuery("#ts-advanced-table-button-"+a).addClass("ts-advanced-table-button-active")),-1!==jQuery.inArray("htTop",t)?jQuery("#ts-advanced-table-button-top").addClass("ts-advanced-table-button-active"):-1!==jQuery.inArray("htMiddle",t)?jQuery("#ts-advanced-table-button-middle").addClass("ts-advanced-table-button-active"):-1!==jQuery.inArray("htBottom",t)?jQuery("#ts-advanced-table-button-bottom").addClass("ts-advanced-table-button-active"):""!=jQuery("#ts-advanced-table-defaults-alignvertical").val()&&(a=(a=jQuery("#ts-advanced-table-defaults-alignvertical").val().toLowerCase()).replace("ht",""),jQuery("#ts-advanced-table-button-"+a).addClass("ts-advanced-table-button-active"))}}function v(){var e=jQuery('<div class="antiscroll-inner" style="width:50px;height:50px;overflow-y:scroll;position:absolute;top:-200px;left:-200px;"><div style="height:100px;width:100%"/></div>');jQuery("body").append(e);var t=jQuery(e).innerWidth(),a=jQuery("div",e).innerWidth();return jQuery(e).remove(),t-a}function f(e){setTimeout(function(){mt.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(mt),jQuery(window).trigger("resize"),jQuery(window).trigger("debouncedresize"),TS_Table_HandsOnTableMaster.render()},e)}function b(){jQuery(G).parent().css({height:"100%",width:"100%"}),Kt=Handsontable.dom.offset(G),At=jQuery(window).height(),Ht=jQuery(G).parent().outerWidth()+window.scrollX,Ut=Handsontable.dom.innerHeight(document.body)-Kt.top+window.scrollY,zt=jQuery(xe).prop("checked")?jQuery("#ts-advanced-table-search-wrapper").outerHeight(!0):0,At>400?(Pt=jQuery("#ts-advanced-table-title-wrapper").outerHeight(!0)+zt+jQuery("#ts-advanced-table-celldata-wrapper").outerHeight(!0)+jQuery("#ts-advanced-table-toolbar-wrapper").outerHeight(!0),Lt=parseInt(jQuery("#wpbody-content").css("padding-bottom").replace("px",""))):(Pt=0,Lt=0),Wt=jQuery(G).find(".wtHider").outerHeight(!0)+v()+Dt,ht&&(pt=screenfull.isFullscreen)?(Pt=Pt,gt=jQuery("#ts-advanced-table-fullscreen-wrapper").outerHeight(!0),Rt=gt-jQuery("#ts-advanced-table-title-wrapper").outerHeight(!0)-zt-jQuery("#ts-advanced-table-celldata-wrapper").outerHeight(!0)-jQuery("#ts-advanced-table-toolbar-wrapper").outerHeight(!0),Wt=Rt):(Pt=Pt+jQuery("#wpadminbar").outerHeight()+Lt,Rt=parseInt(jQuery(G).parent().attr("data-height-max")),At-Pt<Rt&&(Rt=At-Pt)),$t=Wt>Rt?Rt:Wt<Nt?Nt:Wt,ht&&pt?($t-=20,jQuery(G).parent().css("max-height",$t+"px")):jQuery(G).parent().css("max-height",parseInt(jQuery(G).parent().attr("data-height-max"))+"px");try{TS_Table_HandsOnTableMaster.updateSettings({height:$t-Dt/2})}catch(e){}jQuery(G).css({width:Ht+"px"}),jQuery(G).find(".wtHolder").css({}),jQuery(G).parent().css({width:Ht+"px",height:$t+"px"}),0==jQuery("#ts-advanced-table-tabs-container").length&&(jQuery("#ts-advanced-table-name-input").css({width:jQuery("#ts-advanced-table-name-wrapper").width()-jQuery("#ts-advanced-table-name-input").siblings("label").width()}),jQuery("#ts-advanced-table-number-input").css({width:jQuery("#ts-advanced-table-number-wrapper").width()-jQuery("#ts-advanced-table-number-input").siblings("label").width()}),jQuery("#ts-advanced-table-date-input").css({width:jQuery("#ts-advanced-table-date-wrapper").width()-jQuery("#ts-advanced-table-date-input").siblings("label").width()}),jQuery("#ts-advanced-table-search-input").css({width:jQuery("#ts-advanced-table-search-wrapper").width()-jQuery("#ts-advanced-table-search-input").siblings("label").width()}),jQuery("#ts-advanced-table-celldata-editor").css({width:jQuery("#ts-advanced-table-celldata-wrapper").width()-jQuery("#ts-advanced-table-celldata-editor").siblings("label").width()}))}function m(){return jQuery(G).parent().outerWidth()}function h(){return jQuery(G).parent().outerHeight()>Rt?Rt:jQuery(G).parent().outerHeight()<Nt?Nt:jQuery(G).parent().outerHeight()}function p(){return(vt=$e?Math.floor((m()-50-ut)/TS_Table_HandsOnTableMaster.countCols()):Math.floor((m()-50-ut)/ft))<200&&(vt=200),vt}function g(e,t,a,r,n,l,o){Handsontable.renderers.HtmlRenderer.apply(this,arguments),"null"===t.innerHTML&&(t.innerHTML="")}var y="",j="",Q=!0,w=!0,T=!1,C="",x="",S="";jQuery("#ts-advanced-table-tabs-container").length>0&&new KrautTabs(document.getElementById("ts-advanced-table-tabs-container"),{start:parseInt(jQuery("#ts-advanced-table-transfer-section").val())}),0===jQuery("#ts-return-to-top-main").length&&jQuery("body").append('<div id="ts-return-to-top-main" class="ts-return-to-top-hidden"><i class="dashicons dashicons-arrow-up-alt2"></i></div>'),jQuery("body").hasClass("ts-return-to-top-added")||(jQuery(window).on("scroll",function(){jQuery(this).scrollTop()>=320?jQuery("#ts-return-to-top-main").removeClass("ts-return-to-top-hidden").addClass("ts-return-to-top-visible"):jQuery("#ts-return-to-top-main").removeClass("ts-return-to-top-visible").addClass("ts-return-to-top-hidden")}),jQuery("#ts-return-to-top-main").off().on("click",function(){jQuery("body,html").stop().animate({scrollTop:0},500)}),jQuery("body").addClass("ts-return-to-top-added"));document.getElementById("ts-advanced-table-save-button");var k=jQuery("#ts-advanced-table-preloader"),_=!1,E=jQuery("#ts-advanced-table-defaults-editorlocale").val(),O={36:"$",128:"€",163:"£",8369:"₱",165:"¥",8360:"₨",8377:"₹",8381:"₽",8378:"₺",1547:"؋",1423:"֏",8371:"₳",8373:"₵",402:"ƒ",8365:"₭",8362:"₪",8363:"₫",8355:"₣",8356:"₤",8359:"₧",8361:"₩",8372:"₴",8367:"₯",8366:"₮",8370:"₲",8375:"₷",8376:"₸",8380:"₼",8382:"₾",8368:"₰",8379:"₻",8374:"₶"},F={bg:"BGN","cs-CZ":"CZK","da-DK":"DKK","de-CH":"CHF","de-DE":"EUR","de-LI":"CHF",el:"EUR","en-AU":"AUD","en-GB":"GBP","en-IE":"EUR","en-NZ":"NZD","en-US":"USD","en-ZA":"ZAR","es-AR":"ARS","es-CL":"CLP","es-CO":"COP","es-CR":"CRC","es-ES":"EUR","es-NI":"NIO","es-PE":"PEN","es-PR":"USD","es-SV":"SVC","et-EE":"EUR","fa-IR":"IRR","fi-FI":"EUR","fil-PH":"PHP","fr-CA":"CAD","fr-CH":"CHF","fr-FR":"EUR","he-IL":"ILS","hu-HU":"HUF",id:"IDR","it-CH":"CHF","it-IT":"EUR","ja-JP":"JPY","ko-KR":"KRW","lv-LV":"EUR","nb-NO":"NOK",nb:"NOK","nl-BE":"EUR","nl-NL":"EUR",nn:"NOK","nn-NO":"NOK","pl-PL":"PLN","pt-BR":"BRL","pt-PT":"EUR",ro:"RON","ro-RO":"RON","ru-RU":"RUB","ru-UA":"UAH","sk-SK":"EUR",sl:"EUR","sr-Cyrl-RS":"RSD","sv-SE":"SEK","th-TH":"THB","tr-TR":"TRY","uk-UA":"UAH","zh-CN":"CNY","zh-MO":"MOP","zh-SG":"SGD","zh-TW":"TWD"},I=function(e){var t={};for(var a in e)e.hasOwnProperty(a)&&(t[e[a]]=a);return t}(O);!function(e,t,a,r){var n="";for(var l in e)e.hasOwnProperty(l)&&(n+=t?l+r:l+a+e[l]+r);n=n.slice(0,-1)}(O);numbro.culture(E),jQuery("form#ts-advanced-table-edit-form").on("submit",function(e){"1"===jQuery("#ts-advanced-table-check-true").val()&&_?jQuery("form#ts-advanced-table-edit-form").submit():e.preventDefault()});var M=[],B=[],H=[],A=[],R=[];jQuery.isFunction(jQuery.fn.validationEngine)&&jQuery("form#ts-advanced-table-edit-form").validationEngine("attach",{scroll:!1,focusFirstField:!1,showOneMessage:!0,showPrompts:!0,promptPosition:"inline",validateNonVisibleFields:!0,addSuccessCssClassToField:"Passed",addFailureCssClassToField:"Failed",onValidationComplete:function(e,a){1==a?(y=jQuery("#ts-advanced-table-language-validtext").html(),j="success",Q=!0,w=!0,T=!1,jQuery("#ts-advanced-table-check-true").val("1").attr("value","1"),TS_VCSC_SweetAlert({title:jQuery("#ts-advanced-table-language-plugin").html(),text:"",html:y,type:j,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:Q,showCancelButton:w,showOtherButton:T,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33d33",otherButtonColor:"#d33d33",confirmButtonText:jQuery("#ts-advanced-table-language-yes").html(),cancelButtonText:jQuery("#ts-advanced-table-language-no").html(),otherButtonText:jQuery("#ts-advanced-table-language-understood").html(),closeOnConfirm:!0,closeOnCancel:!0},function(e){e?(k.show(),setTimeout(function(){t(!0)},250)):e||jQuery("#ts-advanced-table-check-true").val("0").attr("value","0")})):(y=jQuery("#ts-advanced-table-language-errortext").html(),j="error",Q=!1,w=!1,T=!0,jQuery("#ts-advanced-table-check-true").val("0").attr("value","0"),jQuery("html, body").animate({scrollTop:0},"slow"),TS_VCSC_SweetAlert({title:jQuery("#ts-advanced-table-language-plugin").html(),text:"",html:y,type:j,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:Q,showCancelButton:w,showOtherButton:T,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33d33",otherButtonColor:"#d33d33",confirmButtonText:jQuery("#ts-advanced-table-language-yes").html(),cancelButtonText:jQuery("#ts-advanced-table-language-no").html(),otherButtonText:jQuery("#ts-advanced-table-language-understood").html(),closeOnConfirm:!0,closeOnCancel:!0}))}});var N="";N=jQuery("#ts-advanced-table-language-deletetitle").html(),jQuery("#ts-advanced-table-language-deletetitle").empty().printf(N,jQuery("#ts-advanced-table-number-input").val()),N=jQuery("#ts-advanced-table-language-clonetitle").html(),jQuery("#ts-advanced-table-language-clonetitle").empty().printf(N,jQuery("#ts-advanced-table-number-input").val()),N=jQuery("#ts-advanced-table-language-clonetext").html(),jQuery("#ts-advanced-table-language-clonetext").empty().printf(N,jQuery("#ts-advanced-table-number-input").val(),jQuery("#ts-advanced-table-name-input").val()),jQuery("#ts-advanced-tables-button-copy").on("click",function(e){e.preventDefault(),C=jQuery(this).attr("href"),x=jQuery("#ts-advanced-table-number-input").val(),S=jQuery("#ts-advanced-table-name-input").val(),y=jQuery("#ts-advanced-table-language-clonetext").html(),y+='<input type="text" id="ts-advanced-table-clone-name" class="ts-advanced-table-clone-name" name="ts-advanced-table-clone-name" value="'+S+" - "+jQuery("#ts-advanced-table-language-clonesingle").html()+'">',j="info",Q=!0,w=!0,T=!1,TS_VCSC_SweetAlert({title:jQuery("#ts-advanced-table-language-clonetitle").html(),text:"",html:y,type:j,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:Q,showCancelButton:w,showOtherButton:T,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33d33",otherButtonColor:"#d33d33",confirmButtonText:jQuery("#ts-advanced-table-language-continue").html(),cancelButtonText:jQuery("#ts-advanced-table-language-cancel").html(),otherButtonText:jQuery("#ts-advanced-table-language-understood").html(),closeOnConfirm:!0,closeOnCancel:!0},function(e){return e?(""!=jQuery("#ts-advanced-table-clone-name").val()&&jQuery("#ts-advanced-table-clone-name").val()!=S&&(window.location=C+"&newname="+TS_TablesWP_Base64.encode(jQuery("#ts-advanced-table-clone-name").val())),!1):!!e&&void 0})}),jQuery("#ts-advanced-tables-button-delete").on("click",function(e){e.preventDefault(),C=jQuery(this).attr("href"),x=jQuery("#ts-advanced-table-number-input").val(),S=jQuery("#ts-advanced-table-name-input").val(),N=jQuery("#ts-advanced-table-language-deletetext").html(),jQuery("#ts-advanced-table-language-blank").empty().printf(N,x,S),y=jQuery("#ts-advanced-table-language-blank").html(),j="error",Q=!0,w=!0,T=!1,TS_VCSC_SweetAlert({title:jQuery("#ts-advanced-table-language-deletetitle").html(),text:"",html:y,type:j,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:Q,showCancelButton:w,showOtherButton:T,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33d33",otherButtonColor:"#d33d33",confirmButtonText:jQuery("#ts-advanced-table-language-yes").html(),cancelButtonText:jQuery("#ts-advanced-table-language-no").html(),otherButtonText:jQuery("#ts-advanced-table-language-understood").html(),closeOnConfirm:!0,closeOnCancel:!0},function(e){return e?(window.location=C,!1):!!e&&void 0})});var D="",P="",L="",z="",U="",$="",W=jQuery(".ts-font-icons-picker-parent"),K="",V="",J="",q="000000";jQuery("#ts-advanced-table-icon-color-picker").ColorPicker({flat:!0,color:"#000000",onHide:function(e,t,a){},onSubmit:function(e,t,a){},onChange:function(e,t,a){q=t}});jQuery("#ts-advanced-table-icon-link-select").on("change",function(e){"true"==jQuery(this).find("option:selected").attr("data-value")?(jQuery("#ts-advanced-table-icon-url").fadeIn(250),jQuery("#ts-advanced-table-icon-target").fadeIn(250),jQuery("#ts-advanced-table-icon-title").fadeIn(250),jQuery("#ts-advanced-table-icon-rel").fadeIn(250)):(jQuery("#ts-advanced-table-icon-url").fadeOut(250),jQuery("#ts-advanced-table-icon-target").fadeOut(250),jQuery("#ts-advanced-table-icon-title").fadeOut(250),jQuery("#ts-advanced-table-icon-rel").fadeOut(250)),n()}),jQuery("#ts-advanced-table-iconinsert-button").on("click",function(e){var t="",r="",n=jQuery("#ts-advanced-table-icon-picker-select").find("option:selected").attr("value"),l=q,o=jQuery("#ts-advanced-table-icon-size-picker").val(),s=jQuery("#ts-advanced-table-icon-display-select").find("option:selected").attr("data-value"),d=jQuery("#ts-advanced-table-icon-align-select").find("option:selected").attr("data-value"),i=jQuery("#ts-advanced-table-icon-float-select").find("option:selected").attr("data-value"),c=jQuery("#ts-advanced-table-icon-insert-select").find("option:selected").attr("data-value"),u=jQuery("#ts-advanced-table-icon-link-select").find("option:selected").attr("data-value"),v=jQuery("#ts-advanced-table-icon-url-input").val(),f=jQuery("#ts-advanced-table-icon-target-select").find("option:selected").attr("data-value"),b=jQuery("#ts-advanced-table-icon-title-input").val(),m=jQuery("#ts-advanced-table-icon-rel-select").find("option:selected").attr("data-value");"000000"!=l&&(r+="color: #"+l+";"),16!=o&&(r+="font-size: "+o+"px;"),"inline-block"!=s&&(r+="display: "+s+";"),"left"!=d&&(r+="text-align: "+d+";"),"none"!=i&&(r+="display: block; float: "+i+";"),""!=r&&(r=' style="'+r+'"'),t='<i class="ts-advanced-table-fonticon '+n+'"'+r+"></i>","true"==u&&""!=v&&(""!=b&&(b=' title="'+b+'"'),""!=m&&(m=' rel="'+m+'"'),t='<a href="'+v+'" target="'+f+'"'+b+m+">"+t+"</a>"),V=""!=K&&"newline"==c?K+"<br/>"+t:""!=K&&"addline"==c?t+"<br/>"+K:""!=K&&"inline"==c?K+" "+t:""!=K&&"before"==c?t+" "+K:t,TS_Table_HandsOnTableMaster.setDataAtCell(J.row,J.col,V),a()}),jQuery("#ts-advanced-table-iconclose-button").on("click",function(e){a()}),W.hasClass("ts-font-icons-picker-initialized")||function(e){var t=e.find(".ts-font-icons-picker");t.attr("data-value"),t.find("select").fontIconPicker({theme:"fip-grey",emptyIcon:!1,emptyIconValue:t.attr("data-transparent"),iconsPerPage:parseInt(t.attr("data-pagecount")),hasSearch:!0,allCategoryText:"From All Fonts",unCategorizedText:"Uncategorized"}),e.addClass("ts-font-icons-picker-initialized")}(W);var G=document.getElementById("ts-advanced-table-handsontable-editor"),Y=document.getElementById("ts-advanced-table-handsontable-preloader"),X=document.getElementById("ts-advanced-table-transfer-import"),Z=document.getElementById("ts-advanced-table-transfer-info"),ee=document.getElementById("ts-advanced-table-transfer-rows"),te=document.getElementById("ts-advanced-table-transfer-columns"),ae=document.getElementById("ts-advanced-table-transfer-merged"),re=document.getElementById("ts-advanced-table-transfer-data"),ne=document.getElementById("ts-advanced-table-transfer-meta"),le=document.getElementById("ts-advanced-table-transfer-defaults"),oe=document.getElementById("ts-advanced-table-transfer-other"),se=document.getElementById("ts-advanced-table-transfer-database"),de=document.getElementById("ts-advanced-table-transfer-cats"),ie=document.getElementById("ts-advanced-table-transfer-tags"),ce=document.getElementById("ts-advanced-table-name-input"),ue=(document.getElementById("ts-advanced-table-number-input"),document.getElementById("ts-advanced-table-date-input"),document.getElementById("ts-advanced-table-date-stamp"),document.getElementById("ts-advanced-table-link-input")),ve=document.getElementById("ts-advanced-table-image-input"),fe=document.getElementById("ts-advanced-table-icon-input"),be=document.getElementById("ts-advanced-table-search-input"),me=document.getElementById("ts-advanced-table-transfer-savemeta"),he=document.getElementById("ts-advanced-table-transfer-formulas"),pe=document.getElementById("ts-advanced-table-transfer-search"),ge=document.getElementById("ts-advanced-table-transfer-context"),ye=document.getElementById("ts-advanced-table-transfer-validator"),je=document.getElementById("ts-advanced-table-transfer-charts"),Qe=document.getElementById("ts-advanced-table-transfer-fixrow"),we=document.getElementById("ts-advanced-table-transfer-fixcolumn"),Te=document.getElementById("ts-advanced-table-scope-metadata-check"),Ce=document.getElementById("ts-advanced-table-scope-formulas-check"),xe=document.getElementById("ts-advanced-table-scope-search-check"),Se=document.getElementById("ts-advanced-table-scope-context-check"),ke=document.getElementById("ts-advanced-table-scope-validator-check"),_e=document.getElementById("ts-advanced-table-scope-merge-check"),Ee=document.getElementById("ts-advanced-table-scope-comments-check"),Oe=document.getElementById("ts-advanced-table-scope-moving-check"),Fe=document.getElementById("ts-advanced-table-scope-fixrow-check"),Ie=document.getElementById("ts-advanced-table-scope-fixcolumn-check"),Me=[],Be=[],He=[],Ae={},Re=!0,Ne=!1,De=!1,Pe=!1,Le=!1,ze=!1,Ue=!1,$e=!1,We=(jQuery(se).val(),null),Ke=jQuery("#ts-advanced-table-defaults-alignhorizontal").val()+" "+jQuery("#ts-advanced-table-defaults-alignvertical").val(),Ve=jQuery("#ts-advanced-table-defaults-datefull").val(),Je=jQuery("#ts-advanced-table-defaults-timefull").val(),qe=jQuery("#ts-advanced-table-defaults-currencyfull").val(),Ge=jQuery("#ts-advanced-table-defaults-decimalsnumeric").val(),Ye=jQuery("#ts-advanced-table-defaults-decimalscurrency").val(),Xe=jQuery("#ts-advanced-table-defaults-decimalspercent").val(),Ze=TS_TablesWP_Base64.decode(jQuery("#ts-advanced-table-defaults-formatsdate").val());Ze=Ze.split("*");var et=TS_TablesWP_Base64.decode(jQuery("#ts-advanced-table-defaults-formatstime").val());et=et.split("*");document.getElementById("ts-advanced-table-toolbar-wrapper");var tt=document.getElementById("ts-advanced-table-toolbar-inactive");if("true"==jQuery(me).val())at=!0;else var at=!1;var rt=[],nt=[],lt=0,ot=0,st=0,dt=-1,it=0,ct=0,ut=0,vt=0,ft=0,bt=0,mt=document.createEvent("UIEvents"),ht=screenfull.enabled,pt=!1,gt=jQuery(window).outerHeight(!0),yt=(parseInt(jQuery("#ts-advanced-table-handsontable-wrapper").attr("data-height-max")),jQuery("#ts-advanced-table-styles")),jt=[],Qt=[],wt=[];jQuery(".ts-vcsc-settings-page-header").length>0&&jQuery("#ts-advanced-table-title-wrapper h2").empty().html(jQuery(".ts-vcsc-settings-page-header h2").html()),jQuery("#ts-advanced-table-toggle-button").on("click",function(e){var t=jQuery("#"+jQuery(this).attr("data-toggle"));"true"==jQuery(this).attr("data-visible")?(t.slideFade(),jQuery(this).attr("data-visible","false")):(t.slideFade(),jQuery(this).attr("data-visible","true"))}),jQuery("#ts-advanced-table-cattags-button").on("click",function(e){var t=jQuery("#"+jQuery(this).attr("data-toggle"));"true"==jQuery(this).attr("data-visible")?(t.slideFade(),jQuery(this).attr("data-visible","false")):(t.slideFade(),jQuery(this).attr("data-visible","true"))}),jQuery("#ts-advanced-table-upload-button").on("click",function(e){var t=jQuery("#"+jQuery(this).attr("data-toggle"));"true"==jQuery(this).attr("data-visible")?(t.slideFade(),jQuery(this).attr("data-visible","false")):(t.slideFade(),jQuery(this).attr("data-visible","true"))});var Tt=null,Ct=!!(window.File&&window.FileReader&&window.FileList&&window.Blob);Ct?(jQuery("#ts-advanced-table-import-wrapper").show(),jQuery("#ts-advanced-table-csv-file").on("change",function(e){var t="",a=jQuery(this).next(".ts-advanced-table-csv-label");a.attr("data-text");if("csv"!=this.value.match(/\.([^\.]+)$/)[1])return alert("You can only import a .csv file type into this table!"),a.find(".ts-advanced-table-csv-name").html(""),jQuery("#ts-advanced-table-csv-import").hide(),Tt=null,!1;""!=(t=e.target.value.split("\\").pop())?(a.find(".ts-advanced-table-csv-name").html(t),jQuery("#ts-advanced-table-csv-import").css("display","inline-block"),Tt=e):(a.find(".ts-advanced-table-csv-name").html(""),jQuery("#ts-advanced-table-csv-import").hide(),Tt=null)}),jQuery("#ts-advanced-table-csv-import").on("click",function(e){null!=Tt&&Ct?(r(Tt),Tt=null):Tt=null})):jQuery("#ts-advanced-table-import-wrapper").hide(),jQuery("#ts-advanced-table-scope-button").on("click",function(e){var t=jQuery("#"+jQuery(this).attr("data-toggle"));"true"==jQuery(this).attr("data-visible")?(t.slideFade(),jQuery(this).attr("data-visible","false")):(t.slideFade(),jQuery(this).attr("data-visible","true"))}),jQuery("#ts-advanced-table-input-button").on("click",function(e){var t=jQuery("#"+jQuery(this).attr("data-toggle"));"true"==jQuery(this).attr("data-visible")?(t.slideFade(),jQuery(this).attr("data-visible","false")):(t.slideFade(),jQuery(this).attr("data-visible","true"))}),jQuery(".ts-codestar-field-switcher").length>0&&jQuery(".ts-codestar-field-switcher").each(function(e,t){var a=jQuery(this).find("input.ts-codestar-checkbox[type=checkbox]"),r=jQuery(this).attr("data-value");a.on("change",function(e){1==(r=jQuery(this).prop("checked"))?a.attr("checked","checked").prop("checked",!0).val("1").attr("value","1"):0==r&&a.removeAttr("checked").prop("checked",!1).val("0").attr("value","0")})}),jQuery("#ts-advanced-table-handsontable-editor").on("contextmenu",function(e){if("undefined"==TS_Table_HandsOnTableMaster.getActiveEditor()||void 0==TS_Table_HandsOnTableMaster.getActiveEditor())return e.preventDefault(),e.stopPropagation(),TS_Table_HandsOnTableMaster.selectCell(TS_Table_HandsOnTableMaster.countRows()-1,0),!1}),jQuery("#ts-advanced-table-categories-selector").TS_TablesWP_DeepCheckBox({autoCheckChildren:!1,limitParentsOnly:!1,readableListTarget:!0,listItemBefore:'<span class="category">',listItemAfter:"</span>",listItemsDivider:", ",labelExceptBefore:" (except ",labelExceptAfter:")",labelExceptBetween:")",labelNothingIsSelected:"No Selection Yet!",onChange:function(e,t){var a=jQuery("#ts-advanced-table-cattags-output");a.empty(),0==e.length?a.append('<span class="ts-advanced-table-span-none ts-advanced-table-category-filtered" data-slug="ts-advanced-table-categories-none" data-level="0">'+a.attr("data-empty")+"</span>"):jQuery.each(e,function(e,t){jQuery("#ts-advanced-table-categories-listing").find(":checkbox").each(function(e,r){jQuery(this).attr("data-id")===t&&a.append('<span class="ts-advanced-table-span-cats ts-advanced-table-category-filtered" data-slug="'+jQuery(this).attr("data-id")+'" data-level="'+jQuery(this).attr("data-level")+'">'+jQuery(this).attr("data-name")+'<i class="ts-tableeditor-dismiss2"></i></span>')})}),jQuery("#ts-advanced-table-transfer-cats").val(e)}}),jQuery("body").on("click",".ts-advanced-table-category-filtered",function(e){e.preventDefault();var t=jQuery(this).attr("data-slug");jQuery("#ts-advanced-table-categories-listing").find("input#"+t).prop("checked","false").removeAttr("checked").trigger("change")}),jQuery(window).on("debouncedresize",function(e){n()}),jQuery("body").addClass("ts-advanced-table-fullscreen-inactive"),ht?(jQuery("#ts-advanced-table-toolbar-fullscreen").show(),jQuery(document).on(screenfull.raw.fullscreenchange,function(e){(pt=screenfull.isFullscreen)?(TS_Table_HandsOnTableMaster.updateSettings({comments:!1}),jQuery("#ts-advanced-table-title-wrapper").show(),jQuery("#ts-advanced-table-fullscreen-wrapper").css("padding","20px"),jQuery("#ts-advanced-table-button-fullscreen").attr("data-fullscreen-state","true"),jQuery("#ts-advanced-table-button-fullscreen i.ts-tableeditor-icon").removeClass("ts-tableeditor-fullscreen2").addClass("ts-tableeditor-contract2"),jQuery("#ts-advanced-table-button-fullscreen .ts-advanced-table-tooltip-content").html(jQuery("#ts-advanced-table-button-fullscreen").attr("data-fullscreen-exit")),jQuery("#ts-advanced-table-toolbar-wrapper").addClass("ts-advanced-table-fullscreen-active"),jQuery("#ts-advanced-table-toolbar-comments").hide(),jQuery("body").removeClass("ts-advanced-table-fullscreen-inactive").addClass("ts-advanced-table-fullscreen-enabled")):(TS_Table_HandsOnTableMaster.updateSettings({comments:Ee.checked}),jQuery("#ts-advanced-table-title-wrapper").hide(),jQuery("#ts-advanced-table-fullscreen-wrapper").css("padding","0px"),jQuery("#ts-advanced-table-button-fullscreen").attr("data-fullscreen-state","false"),jQuery("#ts-advanced-table-button-fullscreen i.ts-tableeditor-icon").removeClass("ts-tableeditor-contract2").addClass("ts-tableeditor-fullscreen2"),jQuery("#ts-advanced-table-button-fullscreen .ts-advanced-table-tooltip-content").html(jQuery("#ts-advanced-table-button-fullscreen").attr("data-fullscreen-enter")),jQuery("#ts-advanced-table-toolbar-wrapper").removeClass("ts-advanced-table-fullscreen-active"),Ee.checked&&jQuery("#ts-advanced-table-toolbar-comments").show(),jQuery("body").removeClass("ts-advanced-table-fullscreen-enabled").addClass("ts-advanced-table-fullscreen-inactive")),jQuery(".htComments").hide(),f(100),f(500)})):jQuery("#ts-advanced-table-toolbar-fullscreen").off().remove();var xt=function(){function t(e){var t=jQuery("#ts-advanced-table-celldata-editor");this.getInput=function(){return t},this.getEditor=function(){return e}}return t.prototype.getValue=function(){return this.getInput().val()},t.prototype.setValue=function(e){this.getInput().val(e)},t.prototype.checkWordInString=function(e,t){return new RegExp("\\b"+t+"\\b","i").test(e)},t.prototype.getSupportedFormulas=function(){return void 0===ruleJS()?null:ruleJS().helper.SUPPORTED_FORMULAS},t.prototype.subscribe=function(){that=this,this.getEditor().addHook("afterSelection",e.proxy(function(){this.getInput().prop("disabled",!1).removeAttr("disabled"),jQuery(tt).hide();var e=this.getEditor().getSelectedRange();We=e,this.setValue(this.getEditor().getDataAtCell(e.highlight.row,e.highlight.col)),Ft()},this)),this.getInput().on("input change keyup",e.proxy(function(e){var t=this.getEditor().getSelectedRange();void 0!==t&&"undefined"!==t||null==We||(t=We),this.getEditor().setDataAtCell(t.highlight.row,t.highlight.col,this.getValue())},this)),this.getInput().autocomplete({source:jQuery.map(this.getSupportedFormulas(),function(e){return"="+e})}),b()},t}(),St=!1,kt=!1,_t="",Et="",Ot=function(e){e?(at=!0,jQuery("#ts-advanced-table-toolbar-styling").show(),jQuery("#ts-advanced-table-toolbar-alignments").show(),jQuery("#ts-advanced-table-toolbar-links").show(),jQuery("#ts-advanced-table-toolbar-media").show(),jQuery("#ts-advanced-table-toolbar-icon").show(),jQuery("#ts-advanced-table-toolbar-comments").show(),jQuery("#ts-advanced-table-toolbar-formats").show(),jQuery("#ts-advanced-table-toolbar-dates").show(),jQuery("#ts-advanced-table-toolbar-decimals").show(),jQuery("#ts-advanced-table-toolbar-symbols").show(),jQuery("#ts-advanced-table-toolbar-placement").show(),jQuery("#ts-advanced-table-toolbar-locales").show(),jQuery("#ts-advanced-table-toolbar-reset").show(),jQuery("#ts-advanced-table-scope-comments").show()):(at=!1,jQuery("#ts-advanced-table-toolbar-styling").hide(),jQuery("#ts-advanced-table-toolbar-alignments").hide(),jQuery("#ts-advanced-table-toolbar-links").hide(),jQuery("#ts-advanced-table-toolbar-media").hide(),jQuery("#ts-advanced-table-toolbar-icon").hide(),jQuery("#ts-advanced-table-toolbar-comments").hide(),jQuery("#ts-advanced-table-toolbar-formats").hide(),jQuery("#ts-advanced-table-toolbar-dates").hide(),jQuery("#ts-advanced-table-toolbar-decimals").hide(),jQuery("#ts-advanced-table-toolbar-symbols").hide(),jQuery("#ts-advanced-table-toolbar-placement").hide(),jQuery("#ts-advanced-table-toolbar-locales").hide(),jQuery("#ts-advanced-table-toolbar-reset").hide(),jQuery("#ts-advanced-table-scope-comments").hide(),jQuery(Ee).removeAttr("checked").prop("checked",!1).val("0").attr("value","0").trigger("change"))},Ft=function(){jQuery.each(rt,function(e,t){var a=jQuery("#"+t),r=a.attr("data-submenu");"true"==a.attr("data-visible")&&(jQuery("#"+r).slideUp(250).removeClass("ts-advanced-table-submenu-visible").addClass("ts-advanced-table-submenu-hidden"),a.attr("data-visible","false"),rt.splice(jQuery.inArray(t,rt),1))})},It={bold:function(){s(this.getEditor(),"bold"),this.getEditor().render()},italic:function(){s(this.getEditor(),"italic"),this.getEditor().render()},nodecoration:function(){d(this.getEditor(),"nodecoration",["linethrough","overline","underline"]),this.getEditor().render()},underline:function(){d(this.getEditor(),"underline",["linethrough","overline","nodecoration"]),this.getEditor().render()},overline:function(){d(this.getEditor(),"overline",["linethrough","underline","nodecoration"]),this.getEditor().render()},linethrough:function(){d(this.getEditor(),"linethrough",["overline","underline","nodecoration"]),this.getEditor().render()},left:function(){d(this.getEditor(),"htLeft",["htRight","htCenter","htJustify"]),this.getEditor().render()},right:function(){d(this.getEditor(),"htRight",["htLeft","htCenter","htJustify"]),this.getEditor().render()},center:function(){d(this.getEditor(),"htCenter",["htLeft","htRight","htJustify"]),this.getEditor().render()},justify:function(){d(this.getEditor(),"htJustify",["htLeft","htRight","htCenter"]),this.getEditor().render()},top:function(){d(this.getEditor(),"htTop",["htMiddle","htBottom"]),this.getEditor().render()},middle:function(){d(this.getEditor(),"htMiddle",["htTop","htBottom"]),this.getEditor().render()},bottom:function(){d(this.getEditor(),"htBottom",["htTop","htMiddle"]),this.getEditor().render()},row:function(){var e=this.getEditor().getSelectedRange(),t=0;e&&(t=e.to.row+1),this.getEditor().alter("insert_row",t),f(500)},column:function(){this.getEditor().alter("insert_col",e("#example1 td.current").index()||0),f(500)},remove_row:function(){var e=this.getEditor().getSelectedRange();if(void 0!==e){var t=e.to.row-e.from.row+1,a=this.getEditor().getSelected(),r=[0,a[1],this.getEditor().countRows()-1,a[1]].join(",")==a.join(",");a[0]<0||r||(this.getEditor().alter("remove_row",e.from.row,t),f(500))}},remove_col:function(){var e=this.getEditor().getSelectedRange();if(void 0!==e){var t=e.to.col-e.from.col+1,a=this.getEditor().getSelected(),r=[a[0],0,a[0],this.getEditor().countCols()-1].join(",")==a.join(",");a[1]<0||r||(this.getEditor().alter("remove_col",e.from.col,t),f(500))}},color:function(e){"000000"===e?c(this.getEditor(),new RegExp("color-([0-9abcdef]{6})")):(yt.html(yt.html()+" .color-"+e+" {color:#"+e+" !important;}"),d(this.getEditor(),"color-"+e,/color\-([0-9a-f]{6})/)),jQuery("#ts-advanced-table-button-color").css({"border-bottom-color":"#"+e}),this.getEditor().render()},background:function(e){"ffffff"===e?c(this.getEditor(),new RegExp("background-([0-9abcdef]{6})")):(yt.html(yt.html()+" .background-"+e+" {background: #"+e+" !important;}"),d(this.getEditor(),"background-"+e,/background\-([0-9a-f]{6})/)),jQuery("#ts-advanced-table-button-background").css({"border-bottom-color":"#"+e}),this.getEditor().render()},linkURL:function(){var e=this.getEditor(),t=e.getSelectedRange(),a=void 0===t?{col:0,row:0}:t.highlight;return L=a,null!=(D=e.getDataAtCell(a.row,a.col))&&void 0!==D||(D=""),jQuery(ue).val(""),TS_VCSC_SweetAlert({title:jQuery("#ts-advanced-table-linkpicker-wrapper").attr("data-title"),text:"",html:jQuery("#ts-advanced-table-linkpicker-wrapper").html(),type:"info",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!0,showCancelButton:!0,showOtherButton:!1,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33d33",otherButtonColor:"#d33d33",confirmButtonText:jQuery("#ts-advanced-table-linkpicker-wrapper").attr("data-confirm"),cancelButtonText:jQuery("#ts-advanced-table-linkpicker-wrapper").attr("data-cancel"),otherButtonText:jQuery("#ts-advanced-table-linkpicker-wrapper").attr("data-other"),closeOnConfirm:!1,closeOnCancel:!0},function(e,t){var a=jQuery(".sweet-container").find("#ts-advanced-table-link-href-input").length?jQuery(".sweet-container").find("#ts-advanced-table-link-href-input").val():"",r=jQuery(".sweet-container").find("#ts-advanced-table-link-text-input").length?jQuery(".sweet-container").find("#ts-advanced-table-link-text-input").val():"";if(e&&""!=a&&""!=r){var n=jQuery(".sweet-container").find("#ts-advanced-table-link-title-input").length?jQuery(".sweet-container").find("#ts-advanced-table-link-title-input").val():"",l=jQuery(".sweet-container").find("#ts-advanced-table-link-insert-select").length?jQuery(".sweet-container").find("#ts-advanced-table-link-insert-select").find("option:selected").attr("data-value"):"",o=!!jQuery(".sweet-container").find("#ts-advanced-table-link-target-check").length&&jQuery(".sweet-container").find("#ts-advanced-table-link-target-check").prop("checked");o=o?"_blank":"_parent";var s=!!jQuery(".sweet-container").find("#ts-advanced-table-link-follow-check").length&&jQuery(".sweet-container").find("#ts-advanced-table-link-follow-check").prop("checked");z='<a href="'+a+'" target="'+o+'" title="'+n+'"'+(s=s?' rel="nofollow"':"")+">"+r+"</a>",P=""!=D&&"newline"==l?D+"<br/>"+z:""!=D&&"addline"==l?z+"<br/>"+D:""!=D&&"inline"==l?D+" "+z:""!=D&&"before"==l?z+" "+D:z,TS_Table_HandsOnTableMaster.setDataAtCell(L.row,L.col,P),TS_VCSC_SweetAlert.closeModal()}else if(e&&(""==a||""==r))return""==a?jQuery(".sweet-container").find("#ts-advanced-table-link-href-input").addClass("ts-advanced-table-link-error"):jQuery(".sweet-container").find("#ts-advanced-table-link-href-input").removeClass("ts-advanced-table-link-error"),""==r?jQuery(".sweet-container").find("#ts-advanced-table-link-text-input").addClass("ts-advanced-table-link-error"):jQuery(".sweet-container").find("#ts-advanced-table-link-text-input").removeClass("ts-advanced-table-link-error"),!1}),!1},imageWP:function(){var e,t=this.getEditor(),a=t.getSelectedRange(),r=void 0===a?{col:0,row:0}:a.highlight,n=this.getEditor().getDataAtCell(r.row,r.col);null==n||void 0===n?n="":""!=n&&(n+="<br/><br/>"),void 0===e&&(e=window.wp.media({title:jQuery("#ts-advanced-table-language-select-image").html(),button:{text:jQuery("#ts-advanced-table-language-submit-image").html()},multiple:!1})).on("select",function(){attachment=e.state().get("selection").first().toJSON(),t.setDataAtCell(r.row,r.col,n+'<img src="'+attachment.url+'" alt="'+attachment.alt+'"/>'),f(500)}),e.open()},imageURL:function(){var e=this.getEditor(),t=e.getSelectedRange(),a=void 0===t?{col:0,row:0}:t.highlight;return $=a,null!=(U=e.getDataAtCell(a.row,a.col))&&void 0!==U||(U=""),jQuery(ve).val(""),TS_VCSC_SweetAlert({title:jQuery("#ts-advanced-table-imagepicker-wrapper").attr("data-title"),text:"",html:jQuery("#ts-advanced-table-imagepicker-wrapper").html(),type:"info",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!0,showCancelButton:!0,showOtherButton:!1,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33d33",otherButtonColor:"#d33d33",confirmButtonText:jQuery("#ts-advanced-table-imagepicker-wrapper").attr("data-confirm"),cancelButtonText:jQuery("#ts-advanced-table-imagepicker-wrapper").attr("data-cancel"),otherButtonText:jQuery("#ts-advanced-table-imagepicker-wrapper").attr("data-other"),closeOnConfirm:!1,closeOnCancel:!0},function(e){var t=jQuery(".sweet-container").find("#ts-advanced-table-image-href-input").length?jQuery(".sweet-container").find("#ts-advanced-table-image-href-input").val():"";if(e&&""!=t){var a=jQuery(".sweet-container").find("#ts-advanced-table-image-alt-input").length?jQuery(".sweet-container").find("#ts-advanced-table-image-alt-input").val():"";""!=a&&(a=' alt="'+a+'"'),""!=U&&(U+="<br/><br/>"),TS_Table_HandsOnTableMaster.setDataAtCell($.row,$.col,D+'<img src="'+t+'"'+a+"/>"),TS_VCSC_SweetAlert.closeModal()}else if(e&&""==t)return event.preventDefault?event.preventDefault():event.returnValue=!1,event.stopPropagation(),!1}),!1},fontIcon:function(){var e=this.getEditor(),t=e.getSelectedRange(),r=void 0===t?{col:0,row:0}:t.highlight;return J=r,null!=(K=e.getDataAtCell(r.row,r.col))&&void 0!==K||(K=""),jQuery(fe).val(""),a(),!1},addEditComment:function(){var e=this.getEditor(),t=e.getSelectedRange(),a=e.getPlugin("comments");t&&(e.deselectCell(),a.contextMenuEvent=!0,a.setRange({from:t.from}),a.show(),a.editor.focus())},removeComment:function(){var e=this.getEditor(),t=e.getPlugin("comments"),a=o(e.getSelectedRange());a&&(t.contextMenuEvent=!0,t.removeCommentAtCell(a.from.row,a.from.col))},setFormat:function(e){var t=jQuery(e.target).attr("data-type"),a=jQuery(e.target).attr("data-format");this.setFormat(t,a),this.getEditor().render()},setDate:function(e){var t=jQuery(e.target).attr("data-type"),a=jQuery(e.target).attr("data-format");this.setDate(t,a),this.getEditor().render()},setTime:function(e){var t=jQuery(e.target).attr("data-type"),a=jQuery(e.target).attr("data-format");this.setTime(t,a),this.getEditor().render()},setDecimals:function(e){var t=jQuery(e.target).attr("data-type"),a=jQuery(e.target).attr("data-decimals");this.setDecimals(t,a),this.getEditor().render()},setSymbol:function(e){var t=jQuery(e.target).attr("data-type"),a=jQuery(e.target).attr("data-symbol");/^\d+$/.test(a)&&(a=O[a]),this.setSymbol(t,a),this.getEditor().render()},setLocale:function(e){var t=jQuery(e.target).attr("data-type"),a=jQuery(e.target).attr("data-locale");this.setLocale(t,a),this.getEditor().render()},setPlacement:function(e){var t=jQuery(e.target).attr("data-type"),a=jQuery(e.target).attr("data-placement");this.setPlacement(t,a),this.getEditor().render()},setRenderer:function(e){},resetColors:function(e){c(this.getEditor(),new RegExp("background-([0-9abcdef]{6})")),jQuery("#ts-advanced-table-button-color").css({"border-bottom-color":"#000000"}),c(this.getEditor(),new RegExp("color-([0-9abcdef]{6})")),jQuery("#ts-advanced-table-button-background").css({"border-bottom-color":"#ffffff"}),this.getEditor().render()},resetAll:function(e){jQuery("#ts-advanced-table-toolbar-wrapper button").removeClass("ts-advanced-table-button-active"),jQuery("#ts-advanced-table-toolbar-wrapper .ts-advanced-table-submenu-items a").removeClass("ts-advanced-table-button-active"),c(this.getEditor(),"bold"),c(this.getEditor(),"italic"),d(this.getEditor(),"",["nodecoration","linethrough","overline","underline"]),d(this.getEditor(),"",["htLeft","htRight","htCenter","htJustify"]),d(this.getEditor(),"",["htTop","htMiddle","htBottom"]),function(e,t){var a=o(e.getSelectedRange());if(void 0!==a&&"undefined"!==a||null==We)for(var r=a.from.row;r<=a.to.row;r++)for(var n=a.from.col;n<=a.to.col;n++){var l=e.getCellMeta(r,n);e.setCellMeta(l.row,l.col,"className",t)}}(this.getEditor(),Ke),c(this.getEditor(),new RegExp("background-([0-9abcdef]{6})")),jQuery("#ts-advanced-table-button-color").css({"border-bottom-color":"#000000"}),c(this.getEditor(),new RegExp("color-([0-9abcdef]{6})")),jQuery("#ts-advanced-table-button-background").css({"border-bottom-color":"#ffffff"}),this.getEditor().render()},fullScreen:function(e){ht&&($fullscreen_trigger=jQuery(e.target).parent(),$fullscreen_state="true"==$fullscreen_trigger.attr("data-fullscreen-state"),$fullscreen_state?($fullscreen_trigger.attr("data-fullscreen-state","false"),jQuery("#ts-advanced-table-fullscreen-wrapper").css("padding","0px")):($fullscreen_trigger.attr("data-fullscreen-state","true"),jQuery("#ts-advanced-table-fullscreen-wrapper").css("padding","20px")),screenfull.toggle(jQuery("#ts-advanced-table-fullscreen-wrapper")[0]))}},Mt=function(e,t){var a=["left-none","left-none","left-none","left-none","left-none","left-none","left-none","left-none","left-none","left-space","left-space","left-space","left-space","left-space","left-space","left-space","left-space","left-space","right-none","right-none","right-none","right-none","right-none","right-none","right-none","right-none","right-none","right-space","right-space","right-space","right-space","right-space","right-space","right-space","right-space","right-space"],r=["$0","$00","$0,0","$0,0.0","$0,0.00","$0,0.000","$0,0.0000","$0,0.00000","$0,0.000000","$ 0","$ 00","$ 0,0","$ 0,0.0","$ 0,0.00","$ 0,0.000","$ 0,0.0000","$ 0,0.00000","$ 0,0.000000","0$","00$","00$","0,0$","0,0.0$","0,0.00$","0,0.000$","0,0.0000$","0,0.00000$","0,0.000000$","0 $","00 $","0,0 $","0,0.0 $","0,0.00 $","0,0.000 $","0,0.0000 $","0,0.00000 $","0,0.000000 $"],n=-1,l="";return"string"==t?l=(n=jQuery.inArray(e,a))>-1?r[n]:qe:"format"==t&&(l=(n=jQuery.inArray(e,r))>-1?a[n]:Mt(qe,"format")),l},Bt=function(){function t(e,t){var a=jQuery(e);this.getContainer=function(){return a},this.getEditor=function(){return t}}return t.prototype.setFormat=function(e,t,a){var r=this.getEditor(),n=o(r.getSelectedRange()),s="",d="",c="text";if(void 0===n||"undefined"===n){if(null==We)return;n=We}c="percent"==e||"currency"==e||"number"==e?"numeric":"date"==e?"date":"time"==e?"time":"text";for(var u=n.from.row;u<=n.to.row;u++)for(var v=n.from.col;v<=n.to.col;v++){var f=r.getCellMeta(u,v),b=r.getDataAtCell(u,v);if(/<[a-z\][\s\S]*>/i.test(b))return jQuery(".ts-advanced-table-submenu-format").removeClass("active"),void jQuery(".text-format").addClass("active");if(l(b))m=!0;else var m=!1;if(f.format=t,null!=b&&void 0!=b&&("percent"==e?"="!==b[0]&&(b=String(b).replace(/[^\d.-]/g,""),"percent"!==f.formatType&&(b/=100)):"percent"==f.formatType&&"="!==b[0]&&(b*=100)),"currency"==e&&""!=b?(jQuery("#ts-advanced-table-toolbar-symbols").show(),jQuery("#ts-advanced-table-toolbar-locales").show()):(jQuery("#ts-advanced-table-toolbar-symbols").hide(),"number"==e||"percent"==e?jQuery("#ts-advanced-table-toolbar-locales").show():jQuery("#ts-advanced-table-toolbar-locales").hide(),null!=f.language&&void 0!=f.language?f.symbol=numbro.cultureData(f.language).currency.symbol:f.symbol=numbro.cultureData().currency.symbol),"number"==e||"numeric"==e||"currency"==e||"percent"==e){if(null!=f.decimals&&void 0!=f.decimals){for(s=t.split(".")[0],d=void 0!==t.split(".")[1]?(d=t.split(".")[1]).replace(/^0+/,""):"",f.decimals>0&&(s+="."),i=0;i<f.decimals;i++)s+="0";s+=d,f.format=s}jQuery("#ts-advanced-table-toolbar-decimals").show()}else jQuery("#ts-advanced-table-toolbar-decimals").hide();if("date"!=e||m||""==b)jQuery("#ts-advanced-table-toolbar-dates").hide();else{f.dateFormat=t,f.correctFormat=!0;var h=moment(b,t);h.isValid()&&(b=h.format(t)),jQuery("#ts-advanced-table-toolbar-dates").show()}if("time"!=e||m||""==b)jQuery("#ts-advanced-table-toolbar-times").hide();else{f.timeFormat=t,f.correctFormat=!0;var p=moment(b,t);p.isValid()&&(b=p.format(t)),jQuery("#ts-advanced-table-toolbar-times").show()}delete f.renderer,delete f.editor,delete f.validator,"date"!=e||"date"==e&&!m||"time"==e&&!m?(f.formatType=e,f.type=c):"date"==e&&m?(f.formatType="number",f.type="numeric"):"time"==e&&m&&(f.formatType="number",f.type="numeric"),f.renderer="text"==e?g:void 0,r.validateCell(b,f,function(){},"validateCells"),r.setDataAtCell(f.row,f.col,b),"text"==e?(jQuery("#ts-advanced-table-toolbar-links").show(),jQuery("#ts-advanced-table-toolbar-media").show(),jQuery("#ts-advanced-table-toolbar-icon").show(),jQuery("#ts-advanced-table-toolbar-locales").hide(),jQuery("#ts-advanced-table-toolbar-symbols").hide(),jQuery("#ts-advanced-table-toolbar-decimals").hide(),jQuery("#ts-advanced-table-toolbar-placement").hide(),jQuery("#ts-advanced-table-toolbar-dates").hide(),jQuery("#ts-advanced-table-toolbar-times").hide()):(jQuery("#ts-advanced-table-toolbar-links").hide(),jQuery("#ts-advanced-table-toolbar-media").hide(),jQuery("#ts-advanced-table-toolbar-icon").hide()),"time"==e?jQuery("#ts-advanced-table-toolbar-times").show():jQuery("#ts-advanced-table-toolbar-times").hide()}},t.prototype.setDate=function(e,t,a){var r=this.getEditor(),n=o(r.getSelectedRange()),s="";if(void 0===n||"undefined"===n){if(null==We)return;n=We}for(var d=n.from.row;d<=n.to.row;d++)for(var i=n.from.col;i<=n.to.col;i++){var c=r.getCellMeta(d,i),u=r.getDataAtCell(d,i);if(/<[a-z\][\s\S]*>/i.test(u))return jQuery(".ts-advanced-table-submenu-format").removeClass("active"),void jQuery(".text-format").addClass("active");if(l(u))v=!0;else var v=!1;c.format=t,v||""==u?v&&(c.formatType="number",c.type="numeric",c.dateFormat=t):(s=null!=c.momentdate&&void 0!=c.momentdate?c.momentdate:moment(u,c.dateFormat).utc().valueOf(),c.correctFormat=!0,c.dateFormat=t,u=moment(s).format(t)),delete c.renderer,delete c.editor,delete c.validator,""!=u&&(r.validateCell(u,c,function(){},"validateCells"),r.setDataAtCell(c.row,c.col,u))}jQuery(".ts-advanced-table-submenu-date").removeClass("active"),jQuery("."+jQuery.inArray(t,Ze)+"-date").addClass("active")},t.prototype.setTime=function(e,t,a){var r=this.getEditor(),n=o(r.getSelectedRange()),s=null;if(void 0===n||"undefined"===n){if(null==We)return;n=We}for(var d=n.from.row;d<=n.to.row;d++)for(var i=n.from.col;i<=n.to.col;i++){var c=r.getCellMeta(d,i),u=r.getDataAtCell(d,i);if(/<[a-z\][\s\S]*>/i.test(u))return jQuery(".ts-advanced-table-submenu-format").removeClass("active"),void jQuery(".text-format").addClass("active");if(l(u))v=!0;else var v=!1;c.format=t,v||""==u?v&&(c.formatType="number",c.type="numeric",c.dateFormat=t):(null!=c.timeFormat&&void 0!=c.timeFormat?c.timeFormat:moment(u,c.timeFormat),c.correctFormat=!0,c.timeFormat=t,(s=moment(u,t)).isValid()&&(u=s.format(t))),delete c.renderer,delete c.editor,delete c.validator,""!=u&&(r.validateCell(u,c,function(){},"validateCells"),r.setDataAtCell(c.row,c.col,u))}jQuery(".ts-advanced-table-submenu-time").removeClass("active"),jQuery("."+jQuery.inArray(t,et)+"-time").addClass("active")},t.prototype.setDecimals=function(e,t,a){var r=this.getEditor(),n=o(r.getSelectedRange()),s="",d="",c="text";if(void 0===n||"undefined"===n){if(null==We)return;n=We}for(var u=n.from.row;u<=n.to.row;u++)for(var v=n.from.col;v<=n.to.col;v++){var f=r.getCellMeta(u,v),b=r.getDataAtCell(u,v);if(c=f.formatType,s=f.format,d=f.format,/<[a-z\][\s\S]*>/i.test(b))return jQuery(".ts-advanced-table-submenu-format").removeClass("active"),void jQuery(".text-format").addClass("active");if("number"!=c&&"numeric"!=c&&"currency"!=c&&"percent"!=c)return;if(l(b));else;for(s=s.split(".")[0],d=void 0!==d.split(".")[1]?(d=d.split(".")[1]).replace(/^0+/,""):"",t>0&&(s+="."),i=0;i<t;i++)s+="0";s+=d,f.decimals=t,f.format=s,delete f.renderer,delete f.editor,delete f.validator,r.validateCell(b,f,function(){},"validateCells"),r.setDataAtCell(f.row,f.col,b)}jQuery(".ts-advanced-table-submenu-decimal").removeClass("active"),jQuery("."+t+"-decimals").addClass("active")},t.prototype.setLocale=function(e,t,a){var r=this.getEditor(),n=o(r.getSelectedRange());if(""!=t)s=t;else var s=E;if(void 0===n||"undefined"===n){if(null==We)return;n=We}for(var d=n.from.row;d<=n.to.row;d++)for(var i=n.from.col;i<=n.to.col;i++){var c=r.getCellMeta(d,i),u=r.getDataAtCell(d,i);if(/<[a-z\][\s\S]*>/i.test(u))return jQuery(".ts-advanced-table-submenu-format").removeClass("active"),void jQuery(".text-format").addClass("active");if(l(u));else;delete c.renderer,delete c.editor,delete c.validator,c.language=s,r.validateCell(u,c,function(){},"validateCells"),r.setDataAtCell(c.row,c.col,u)}},t.prototype.setSymbol=function(e,t,a){var r=this.getEditor(),n=o(r.getSelectedRange());numbro.cultureData().currency.symbol;if(void 0===n||"undefined"===n){if(null==We)return;n=We}for(var s=n.from.row;s<=n.to.row;s++)for(var d=n.from.col;d<=n.to.col;d++){var i=r.getCellMeta(s,d),c=r.getDataAtCell(s,d);if(/<[a-z\][\s\S]*>/i.test(c))return jQuery(".ts-advanced-table-submenu-format").removeClass("active"),void jQuery(".text-format").addClass("active");if(l(c));else;if("currency"!=i.formatType)return;i.symbol=t,delete i.renderer,delete i.editor,delete i.validator,r.validateCell(c,i,function(){},"validateCells"),r.setDataAtCell(i.row,i.col,c)}},t.prototype.setPlacement=function(e,t,a){var r=this.getEditor(),n=o(r.getSelectedRange());if(void 0===n||"undefined"===n){if(null==We)return;n=We}for(var s=n.from.row;s<=n.to.row;s++)for(var d=n.from.col;d<=n.to.col;d++){var i=r.getCellMeta(s,d),c=r.getDataAtCell(s,d);if(/<[a-z\][\s\S]*>/i.test(c))return jQuery(".ts-advanced-table-submenu-format").removeClass("active"),void jQuery(".text-format").addClass("active");if(l(c));else;if("currency"!=i.formatType)return;i.format=Mt(t,"string"),i.placement=t,delete i.renderer,delete i.editor,delete i.validator,r.validateCell(c,i,function(){},"validateCells"),r.setDataAtCell(i.row,i.col,c)}},t.prototype.subscribe=function(){var t=this;this.getContainer().find("button, .ts-advanced-table-submenu-items > a").each(function(){var e=jQuery(this);if(void 0!==e.attr("data-callback")&&void 0!==It[e.attr("data-callback")]){var a=e.attr("data-callback");e.attr("data-toolbar");"color"==a||"background"==a?e.off("click").on("click",function(e){Ft()}):e.off("click").on("click",function(r){r.preventDefault(),$self=jQuery(this),"setFormat"==a?(jQuery(".ts-advanced-table-submenu-format").removeClass("active"),jQuery("."+e.attr("data-type")+"-format").addClass("active")):"setLocale"==a?(jQuery(".ts-advanced-table-submenu-locale").removeClass("active"),jQuery("."+e.attr("data-locale").toLowerCase()+"-locale").addClass("active")):"setSymbol"==a?(jQuery(".ts-advanced-table-submenu-symbol").removeClass("active"),jQuery("."+e.attr("data-symbol").toLowerCase()+"-symbol").addClass("active")):"setPlacement"==a&&(jQuery(".ts-advanced-table-submenu-placement").removeClass("active"),jQuery("."+e.attr("data-placement").toLowerCase()+"-placement").addClass("active")),It[a].apply(t,[r]),Ft()})}});var a=jQuery("#ts-advanced-table-button-color").ColorPicker({flat:!1,onHide:function(e,t,a){},onSubmit:function(e,t,a){},onChange:function(e,a,r){Et=a,kt||(setTimeout(function(){kt=!1,t.useCallbacks("color",Et)},500),kt=!0)}}),r=jQuery("#ts-advanced-table-button-background").ColorPicker({flat:!1,onHide:function(e,t,a){},onSubmit:function(e,t,a){},onChange:function(e,a,r){_t=a,St||(setTimeout(function(){St=!1,t.useCallbacks("background",_t)},500),St=!0)}});t.getEditor().addHook("afterSelection",function(n,l,o,s){if(!at)return!1;if(ht&&screenfull.isFullscreen?jQuery("#ts-advanced-table-toolbar-comments").hide():Ee.checked?jQuery("#ts-advanced-table-toolbar-comments").show():jQuery("#ts-advanced-table-toolbar-comments").hide(),n===o&&l===s){var d=t.getEditor().getCell(n,l);if(d){var i=t.getEditor().getDataAtCell(n,l),c=t.getEditor().getCellMeta(n,l),v=/color\-([0-9abcdef]{6})/.exec(d.className),f=/background\-([0-9abcdef]{6})/.exec(d.className);/<[a-z\][\s\S]*>/i.test(i)?(jQuery("#ts-advanced-table-toolbar-formats").hide(),jQuery("#ts-advanced-table-toolbar-locales").hide(),jQuery("#ts-advanced-table-toolbar-symbols").hide(),jQuery("#ts-advanced-table-toolbar-decimals").hide(),jQuery("#ts-advanced-table-toolbar-placement").hide(),jQuery("#ts-advanced-table-toolbar-dates").hide(),jQuery("#ts-advanced-table-toolbar-times").hide()):(jQuery("#ts-advanced-table-toolbar-formats").show(),"currency"==c.formatType||"number"==c.formatType||"percent"==c.formatType?(jQuery("#ts-advanced-table-toolbar-locales").show(),jQuery("#ts-advanced-table-toolbar-decimals").show()):(jQuery("#ts-advanced-table-toolbar-locales").hide(),jQuery("#ts-advanced-table-toolbar-decimals").hide()),"currency"==c.formatType&&""!=i?(jQuery("#ts-advanced-table-toolbar-symbols").show(),jQuery("#ts-advanced-table-toolbar-placement").show()):(jQuery("#ts-advanced-table-toolbar-symbols").hide(),jQuery("#ts-advanced-table-toolbar-placement").hide()),"date"==c.formatType&&""!=i?jQuery("#ts-advanced-table-toolbar-dates").show():jQuery("#ts-advanced-table-toolbar-dates").hide()),u(!0,c.className),null!==v?(a.css({borderBottomColor:"#"+v[1]}),e("#ts-advanced-table-button-color").ColorPickerSetColor("#"+v[1])):(a.css({borderBottomColor:"#000000"}),e("#ts-advanced-table-button-color").ColorPickerSetColor("#000000")),null!==f&&"ffffff"!==f[1]?(r.css({borderBottomColor:"#"+f[1]}),e("#ts-advanced-table-button-background").ColorPickerSetColor("#"+f[1])):(r.css({borderBottomColor:"#ffffff"}),e("#ts-advanced-table-button-background").ColorPickerSetColor("#ffffff"));var b=c.formatType||"text";jQuery(".ts-advanced-table-submenu-format").removeClass("active"),jQuery("."+b+"-format").addClass("active"),"text"==b?(jQuery("#ts-advanced-table-toolbar-links").show(),jQuery("#ts-advanced-table-toolbar-media").show(),jQuery("#ts-advanced-table-toolbar-icon").show()):(jQuery("#ts-advanced-table-toolbar-links").hide(),jQuery("#ts-advanced-table-toolbar-media").hide(),jQuery("#ts-advanced-table-toolbar-icon").hide()),"time"==b?jQuery("#ts-advanced-table-toolbar-times").show():jQuery("#ts-advanced-table-toolbar-times").hide();var m=c.language||E;jQuery(".ts-advanced-table-submenu-locale").removeClass("active");try{jQuery("."+m.toLowerCase()+"-locale").addClass("active")}catch(e){}var h=c.symbol||F[m]||numbro.cultureData().currency.symbol;I.hasOwnProperty(h)&&(h=I[h]),jQuery(".ts-advanced-table-submenu-symbol").removeClass("active");try{jQuery("."+h.toLowerCase()+"-symbol").addClass("active")}catch(e){}var p=c.placement||Mt(qe,"format");jQuery(".ts-advanced-table-submenu-placement").removeClass("active");try{jQuery("."+p.toLowerCase()+"-placement").addClass("active")}catch(e){}var g=c.dateFormat;jQuery(".ts-advanced-table-submenu-date").removeClass("active");try{jQuery("."+jQuery.inArray(g,Ze)+"-date").addClass("active")}catch(e){}var y=c.timeFormat;jQuery(".ts-advanced-table-submenu-time").removeClass("active");try{jQuery("."+jQuery.inArray(y,et)+"-time").addClass("active")}catch(e){}var j=c.decimals;jQuery(".ts-advanced-table-submenu-decimal").removeClass("active");try{jQuery("."+j+"-decimals").addClass("active")}catch(e){}}}else{i=t.getEditor().getDataAtCell(n,l);/<[a-z\][\s\S]*>/i.test(i)?(jQuery("#ts-advanced-table-toolbar-formats").hide(),jQuery("#ts-advanced-table-toolbar-locales").hide(),jQuery("#ts-advanced-table-toolbar-placement").hide()):(jQuery("#ts-advanced-table-toolbar-formats").show(),jQuery("#ts-advanced-table-toolbar-locales").show(),jQuery("#ts-advanced-table-toolbar-placement").show())}}),this.getContainer().find("button.ts-advanced-table-tooltip-holder").each(function(){var e=jQuery(this);e.on("click",function(t){var a=jQuery(this),r=a.attr("data-submenu"),n="true"==a.attr("data-visible");Ft(),n?(jQuery("#"+r).slideUp(250).removeClass("ts-advanced-table-submenu-visible").addClass("ts-advanced-table-submenu-hidden"),a.attr("data-visible","false"),rt.splice(jQuery.inArray(e.attr("id"),rt),1)):(jQuery("#"+r).slideDown(250).removeClass("ts-advanced-table-submenu-hidden").addClass("ts-advanced-table-submenu-visible"),a.attr("data-visible","true"),rt.push(e.attr("id")))}),nt.push(e.attr("id"))}),b()},t.prototype.useCallbacks=function(e){if(void 0===It[e])throw new Error('The callback "'+e+'" does not exist.');It[e].apply(this,Array.prototype.slice.call(arguments,1,arguments.length))},t.prototype.addCallbacks=function(e,t){It[e]=t},t.prototype.getCallbacks=function(){return It},t}();ut=v();var Ht,At,Rt=parseInt(jQuery(G).parent().attr("data-height-max")),Nt=parseInt(jQuery(G).parent().attr("data-height-min")),Dt=40,Pt=jQuery("#ts-advanced-table-title-wrapper").outerHeight(!0)+jQuery("#ts-advanced-table-celldata-wrapper").outerHeight(!0)+jQuery("#ts-advanced-table-toolbar-wrapper").outerHeight(!0)+jQuery("#wpadminbar").outerHeight(),Lt=parseInt(jQuery("#wpbody-content").css("padding-bottom").replace("px",""));if(jQuery(xe).prop("checked"))zt=jQuery("#ts-advanced-table-search-wrapper").outerHeight(!0);else var zt=0;var Ut,$t,Wt,Kt;Handsontable.dom.addEvent(window,"resize",b),function(){Me=jQuery(re).val();try{Me=jQuery.parseJSON(Me)}catch(e){console.log(e,Me),Me=[]}""!=Me&&null!==Me&&jQuery.isArray(Me)||(Me=[]),Be=jQuery(ne).val();try{Be=jQuery.parseJSON(Be)}catch(e){console.log(e,Be),Be=[]}""!=Be&&null!==Be&&jQuery.isArray(Be)||(Be=[]),He=jQuery(ae).val();try{He=jQuery.parseJSON(He)}catch(e){console.log(e,He),He=[]}""!=He&&null!==He&&jQuery.isArray(He)||(He=[]),Ae=jQuery(oe).val();try{Ae=jQuery.parseJSON(Ae)}catch(e){console.log(e,Ae),Ae=[]}""!=Ae&&null!==Ae&&"object"==typeof Ae||(Ae={}),Re=void 0==Ae.savemeta||"undefined"==Ae.savemeta||"true"==Ae.savemeta,Ne=void 0!=Ae.usesearch&&"undefined"!=Ae.usesearch&&"true"==Ae.usesearch,De=void 0!=Ae.useformulas&&"undefined"!=Ae.useformulas&&"true"==Ae.useformulas,Pe=void 0!=Ae.usecharts&&"undefined"!=Ae.usecharts&&"true"==Ae.usecharts,Le=void 0!=Ae.usemoving&&"undefined"!=Ae.usemoving&&"true"==Ae.usemoving,ze=void 0!=Ae.usecomments&&"undefined"!=Ae.usecomments&&"true"==Ae.usecomments,void 0==Ae.usemerging||"undefined"==Ae.usemerging?(Ue=!1,He.length>0&&(Ue=!0)):Ue="true"==Ae.usemerging,""!=(bt=jQuery(ee).val())&&0!=bt||(bt=parseInt(jQuery("#ts-advanced-table-defaults-newrows").val())),""!=(ft=jQuery(te).val())&&0!=ft||(ft=parseInt(jQuery("#ts-advanced-table-defaults-newcolumns").val())),Ne?(jQuery("#ts-advanced-table-search-wrapper").show(),jQuery(xe).attr("checked","checked").prop("checked",!0).val("1").attr("value","1").trigger("change")):(jQuery("#ts-advanced-table-search-wrapper").hide(),jQuery(xe).removeAttr("checked").prop("checked",!1).val("0").attr("value","0").trigger("change")),De?jQuery(Ce).attr("checked","checked").prop("checked",!0).val("1").attr("value","1").trigger("change"):jQuery(Ce).removeAttr("checked").prop("checked",!1).val("0").attr("value","0").trigger("change"),Le?jQuery(Oe).attr("checked","checked").prop("checked",!0).val("1").attr("value","1").trigger("change"):jQuery(Oe).removeAttr("checked").prop("checked",!1).val("0").attr("value","0").trigger("change"),Re?(at=!0,jQuery(Te).attr("checked","checked").prop("checked",!0).val("1").attr("value","1").trigger("change")):(at=!1,jQuery(Te).removeAttr("checked").prop("checked",!1).val("0").attr("value","0").trigger("change")),Ot(at)}(),(He=function(){var e={},t=[];return jQuery.each(He,function(a,r){(e={}).row=r.row,e.col=r.col,e.rowspan=r.rowspan,e.colspan=r.colspan,t.push(e)}),t}()).length>0?(jQuery(_e).attr("checked","checked").prop("checked",!0).val("1").attr("value","1"),Ue=!0):(jQuery(_e).removeAttr("checked").prop("checked",!1).val("0").attr("value","0"),He=!1,Ue=!1);TS_Table_HandsOnTableMaster=new Handsontable(G,{width:m,height:h,data:Me.length>0?Me:null,mergeCells:Me.length>0&&He,startRows:bt,startCols:ft,rowHeights:36,colWidths:p,stretchH:"all",rowHeaders:!0,colHeaders:!0,comments:!0,contextMenu:"true"==jQuery(ge).val(),customBorders:!1,copyPaste:!0,contextMenuCopyPaste:!1,language:E,className:Ke,formulas:De,dateFormat:Ve,timeFormat:Je,correctFormat:!0,autoWrapRow:!0,autoColumnSize:!0,currentRowClassName:"currentRow",currentColClassName:"currentCol",invalidCellClassName:"true"==jQuery(ye).val()?"htInvalid":"htInvalidNone",manualColumnResize:!0,manualRowResize:!0,manualColumnMove:!1,manualRowMove:!1,fixedRowsTop:"true"==jQuery(Qe).val()?1:0,fixedColumnsLeft:"true"==jQuery(we).val()?1:0,persistentState:!1,outsideClickDeselects:!1,minSpareRows:1,search:Ne,undo:!0,renderer:g,afterInit:function(){setTimeout(function(){!function(){yt.length||(yt=jQuery("<style/>",{id:"ts-advanced-table-styles"}),jQuery("head").append(yt));var e="",t=!1;at&&(jQuery.each(Be,function(a,r){t=void 0!==r.value&&""!=r.value,void 0!==r.type&&""!=r.type&&"text"!=r.type&&t?(TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"type",r.type),TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"renderer",void 0)):(TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"type","text"),TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"renderer",g)),void 0!==r.dataType&&""!=r.dataType&&t?TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"dataType",r.dataType):TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"dataType","text"),void 0!==r.formatType&&""!=r.formatType&&t?(TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"formatType",r.formatType),void 0!==r.format&&""!=r.format&&("date"==r.formatType?(TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"format",r.format),void 0!==r.dateFormat&&""!=r.dateFormat&&TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"dateFormat",r.dateFormat),""==r.value||l(r.value)||(void 0!==r.momentdate&&""!=r.momentdate?e=moment(r.momentdate).format(r.format):(e=moment(r.value,r.format).utc().valueOf(),e=moment(e).format(r.format)),TS_Table_HandsOnTableMaster.setDataAtCell(parseInt(r.row),parseInt(r.column),e))):"time"==r.formatType?(TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"format",Je),void 0!==r.timeFormat&&""!=r.timeFormat&&TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"timeFormat",r.timeFormat)):TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"format",r.format))):(TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"formatType","text"),TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"format","text")),void 0!==r.comment&&""!=r.comment&&(ze=!0,TS_Table_HandsOnTableComments.setCommentAtCell(parseInt(r.row),parseInt(r.column),r.comment)),void 0!==r.locale&&""!=r.locale&&t?(TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"language",r.locale),void 0!==r.symbol&&""!=r.symbol?TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"symbol",r.symbol):F.hasOwnProperty(r.locale)?TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"symbol",F[r.locale]):TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"symbol",numbro.cultureData(r.locale).currency.symbol)):void 0!==r.symbol&&""!=r.symbol?TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"symbol",r.symbol):F.hasOwnProperty(E)?TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"symbol",F[E]):TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"symbol",numbro.cultureData().currency.symbol),void 0!==r.decimals&&""!=r.decimals&&TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"decimals",r.decimals),void 0!==r.placement&&""!=r.placement?TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"placement",r.placement):TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"placement",Mt(r.format,"format")),void 0!==r.className&&""!=r.className&&(jt=r.className.split(" "),TS_Table_HandsOnTableMaster.setCellMeta(parseInt(r.row),parseInt(r.column),"className",r.className),jQuery.each(jt,function(e,t){/color\-([0-9a-f]{6})/i.test(t)&&jQuery.inArray(t,Qt)&&Qt.push(t),/background\-([0-9a-f]{6})/i.test(t)&&jQuery.inArray(t,wt)&&wt.push(t)}))}),Qt.length>0&&jQuery.each(Qt,function(e,t){t=t.replace("color-",""),yt.html(yt.html()+" .color-"+t+" {color:#"+t+" !important;}")}),wt.length>0&&jQuery.each(wt,function(e,t){t=t.replace("background-",""),yt.html(yt.html()+" .background-"+t+" {background:#"+t+" !important;}")})),"true"==jQuery(ge).val()&&jQuery(Se).attr("checked","checked").prop("checked",!0).val("1").attr("value","1").trigger("change"),"true"==jQuery(ye).val()&&jQuery(ke).attr("checked","checked").prop("checked",!0).val("1").attr("value","1").trigger("change"),"true"==jQuery(Qe).val()?(jQuery(G).addClass("htRowFixed"),jQuery(Fe).attr("checked","checked").prop("checked",!0).val("1").attr("value","1").trigger("change")):jQuery(G).removeClass("htRowFixed"),"true"==jQuery(we).val()?(jQuery(G).addClass("htColumnFixed"),jQuery(Ie).attr("checked","checked").prop("checked",!0).val("1").attr("value","1").trigger("change")):jQuery(G).removeClass("htColumnFixed"),TS_Table_HandsOnTableMaster.updateSettings({comments:ze,manualColumnMove:Le,manualRowMove:Le,mergeCells:He}),ze?(jQuery("#ts-advanced-table-toolbar-comments").show(),jQuery(Ee).attr("checked","checked").prop("checked",!0).val("1").attr("value","1").trigger("change")):(jQuery("#ts-advanced-table-toolbar-comments").hide(),jQuery(Ee).removeAttr("checked").prop("checked",!1).val("0").attr("value","0").trigger("change")),Ue?jQuery(_e).attr("checked","checked").prop("checked",!0).val("1").attr("value","1").trigger("change"):jQuery(_e).removeAttr("checked").prop("checked",!1).val("0").attr("value","0").trigger("change")}(),b(),jQuery(Y).hide(),$e=!0,jQuery(X).val(""),jQuery(Z).val(""),jQuery(ee).val(""),jQuery(te).val(""),jQuery(ae).val(""),jQuery(re).val(""),jQuery(ne).val(""),jQuery(le).val(""),jQuery(oe).val(""),jQuery(me).val(""),jQuery(he).val(""),jQuery(pe).val(""),jQuery(ge).val(""),jQuery(je).val(""),jQuery(je).val(""),jQuery(Qe).val(""),jQuery(we).val("")},250)}}),TS_Table_HandsOnTableComments=TS_Table_HandsOnTableMaster.getPlugin("comments"),jQuery("body").on("click",function(e){return!(jQuery(e.target).parents("#ts-advanced-table-toolbar-wrapper").length>0||jQuery(e.target).parents("#ts-advanced-table-handsontable-wrapper").length>0)&&(!(jQuery(e.target).hasClass("ts-advanced-table-handsontable-wrapper")||jQuery(e.target).parents(".ts-advanced-table-submenu-content").length>0||jQuery(e.target).parents(".colorpicker").length>0)&&void(0==rt.length?(jQuery(e.target).hasClass("ts-advanced-table-celldata-editor")||(TS_Table_HandsOnTableMaster.deselectCell(),jQuery("#ts-advanced-table-celldata-editor").val("").prop("disabled",!0).attr("disabled","disabled")),jQuery(tt).show()):Ft()))});new Bt("#ts-advanced-table-toolbar-wrapper",TS_Table_HandsOnTableMaster).subscribe();new xt(TS_Table_HandsOnTableMaster).subscribe(),jQuery(be).on("paste change keyup input",function(e){TS_Table_HandsOnTableMaster.search.query(this.value);TS_Table_HandsOnTableMaster.render()}),jQuery(ce).on("paste change keyup input",function(e){e.preventDefault(),""!=this.value?jQuery("#ts-advanced-table-name-repeater").empty().text(this.value):jQuery("#ts-advanced-table-name-repeater").empty().text(jQuery("#ts-advanced-table-name-repeater").attr("data-empty"))}),Handsontable.dom.addEvent(Te,"click",function(){at=!!this.checked,Ot(at)}),Handsontable.dom.addEvent(Ce,"click",function(){TS_Table_HandsOnTableMaster.updateSettings({formulas:this.checked})}),Handsontable.dom.addEvent(xe,"click",function(){this.checked?jQuery("#ts-advanced-table-search-wrapper").show():jQuery("#ts-advanced-table-search-wrapper").hide(),TS_Table_HandsOnTableMaster.updateSettings({search:this.checked}),b()}),Handsontable.dom.addEvent(Se,"click",function(){TS_Table_HandsOnTableMaster.updateSettings({contextMenu:this.checked})}),Handsontable.dom.addEvent(_e,"click",function(){TS_Table_HandsOnTableMaster.updateSettings({mergeCells:this.checked})}),Handsontable.dom.addEvent(Oe,"click",function(){TS_Table_HandsOnTableMaster.updateSettings({manualColumnMove:this.checked,manualRowMove:this.checked})}),Handsontable.dom.addEvent(Ee,"click",function(){this.checked?jQuery("#ts-advanced-table-toolbar-comments").show():jQuery("#ts-advanced-table-toolbar-comments").hide(),TS_Table_HandsOnTableMaster.updateSettings({comments:this.checked})}),Handsontable.dom.addEvent(ke,"click",function(){this.checked?TS_Table_HandsOnTableMaster.updateSettings({invalidCellClassName:"htInvalid"}):TS_Table_HandsOnTableMaster.updateSettings({invalidCellClassName:"htInvalidNone"}),TS_Table_HandsOnTableMaster.render(),TS_Table_HandsOnTableMaster.validateCells()}),Handsontable.dom.addEvent(Fe,"click",function(){this.checked?jQuery(G).addClass("htRowFixed"):jQuery(G).removeClass("htRowFixed"),TS_Table_HandsOnTableMaster.updateSettings({fixedRowsTop:this.checked?1:0})}),Handsontable.dom.addEvent(Ie,"click",function(){this.checked?jQuery(G).addClass("htColumnFixed"):jQuery(G).removeClass("htColumnFixed"),TS_Table_HandsOnTableMaster.updateSettings({fixedColumnsLeft:this.checked?1:0})}),TS_Table_HandsOnTableMaster.addHook("afterRowMove",function(e,t){}),TS_Table_HandsOnTableMaster.addHook("afterCreateRow",function(e){f(0)}),TS_Table_HandsOnTableMaster.addHook("afterRemoveRow",function(e){f(0)}),TS_Table_HandsOnTableMaster.addHook("afterColumnMove",function(e,t){}),TS_Table_HandsOnTableMaster.addHook("afterColumnResize",function(e,t){}),TS_Table_HandsOnTableMaster.addHook("afterChange",function(e,t){jQuery.isArray(e)&&e.length&&e&&(jQuery.each(e,function(e,t){var a=t[0],r=t[1],n=t[3],o="",s=TS_Table_HandsOnTableMaster.getCellMeta(a,r);l(n)&&TS_Table_HandsOnTableMaster.setCellMeta(a,r,"renderer",Handsontable.TextCell.renderer,"type","numeric"),"date"==s.formatType?moment(n,s.format).isValid()?(o=moment(n,s.format).utc().valueOf(),null!=s.momentdate&&void 0!=s.momentdate?s.momentdate!=o&&TS_Table_HandsOnTableMaster.setCellMeta(a,r,"momentdate",o):TS_Table_HandsOnTableMaster.setCellMeta(a,r,"momentdate",o),jQuery("#ts-advanced-table-toolbar-dates").show()):(TS_Table_HandsOnTableMaster.setCellMeta(a,r,"momentdate",""),jQuery("#ts-advanced-table-toolbar-dates").hide()):"time"==s.formatType||"number"==s.formatType||"currency"==s.formatType||s.formatType}),TS_Table_HandsOnTableMaster.render())}),f(500)})}(jQuery),function(e){"use strict";function t(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);return e}function a(e,a){this.el=e,this.options=t({},this.options),t(this.options,a),this._init()}a.prototype.options={start:0},a.prototype._init=function(){this.resize=document.createEvent("UIEvents"),this.tabs=[].slice.call(this.el.querySelectorAll("nav > ul > li")),this.items=[].slice.call(this.el.querySelectorAll(".content > section")),this.current=-1,this._show(),this._initEvents()},a.prototype._initEvents=function(){var e=this;this.tabs.forEach(function(t,a){t.addEventListener("click",function(t){t.preventDefault(),e._show(a)})})},a.prototype._show=function(e){this.current>=0&&(this.tabs[this.current].className="",this.items[this.current].className=""),this.current=void 0!=e?e:this.options.start>=0&&this.options.start<this.items.length?this.options.start:0,this.tabs[this.current].className="tab-current",this.items[this.current].className="content-current",this._resize(10)},a.prototype._resize=function(t){var a=this;setTimeout(function(){a.resize.initUIEvent("resize",!0,!1,e,0),e.dispatchEvent(a.resize),jQuery(e).trigger("resize"),jQuery(e).trigger("debouncedresize"),TS_Table_HandsOnTableMaster.render()},t)},e.KrautTabs=a}(window),function(e){var t,a,r=e.event;t=r.special.debouncedresize={setup:function(){e(this).on("resize",t.handler)},teardown:function(){e(this).off("resize",t.handler)},handler:function(e,n){var l=this,o=arguments,s=function(){e.type="debouncedresize",r.dispatch.apply(l,o)};a&&clearTimeout(a),n?s():a=setTimeout(s,t.threshold)},threshold:150},e.event.special.debouncedresize.threshold=250}(jQuery),jQuery.fn.slideFade=function(e,t){for(var a,r=0;r<arguments.length;r++)if("number"==typeof arguments[r])a=arguments[r];else var n=arguments[r];a||(a=500),this.toggleClass("slideFade").animate({opacity:"toggle",height:"toggle"},a,function(){"function"!=typeof n&&(n=function(){}),n.call(this)})},jQuery.vsprintf=function(e,t){function a(e,t,a){if(void 0==t)return"s"==e?"":"0";var r,n="",l="",o=" ";if(a.short||a.long||a.long_long)switch(e){case"e":case"f":case"G":case"E":case"G":case"d":a.short?t>=32767?t=32767:t<=-32768&&(t=-32768):a.long?t>=2147483647?t=2147483647:t<=-2147483648&&(t=-2147483648):t>=0x8000000000000000?t=0x8000000000000000:t<=-0x8000000000000000&&(t=-0x8000000000000000);break;case"X":case"B":case"u":case"o":case"x":case"b":t<0&&(t=Math.abs(t)-1),a.short?t>=65535&&(t=65535):a.long?t>=4294967295&&(t=4294967295):t>=0x10000000000000000&&(t=0x10000000000000000)}switch(e){case"c":r=String.fromCharCode(parseInt(t));break;case"s":r=t.toString();break;case"d":case"u":r=new Number(parseInt(t)).toString();break;case"o":r=new Number(parseInt(t)).toString(8);break;case"x":r=new Number(parseInt(t)).toString(16);break;case"B":case"b":r=new Number(parseInt(t)).toString(2);break;case"e":s=a.precision?a.precision:6;r=new Number(t).toExponential(s).toString();break;case"f":s=a.precision?a.precision:6;r=new Number(t).toFixed(s).toString();break;case"g":s=a.precision?a.precision:6;r=new Number(t).toPrecision(s).toString();break;case"X":r=new Number(parseInt(t)).toString(16).toUpperCase();break;case"E":s=a.precision?a.precision:6;r=new Number(t).toExponential(s).toString().toUpperCase();break;case"G":var s=a.precision?a.precision:6;r=new Number(t).toPrecision(s).toString().toUpperCase()}if(a["+"]&&parseFloat(t)>0&&-1!=["d","e","f","g","E","G"].indexOf(e)&&(n="+"),a[" "]&&parseFloat(t)>0&&-1!=["d","e","f","g","E","G"].indexOf(e)&&(n=" "),a["#"]&&0!=parseInt(t))switch(e){case"o":n="0";break;case"x":case"X":n="0x";break;case"b":n="0b";break;case"B":n="0B"}if(a[0]&&!a["-"]&&(o="0"),a.width&&a.width>r.length+n.length)for(var d=a.width-r.length-n.length,i=0;i<d;++i)l+=o;return a["-"]&&!a[0]?r+=l:r=l+r,n+r}if(null==e)throw"Not enough arguments for vsprintf";null==t&&(t=[]);for(var r="",n=0,l=0,o={long:!1,short:!1,long_long:!1},s=!1,d=!1,i=!1,c=!1,u=!1,v=!1,f=".",b=0;b<e.length;++b){var m=e.charAt(b);if(s){switch(m){case"i":m="d";break;case"D":o.long=!0,m="d";break;case"U":o.long=!0,m="u";break;case"O":o.long=!0,m="o";break;case"F":m="f"}switch(m){case"c":case"s":case"d":case"u":case"o":case"x":case"e":case"f":case"g":case"X":case"E":case"G":case"b":case"B":var h=t[l];if(u){var p=h;if(h instanceof Array)p=h;else if("string"==typeof h||h instanceof String)p=h.split("").map(function(e){return e.charCodeAt()});else if(("number"==typeof h||h instanceof Number)&&o.bitwidth){p=[];do{p.unshift(h&~(-1<<o.bitwidth))}while(h>>>=o.bitwidth)}else p=h.toString().split("").map(function(e){return e.charCodeAt()});r+=p.map(function(e){return a(m,e,o)}).join(f)}else r+=a(m,h,o);c||++n,l=n,o={},d=!1,s=!1,i=!1,c=!1,u=!1,v=!1,f=".";break;case"v":u=!0;break;case" ":case"0":case"-":case"+":case"#":o[m]=!0;break;case"*":d=!0;break;case".":i=!0;break;case"@":v=!0;break;case"l":o.long?(o.long_long=!0,o.long=!1):(o.long=!0,o.long_long=!1),o.short=!1;break;case"q":case"L":o.long_long=!0,o.long=!1,o.short=!1;break;case"h":o.short=!0,o.long=!1,o.long_long=!1}if(/\d/.test(m)){var g=parseInt(e.substr(b));b+=g.toString().length-1;if("$"==e.charAt(b+1)){if(g<0||g>t.length)throw"out of bound";d?(i?(o.precision=t[g-1],i=!1):"v"==e.charAt(b+2)?f=t[g-1]:o.width=t[g-1],d=!1):(c=!0,l=g-1),++b}else i?(o.precision=g,i=!1):v?(o.bitwidth=g,v=!1):o.width=g}else d&&!/\d/.test(e.charAt(b+1))&&(i?(o.precision=t[l],i=!1):"v"==e.charAt(b+1)?f=t[l]:o.width=t[l],++n,c||l++,d=!1)}else{if("%"==m){if("%"==e.charAt(b+1)){r+="%",++b;continue}s=!0;continue}r+=m}}return r},jQuery.sprintf=function(){if(0==arguments.length)throw"Not enough arguments for sprintf";var e=Array.prototype.slice.call(arguments),t=e.shift();return jQuery.vsprintf(t,e)},jQuery.fn.printf=function(){if(0==arguments.length)throw"Not enough arguments for sprintf";var e=Array.prototype.slice.call(arguments),t=e.shift();return this.append(jQuery.vsprintf(t,e))},jQuery.fn.vprintf=function(e,t){if(0==arguments.length)throw"Not enough arguments for sprintf";return this.append(jQuery.vsprintf(e,t))},jQuery.fn.vformat=function(e){if(0==arguments.length)throw"Not enough arguments for sprintf";return this.each(function(){self=jQuery(this),self.html(jQuery.vsprintf(self.html(),e))})},jQuery.fn.format=function(){if(0==arguments.length)throw"Not enough arguments for sprintf";var e=Array.prototype.slice.call(arguments);return this.each(function(){self=jQuery(this),self.html(jQuery.vsprintf(self.html(),e))})},jQuery.printf=function(){if(0==arguments.length)throw"Not enough arguments for sprintf";var e=Array.prototype.slice.call(arguments),t=e.shift(),a=jQuery.vsprintf(t,e);window.console?window.console.info(a):window.dump(a)},jQuery.vprintf=function(e,t){if(0==arguments.length)throw"Not enough arguments for sprintf";var a=jQuery.vsprintf(e,t);window.console?window.console.info(a):window.dump(a)};var TS_TablesWP_Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t="";if(""==e||void 0==e)return t;var a,r,n,l,o,s,d,i=0;for(e=TS_TablesWP_Base64._utf8_encode(e);i<e.length;)l=(a=e.charCodeAt(i++))>>2,o=(3&a)<<4|(r=e.charCodeAt(i++))>>4,s=(15&r)<<2|(n=e.charCodeAt(i++))>>6,d=63&n,isNaN(r)?s=d=64:isNaN(n)&&(d=64),t=t+this._keyStr.charAt(l)+this._keyStr.charAt(o)+this._keyStr.charAt(s)+this._keyStr.charAt(d);return t},decode:function(e){var t="";if(""==e||void 0==e)return t;var a,r,n,l,o,s,d=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");d<e.length;)a=this._keyStr.indexOf(e.charAt(d++))<<2|(l=this._keyStr.indexOf(e.charAt(d++)))>>4,r=(15&l)<<4|(o=this._keyStr.indexOf(e.charAt(d++)))>>2,n=(3&o)<<6|(s=this._keyStr.indexOf(e.charAt(d++))),t+=String.fromCharCode(a),64!=o&&(t+=String.fromCharCode(r)),64!=s&&(t+=String.fromCharCode(n));return t=TS_TablesWP_Base64._utf8_decode(t)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",a=0;a<e.length;a++){var r=e.charCodeAt(a);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},_utf8_decode:function(e){for(var t="",a=0,r=c1=c2=0;a<e.length;)(r=e.charCodeAt(a))<128?(t+=String.fromCharCode(r),a++):r>191&&r<224?(c2=e.charCodeAt(a+1),t+=String.fromCharCode((31&r)<<6|63&c2),a+=2):(c2=e.charCodeAt(a+1),c3=e.charCodeAt(a+2),t+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),a+=3);return t}};!function(e){function t(a,r){for(var n=[],l=a.find("ul:first > li"),o=0,s=l.length;o<s;o++){var d=e(l[o]).find("input[type=checkbox]:first"),i=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}();d.data("id")||d.data("id",i),d.data("name")||d.data("name",i);var c={el:d},u=t(e(l[o]),d);u&&(c.children=u),r&&(c.parent=r),n.push(c)}return n.length>0&&n}function a(t,r){for(var n=0,l=t.length;n<l;n++)!function(t){e(t.el).on("change",function(){r(t,e(this).prop("checked"))}),t.children&&a(t.children,r)}(t[n])}function r(e,t){for(var a=0,n=e.length;a<n;a++)e[a].el.prop("checked",t),e[a].children&&r(e[a].children,t)}var n={autoCheckChildren:!0,limitParentsOnly:!0,readableListTarget:".selector",listItemBefore:'<span class="item">',listItemAfter:"</span>",listItemsDivider:", ",labelExceptBefore:" (except ",labelExceptAfter:")",labelExceptBetween:")",labelNothingIsSelected:""},l=[];e.fn.TS_TablesWP_DeepCheckBox=function(o){if(l.indexOf(this.selector)<0){o||(o={}),o=e.extend(n,o);var s=t(this);a(s,function(e,t){e.children&&o.autoCheckChildren&&r(e.children,t)}),o.readableListTarget&&(1!=o.readableListTarget&&0!=o.readableListTarget&&e(o.readableListTarget).length>0&&e(o.readableListTarget).html(o.labelNothingIsSelected),a(s,function(){function t(e,l,s){l||(l=0);for(var d=0,i=e.length;d<i;d++){if(e[d].el.prop("checked")){var c=o.listItemBefore.replace("{{id}}",e[d].el.data("id"))+e[d].el.data("name"),u=0;if(e[d].children){for(var v=0,f=e[d].children.length;v<f;v++)e[d].children[v].el.prop("checked")||(r.push(e[d].children[v].el.data("id")),0===u&&(c+=o.labelExceptBefore),u>0&&(c+=o.labelExceptBetween),c+=e[d].children[v].el.data("name"),u++);u>0&&(c+=o.labelExceptAfter)}c+=o.listItemAfter,l>0&&e[d].el.prop("checked")&&!e[d].parent.prop("checked")&&(s=!1),(!s||u>0)&&(n.push(c),a.push(e[d].el.data("id")))}e[d].children&&t(e[d].children,l+1,o.limitParentsOnly)}return n.join(o.listItemsDivider)}var a=[],r=[],n=[],l=t(s,null,o.limitParentsOnly);1!=o.readableListTarget&&0!=o.readableListTarget&&e(o.readableListTarget).length>0&&e(o.readableListTarget).html(l.length>0?l:o.labelNothingIsSelected),o.onChange&&"function"==typeof o.onChange&&o.onChange(a,r)})),l.push(this.selector)}}}(jQuery),function(e){e.fn.TS_TablesWP_TagEditorInput=function(){var t=" ",a=e(this),r=parseInt(a.css("fontSize")),n=e("<span/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:a.css("fontSize"),fontFamily:a.css("fontFamily"),fontWeight:a.css("fontWeight"),letterSpacing:a.css("letterSpacing"),whiteSpace:"nowrap"});return n.insertAfter(a),a.bind("keyup keydown focus",function(){if(t!==(t=a.val())){n.text(t);var e=n.width()+r;20>e&&(e=20),e!=a.width()&&a.width(e)}})},e.fn.TS_TablesWP_TagEditor=function(t,a,r){function n(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var l,o=e.extend({},e.fn.TS_TablesWP_TagEditor.defaults,t);if(o.dregex=new RegExp("["+o.delimiter.replace("-","-")+"]","g"),"string"==typeof t){var s=[];return this.each(function(){var n=e(this),l=n.data("options"),o=n.next(".tag-editor");if("getTags"==t)s.push({field:n[0],editor:o,tags:o.data("tags")});else if("addTag"==t){if(l.maxTags&&o.data("tags").length>=l.maxTags)return!1;e('<li><div class="tag-editor-spacer">&nbsp;'+l.delimiter[0]+'</div><div class="tag-editor-tag"></div><div class="tag-editor-delete"><i></i></div></li>').appendTo(o).find(".tag-editor-tag").html('<input type="text" maxlength="'+l.maxLength+'">').addClass("active").find("input").val(a).blur(),r?e(".placeholder",o).remove():o.click()}else"removeTag"==t?(e(".tag-editor-tag",o).filter(function(){return e(this).text()==a}).closest("li").find(".tag-editor-delete").click(),r||o.click()):"destroy"==t&&n.removeClass("tag-editor-hidden-src").removeData("options").off("focus.tag-editor").next(".tag-editor").remove()}),"getTags"==t?s:this}return window.getSelection&&e(document).off("keydown.tag-editor").on("keydown.tag-editor",function(t){if(8==t.which||46==t.which||t.ctrlKey&&88==t.which){try{var a=getSelection(),r="BODY"==document.activeElement.tagName?e(a.getRangeAt(0).startContainer.parentNode).closest(".tag-editor"):0}catch(t){r=0}if(a.rangeCount>0&&r&&r.length){var n=[],l=a.toString().split(r.prev().data("options").dregex);for(i=0;i<l.length;i++){var o=e.trim(l[i]);o&&n.push(o)}return e(".tag-editor-tag",r).each(function(){~e.inArray(e(this).text(),n)&&e(this).closest("li").find(".tag-editor-delete").click()}),!1}}}),this.each(function(){function t(){!o.placeholder||d.length||e(".deleted, .placeholder, input",i).length||i.append('<li class="placeholder"><div>'+o.placeholder+"</div></li>")}function a(a){var r=d.toString();d=e(".tag-editor-tag:not(.deleted)",i).map(function(t,a){var r=e.trim(e(this).hasClass("active")?e(this).find("input").val():e(a).text());if(r)return r}).get(),i.data("tags",d),s.val(d.join(o.delimiter[0])),a||r!=d.toString()&&o.onChange(s,i,d),t()}function r(t){var r,l=t.closest("li"),c=t.val().replace(/ +/," ").split(o.dregex),u=t.data("old_tag"),v=d.slice(0),f=!1;c=c.filter(function(e){return e});for(var b=0;b<c.length;b++)if(m=e.trim(c[b]).slice(0,o.maxLength),o.forceLowercase&&(m=m.toLowerCase()),o.forceNumbersOnly&&(m=m.replace(/\D/g,"")),r=o.beforeTagSave(s,i,v,u,m),m=r||m,!1!==r&&m&&(o.removeDuplicates&&~e.inArray(m,v)&&e(".tag-editor-tag:not(.active)",i).each(function(t){e(this).text()==m&&e(this).closest("li").remove()}),v.push(m),l.before('<li><div class="tag-editor-spacer">&nbsp;'+o.delimiter[0]+'</div><div class="tag-editor-tag">'+n(m)+'</div><div class="tag-editor-delete"><i></i></div></li>'),o.maxTags&&v.length>=o.maxTags)){f=!0;break}t.attr("maxlength",o.maxLength).removeData("old_tag").val(""),f?t.blur():t.focus(),a()}var s=e(this),d=[],i=e("<ul "+(o.clickDelete?'oncontextmenu="return false;" ':"")+'class="tag-editor"></ul>').insertAfter(s);s.addClass("tag-editor-hidden-src").data("options",o).on("focus.tag-editor",function(){i.click()}),i.append('<li style="width:1px">&nbsp;</li>');var c='<li><div class="tag-editor-spacer">&nbsp;'+o.delimiter[0]+'</div><div class="tag-editor-tag"></div><div class="tag-editor-delete"><i></i></div></li>';i.on("click",function(t,a){var r,n,s=99999;if(!window.getSelection||""==getSelection())return o.maxTags&&i.data("tags").length>=o.maxTags?(i.find("input").blur(),!1):(l=!0,e("input:focus",i).blur(),!!l&&(l=!0,e(".placeholder",i).remove(),a&&a.length?n="before":e(".tag-editor-tag",i).each(function(){var l=e(this),o=l.offset(),d=o.left,i=o.top;t.pageY>=i&&t.pageY<=i+l.height()&&(t.pageX<d?(n="before",r=d-t.pageX):(n="after",r=t.pageX-d-l.width()),r<s&&(s=r,a=l))}),"before"==n?e(c).insertBefore(a.closest("li")).find(".tag-editor-tag").click():"after"==n?e(c).insertAfter(a.closest("li")).find(".tag-editor-tag").click():e(c).appendTo(i).find(".tag-editor-tag").click(),!1))}),i.on("click",".tag-editor-delete",function(r){if(e(this).prev().hasClass("active"))return e(this).closest("li").find("input").caretme(-1),!1;var n=e(this).closest("li"),l=n.find(".tag-editor-tag");return!1!==o.beforeTagDelete(s,i,d,l.text())&&(l.addClass("deleted").animate({width:0},o.animateDelete,function(){n.remove(),t()}),a(),!1)}),o.clickDelete&&i.on("mousedown",".tag-editor-tag",function(r){if(r.ctrlKey||r.which>1){var n=e(this).closest("li"),l=n.find(".tag-editor-tag");return!1!==o.beforeTagDelete(s,i,d,l.text())&&(l.addClass("deleted").animate({width:0},o.animateDelete,function(){n.remove(),t()}),a(),!1)}}),i.on("click",".tag-editor-tag",function(t){if(o.clickDelete&&(t.ctrlKey||t.which>1))return!1;if(!e(this).hasClass("active")){var a=e(this).text(),r=Math.abs((e(this).offset().left-t.pageX)/e(this).width()),l=parseInt(a.length*r),s=e(this).html('<input type="text" maxlength="'+o.maxLength+'" value="'+n(a)+'">').addClass("active").find("input");if(s.data("old_tag",a).TS_TablesWP_TagEditorInput().focus().caretme(l),o.autocomplete){var d=e.extend({},o.autocomplete),c="select"in d?o.autocomplete.select:"";d.select=function(t,a){c&&c(t,a),setTimeout(function(){i.trigger("click",[e(".active",i).find("input").closest("li").next("li").find(".tag-editor-tag")])},20)},s.autocomplete(d)}}return!1}),i.on("blur","input",function(c){c.stopPropagation();var u=e(this),v=(u.closest("li"),u.data("old_tag")),f=e.trim(u.val().replace(/ +/," ").replace(o.dregex,o.delimiter[0]));if(f){if(f.indexOf(o.delimiter[0])>=0)return void r(u);if(f!=v)if(o.forceLowercase&&(f=f.toLowerCase()),o.forceNumbersOnly&&(f=f.replace(/\D/g,"")),cb_val=o.beforeTagSave(s,i,d,v,f),f=cb_val||f,!1===cb_val||""==f){if(v)return u.val(v).focus(),l=!1,void a();try{u.closest("li").remove()}catch(c){}v&&a()}else o.removeDuplicates&&e(".tag-editor-tag:not(.active)",i).each(function(t){e(this).text()==f&&e(this).closest("li").remove()})}else{if(v&&!1===o.beforeTagDelete(s,i,d,v))return u.val(v).focus(),l=!1,void a();try{u.closest("li").remove()}catch(c){}v&&a()}u.parent().html(n(f)).removeClass("active"),f!=v&&a(),t()});var u;i.on("paste","input",function(t){e(this).removeAttr("maxlength"),(u=e(this)).trigger("change"),setTimeout(function(){r(u)},30)});var v;i.on("keypress","input",function(t){o.delimiter.indexOf(String.fromCharCode(t.which))>=0&&(v=e(this),setTimeout(function(){r(v)},20))}),i.on("keydown","input",function(t){var a=e(this);if((37==t.which||!o.autocomplete&&38==t.which)&&!a.caretme()||8==t.which&&!a.val()){return(r=a.closest("li").prev("li").find(".tag-editor-tag")).length?r.click().find("input").caretme(-1):!a.val()||o.maxTags&&i.data("tags").length>=o.maxTags||e(c).insertBefore(a.closest("li")).find(".tag-editor-tag").click(),!1}if((39==t.which||!o.autocomplete&&40==t.which)&&a.caretme()==a.val().length){return(n=a.closest("li").next("li").find(".tag-editor-tag")).length?n.click().find("input").caretme(0):a.val()&&i.click(),!1}if(9==t.which){if(t.shiftKey){var r=a.closest("li").prev("li").find(".tag-editor-tag");if(r.length)r.click().find("input").caretme(0);else{if(!a.val()||o.maxTags&&i.data("tags").length>=o.maxTags)return s.attr("disabled","disabled"),void setTimeout(function(){s.removeAttr("disabled")},30);e(c).insertBefore(a.closest("li")).find(".tag-editor-tag").click()}return!1}if((n=a.closest("li").next("li").find(".tag-editor-tag")).length)n.click().find("input").caretme(0);else{if(!a.val())return;i.click()}return!1}if(!(46!=t.which||e.trim(a.val())&&a.caretme()!=a.val().length)){var n=a.closest("li").next("li").find(".tag-editor-tag");return n.length?n.click().find("input").caretme(0):a.val()&&i.click(),!1}if(13==t.which)return i.trigger("click",[a.closest("li").next("li").find(".tag-editor-tag")]),o.maxTags&&i.data("tags").length>=o.maxTags&&i.find("input").blur(),!1;if(36!=t.which||a.caretme()){if(35==t.which&&a.caretme()==a.val().length)i.find(".tag-editor-tag").last().click();else if(27==t.which)return a.val(a.data("old_tag")?a.data("old_tag"):"").blur(),!1}else i.find(".tag-editor-tag").first().click()});for(var f=o.initialTags.length?o.initialTags:s.val().split(o.dregex),b=0;b<f.length&&!(o.maxTags&&b>=o.maxTags);b++){var m=e.trim(f[b].replace(/ +/," "));m&&(o.forceLowercase&&(m=m.toLowerCase()),d.push(m),i.append('<li><div class="tag-editor-spacer">&nbsp;'+o.delimiter[0]+'</div><div class="tag-editor-tag">'+n(m)+'</div><div class="tag-editor-delete"><i></i></div></li>'))}a(!0),o.sortable&&e.fn.sortable&&i.sortable({distance:5,cancel:".tag-editor-spacer, input",helper:"clone",update:function(){a()}})})},e.fn.TS_TablesWP_TagEditor.defaults={initialTags:[],maxTags:0,maxLength:50,delimiter:",;",placeholder:"",forceLowercase:!0,forceNumbersOnly:!1,removeDuplicates:!0,clickDelete:!1,animateDelete:175,sortable:!0,autocomplete:null,onChange:function(){},beforeTagSave:function(){},beforeTagDelete:function(){}}}(jQuery),function(){"use strict";var e="undefined"!=typeof window&&void 0!==window.document?window.document:{},t="undefined"!=typeof module&&module.exports,a="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,r=function(){for(var t,a=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,n=a.length,l={};r<n;r++)if((t=a[r])&&t[1]in e){for(r=0;r<t.length;r++)l[a[0][r]]=t[r];return l}return!1}(),n={change:r.fullscreenchange,error:r.fullscreenerror},l={request:function(t){var n=r.requestFullscreen;t=t||e.documentElement,/5\.1[.\d]* Safari/.test(navigator.userAgent)?t[n]():t[n](a&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){e[r.exitFullscreen]()},toggle:function(e){this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(t,a){var r=n[t];r&&e.addEventListener(r,a,!1)},off:function(t,a){var r=n[t];r&&e.removeEventListener(r,a,!1)},raw:r};r?(Object.defineProperties(l,{isFullscreen:{get:function(){return Boolean(e[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return e[r.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return Boolean(e[r.fullscreenEnabled])}}}),t?module.exports=l:window.screenfull=l):t?module.exports=!1:window.screenfull=!1}(),function(e){e.isScrollToFixed=function(t){return!!e(t).data("ScrollToFixed")},e.ScrollToFixed=function(t,a){function r(){var e=b.options.limit;return e?"function"==typeof e?e.apply(j):e:0}function n(){return"fixed"===m}function l(){return"absolute"===m}function o(){return!(n()||l())}function s(){n()||(x.css({display:j.css("display"),width:j.outerWidth(!0),height:j.outerHeight(!0),float:j.css("float")}),cssOptions={"z-index":b.options.zIndex,position:"fixed",top:-1==b.options.bottom?u():"",bottom:-1==b.options.bottom?"":b.options.bottom,"margin-left":"0px"},b.options.dontSetWidth||(cssOptions.width=j.width()),j.css(cssOptions),j.addClass(b.options.baseClassName),b.options.className&&j.addClass(b.options.className),m="fixed")}function d(){var e=r(),t=w;b.options.removeOffsets&&(t="",e-=Q),cssOptions={position:"absolute",top:e,left:t,"margin-left":"0px",bottom:""},b.options.dontSetWidth||(cssOptions.width=j.width()),j.css(cssOptions),m="absolute"}function i(){o()||(C=-1,x.css("display","none"),j.css({"z-index":g,width:"",position:h,left:"",top:p,"margin-left":""}),j.removeClass("scroll-to-fixed-fixed"),b.options.className&&j.removeClass(b.options.className),m=null)}function c(e){e!=C&&(j.css("left",w-e),C=e)}function u(){var e=b.options.marginTop;return e?"function"==typeof e?e.apply(j):e:0}function v(){if(e.isScrollToFixed(j)){var t=y;y?o()&&(Q=j.offset().top,w=j.offset().left):(j.trigger("preUnfixed.ScrollToFixed"),i(),j.trigger("unfixed.ScrollToFixed"),C=-1,Q=j.offset().top,w=j.offset().left,b.options.offsets&&(w+=j.offset().left-j.position().left),-1==T&&(T=w),m=j.css("position"),y=!0,-1!=b.options.bottom&&(j.trigger("preFixed.ScrollToFixed"),s(),j.trigger("fixed.ScrollToFixed")));var a=e(window).scrollLeft(),v=e(window).scrollTop(),p=r();b.options.minWidth&&e(window).width()<b.options.minWidth?o()&&t||(f(),j.trigger("preUnfixed.ScrollToFixed"),i(),j.trigger("unfixed.ScrollToFixed")):b.options.maxWidth&&e(window).width()>b.options.maxWidth?o()&&t||(f(),j.trigger("preUnfixed.ScrollToFixed"),i(),j.trigger("unfixed.ScrollToFixed")):-1==b.options.bottom?p>0&&v>=p-u()?l()&&t||(f(),j.trigger("preAbsolute.ScrollToFixed"),d(),j.trigger("unfixed.ScrollToFixed")):v>=Q-u()?(n()&&t||(f(),j.trigger("preFixed.ScrollToFixed"),s(),C=-1,j.trigger("fixed.ScrollToFixed")),c(a)):o()&&t||(f(),j.trigger("preUnfixed.ScrollToFixed"),i(),j.trigger("unfixed.ScrollToFixed")):p>0?v+e(window).height()-j.outerHeight(!0)>=p-(u()||-(b.options.bottom?b.options.bottom:0))?n()&&(f(),j.trigger("preUnfixed.ScrollToFixed"),"absolute"===h?d():i(),j.trigger("unfixed.ScrollToFixed")):(n()||(f(),j.trigger("preFixed.ScrollToFixed"),s()),c(a),j.trigger("fixed.ScrollToFixed")):c(a)}}function f(){var e=j.css("position");"absolute"==e?j.trigger("postAbsolute.ScrollToFixed"):"fixed"==e?j.trigger("postFixed.ScrollToFixed"):j.trigger("postUnfixed.ScrollToFixed")}var b=this;b.$el=e(t),b.el=t,b.$el.data("ScrollToFixed",b);var m,h,p,g,y=!1,j=b.$el,Q=0,w=0,T=-1,C=-1,x=null,S=function(e){j.is(":visible")&&(y=!1,v())},k=function(e){window.requestAnimationFrame?requestAnimationFrame(v):v()};b.init=function(){b.options=e.extend({},e.ScrollToFixed.defaultOptions,a),g=j.css("z-index"),b.$el.css("z-index",b.options.zIndex),x=e("<div />"),m=j.css("position"),h=j.css("position"),p=j.css("top"),o()&&b.$el.after(x),e(window).bind("resize.ScrollToFixed",S),e(window).bind("scroll.ScrollToFixed",k),"ontouchmove"in window&&e(window).bind("touchmove.ScrollToFixed",v),b.options.preFixed&&j.bind("preFixed.ScrollToFixed",b.options.preFixed),b.options.postFixed&&j.bind("postFixed.ScrollToFixed",b.options.postFixed),b.options.preUnfixed&&j.bind("preUnfixed.ScrollToFixed",b.options.preUnfixed),b.options.postUnfixed&&j.bind("postUnfixed.ScrollToFixed",b.options.postUnfixed),b.options.preAbsolute&&j.bind("preAbsolute.ScrollToFixed",b.options.preAbsolute),b.options.postAbsolute&&j.bind("postAbsolute.ScrollToFixed",b.options.postAbsolute),b.options.fixed&&j.bind("fixed.ScrollToFixed",b.options.fixed),b.options.unfixed&&j.bind("unfixed.ScrollToFixed",b.options.unfixed),b.options.spacerClass&&x.addClass(b.options.spacerClass),j.bind("resize.ScrollToFixed",function(){x.height(j.height())}),j.bind("scroll.ScrollToFixed",function(){j.trigger("preUnfixed.ScrollToFixed"),i(),j.trigger("unfixed.ScrollToFixed"),v()}),j.bind("detach.ScrollToFixed",function(t){!function(e){(e=e||window.event).preventDefault&&e.preventDefault(),e.returnValue=!1}(t),j.trigger("preUnfixed.ScrollToFixed"),i(),j.trigger("unfixed.ScrollToFixed"),e(window).unbind("resize.ScrollToFixed",S),e(window).unbind("scroll.ScrollToFixed",k),j.unbind(".ScrollToFixed"),x.remove(),b.$el.removeData("ScrollToFixed")}),S()},b.init()},e.ScrollToFixed.defaultOptions={marginTop:0,limit:0,bottom:-1,zIndex:1e3,baseClassName:"scroll-to-fixed-fixed"},e.fn.scrollToFixed=function(t){return this.each(function(){new e.ScrollToFixed(this,t)})}}(jQuery);